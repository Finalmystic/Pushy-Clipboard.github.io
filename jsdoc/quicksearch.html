<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"scripts_background_alarm.js.html":{"id":"scripts_background_alarm.js.html","title":"Source: scripts/background/alarm.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/alarm.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the chrome.alarm * @namespace */ app.Alarm = (function() { 'use strict'; new ExceptionHandler(); /** * Alarm for cleaning up old {@link ClipItem} objects * @type {string} * @const * @default * @private * @memberOf app.Alarm */ const ALARM_STORAGE = 'storage'; /** * Event: Fired when an alarm has elapsed. * @see https://developer.chrome.com/apps/alarms#event-onAlarm * @param {Object} alarm - details on alarm * @private * @memberOf app.Alarm */ function _onAlarm(alarm) { if (alarm.name === ALARM_STORAGE) { app.Alarm.deleteOldClipItems(); } } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf app.Alarm */ function _onStorageChanged(event) { if (event.key === 'storageDuration') { app.Alarm.updateAlarms(); } } /** * Listen for alarms */ chrome.alarms.onAlarm.addListener(_onAlarm); /** * Listen for changes to localStorage */ addEventListener('storage', _onStorageChanged, false); return { /** * Set the repeating alarms * @memberOf app.Alarm */ updateAlarms: function() { const durationType = Chrome.Storage.getInt('storageDuration', 2); if (durationType === 4) { // until room is needed chrome.alarms.clear(ALARM_STORAGE); } else { // Add daily alarm to delete old clipItems chrome.alarms.get(ALARM_STORAGE, (alarm) =&gt; { if (!alarm) { chrome.alarms.create(ALARM_STORAGE, { when: Date.now() + app.Utils.MILLIS_IN_DAY, periodInMinutes: app.Utils.MIN_IN_DAY, }); } }); } }, /** * Delete {@link ClipItem} objects older than the * storageDuration setting * @memberOf app.Alarm */ deleteOldClipItems: function() { app.ClipItem.deleteOld().catch((err) =&gt; { Chrome.GA.error(err.message, 'Alarm.deleteOldClipItems'); }); }, }; })(); × Search results Close "},"scripts_background_background.js.html":{"id":"scripts_background_background.js.html","title":"Source: scripts/background/background.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/background.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * The background script for the extension.&lt;br&gt; * Note: We can't be an Event Page because we use * the chrome.webRequest API * @namespace app.Background */ new ExceptionHandler(); /** * Initial {@link ClipItem} * @type {string} * @default * @const * @private * @memberOf app.Background */ const INTRO_TEXT = `A clipboard manager with push notifications. Please signin from the &quot;Manage Account&quot; page to share with your \\ other devices. You can click on the toolbar icon at any time to send the current \\ contents of the clipboard to all your other devices. Information you copy in most Chrome pages will \\ automatically be sent if you have enabled that in &quot;Settings&quot;. You can display this page by right clicking on the toolbar icon and \\ selecting &quot;Options&quot;. It is a good idea to go to the &quot;Settings&quot; page and enter a nickname \\ for this device.`; /** * Event: Fired when the extension is first installed,&lt;br /&gt; * when the extension is updated to a new version,&lt;br /&gt; * and when Chrome is updated to a new version. * @see https://developer.chrome.com/extensions/runtime#event-onInstalled * @param {Object} details - type of event * @private * @memberOf app.Background */ function _onInstalled(details) { if (details.reason === 'install') { // extension installed Chrome.GA.event(Chrome.GA.EVENT.INSTALLED); // save OS Chrome.Utils.getPlatformOS().then((os) =&gt; { Chrome.Storage.set('os', os); return null; }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._onInstalled'); }); _initializeData(); app.Notify.showMainTab(); } else if (details.reason === 'update') { _updateData(); _initializeFirebase().then(() =&gt; { return app.SW.update(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._onInstalled'); }); } app.Utils.setBadgeText(); app.Alarm.updateAlarms(); app.Permissions.injectContentScripts(); } /** * Event: Fired when a profile that has this extension installed first * starts up * @see https://developer.chrome.com/extensions/runtime#event-onStartup * @private * @memberOf app.Background */ function _onStartup() { Chrome.GA.page('/background.html'); app.Alarm.updateAlarms(); app.Alarm.deleteOldClipItems(); _initializeFirebase().catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._onStartup'); }); app.Utils.setBadgeText(); } /** * Event: Fired when a browser action icon is clicked. * @see https://goo.gl/abVwKu * @private * @memberOf app.Background */ function _onIconClicked() { // get the clipboard contents const text = app.CB.getTextFromClipboard(); if (app.Utils.isWhiteSpace(text)) { return; } // Persist app.ClipItem.add(text, Date.now(), false, false, app.Device.myName()).then((clipItem) =&gt; { // eslint-disable-next-line promise/no-nesting return app.Msg.sendClipItem(clipItem).catch((err) =&gt; { app.Gae.sendMessageFailed(err); }); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._onIconClicked'); }); } /** * Event: Fired when a tab is updated. * @see https://developer.chrome.com/extensions/tabs#event-onUpdated * @param {int} tabId - id of tab * @private * @memberOf app.Background */ function _onTabUpdated(tabId) { app.Permissions.injectContentScript(tabId); } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf app.Background */ function _onStorageChanged(event) { if ((event.key === 'allowPush') || (event.key === 'signedIn')) { app.Utils.setBadgeText(); } } /** * Initialize the data saved in localStorage * @private * @memberOf app.Background */ function _initializeData() { app.MyData.saveDefaults(); const introClip = new app.ClipItem(INTRO_TEXT, Date.now(), true, false, app.Device.myName()); introClip.save().catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._initializeData'); }); app.User.setInfo().catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._initializeData'); }); } /** * Update the data saved in localStorage * @private * @memberOf app.Background */ function _updateData() { // New items and removal of unused items can take place here // when the version changes const version = app.MyData.getCurrentVersion(); const oldVersion = Chrome.Storage.getInt('version'); if (version &gt; oldVersion) { // update version number Chrome.Storage.set('version', version); } if (oldVersion &lt; 2) { // remove unused variables localStorage.removeItem('lastEmail'); localStorage.removeItem('lastUid'); } app.MyData.saveDefaults(); } /** * Initialize firebase and Service Worker if signed in * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.Background */ function _initializeFirebase() { if (app.MyData.isSignedIn()) { return app.SW.initialize().catch((err) =&gt; { Chrome.GA.error(err.message, 'Background._initializeFirebase'); }); } else { return Promise.resolve(); } } // Listen for extension install or update chrome.runtime.onInstalled.addListener(_onInstalled); // Listen for Chrome starting chrome.runtime.onStartup.addListener(_onStartup); // Listen for click on the icon chrome.browserAction.onClicked.addListener(_onIconClicked); // Listen for tab updates chrome.tabs.onUpdated.addListener(_onTabUpdated); // Listen for changes to localStorage addEventListener('storage', _onStorageChanged, false); })(); × Search results Close "},"scripts_background_clipboard.js.html":{"id":"scripts_background_clipboard.js.html","title":"Source: scripts/background/clipboard.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/clipboard.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the clipboard * @namespace */ app.CB = (function() { 'use strict'; new ExceptionHandler(); /** * Delay time for reading from clipboard * @type {int} * @default * @private * @memberOf app.CB */ const WAIT_MILLIS = 250; /** * Send local {@link ClipItem} push notification if enabled * @param {ClipItem} clipItem - {@link ClipItem} to send * @private * @memberOf app.CB */ function _sendLocalClipItem(clipItem) { if (!clipItem.remote &amp;&amp; app.MyData.isAutoSend()) { // send to our devices app.Msg.sendClipItem(clipItem).catch((err) =&gt; { app.Gae.sendMessageFailed(err); }); } } /** * Add a new {@link ClipItem} from the Clipboard contents * @private * @memberOf app.CB */ function _addClipItemFromClipboard() { if (!app.MyData.isMonitorClipboard()) { return; } // wait a little to make sure clipboard is ready setTimeout(function() { // get the clipboard contents const text = app.CB.getTextFromClipboard(); if (app.Utils.isWhiteSpace(text)) { return; } // Persist app.ClipItem.add(text, Date.now(), false, false, app.Device.myName()).then((clipItem) =&gt; { // send to our devices _sendLocalClipItem(clipItem); return null; }).catch((err) =&gt; { Chrome.GA.error(err.message, 'CB._addClipItemFromClipboard'); }); }, WAIT_MILLIS); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.CB */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.COPIED_TO_CLIPBOARD.message) { // we put data on the clipboard _addClipItemFromClipboard(); } else if (request.message === app.ChromeMsg.COPY_TO_CLIPBOARD.message) { // copy a ClipItem to the clipboard const clip = request.item; const clipItem = new app.ClipItem(clip.text, clip.lastSeen, clip.fav, clip.remote, clip.device); app.CB.copyToClipboard(clipItem.text); _sendLocalClipItem(clipItem); } return ret; } /** * Listen for Chrome messages */ Chrome.Msg.listen(_onChromeMessage); return { /** * Get the text from the clipboard * @returns {string} text from clipboard * @memberOf app.CB */ getTextFromClipboard: function() { const input = document.createElement('textArea'); document.body.appendChild(input); input.focus(); input.select(); document.execCommand('Paste'); const text = input.value; input.remove(); return text; }, /** * Copy the given text to the clipboard * @param {string} text - text to copy * @memberOf app.CB */ copyToClipboard: function(text) { const input = document.createElement('textArea'); document.body.appendChild(input); input.textContent = text; input.focus(); input.select(); document.execCommand('Copy'); input.remove(); }, }; })(); × Search results Close "},"scripts_my_chrome_msg.js.html":{"id":"scripts_my_chrome_msg.js.html","title":"Source: scripts/my_chrome_msg.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/my_chrome_msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Chrome messages for the extension * @namespace */ app.ChromeMsg = (function() { 'use strict'; new ExceptionHandler(); /** * Restore default settings * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const RESTORE_DEFAULTS = { message: 'restoreDefaults', }; /** * Highlight a tab * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const HIGHLIGHT = { message: 'highlightTab', }; /** * Save value to storage message * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const STORE = { message: 'store', key: '', value: '', }; /** * A {@link app.Device} was removed from the {@link app.Devices} * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const REMOVE_DEVICE = { message: 'removeDevice', item: '', }; /** * The list of {@link app.Devices} changed * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const DEVICES_CHANGED = { message: 'devicesChanged', }; /** * Ping our {@link app.Devices} * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const PING = { message: 'ping', }; /** * Copy the item to the clipboard * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const COPY_TO_CLIPBOARD = { message: 'copyToClipboard', item: '', }; /** * We copied something to the clipboard * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const COPIED_TO_CLIPBOARD = { message: 'copiedToClipboard', }; /** * User signed in * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const SIGN_IN = { message: 'signIn', }; /** * User signed OUT * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const SIGN_OUT = { message: 'signOut', }; /** * Send {@link app.Msg} failed * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const MSG_FAILED = { message: 'sendMessageFailed', }; /** * Register with server failed * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const REGISTER_FAILED = { message: 'registerFailed', }; /** * Unregister with server failed * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const UNREGISTER_FAILED = { message: 'unregisterFailed', }; /** * A {@link app.ClipItem} was added or updated * @type {Chrome.Msg.Message} * @memberOf app.ChromeMsg */ const CLIP_ADDED = { message: 'clipAdded', item: '', updated: false, }; return { RESTORE_DEFAULTS: RESTORE_DEFAULTS, HIGHLIGHT: HIGHLIGHT, STORE: STORE, REMOVE_DEVICE: REMOVE_DEVICE, DEVICES_CHANGED: DEVICES_CHANGED, PING: PING, COPY_TO_CLIPBOARD: COPY_TO_CLIPBOARD, COPIED_TO_CLIPBOARD: COPIED_TO_CLIPBOARD, SIGN_IN: SIGN_IN, SIGN_OUT: SIGN_OUT, MSG_FAILED: MSG_FAILED, REGISTER_FAILED: REGISTER_FAILED, UNREGISTER_FAILED: UNREGISTER_FAILED, CLIP_ADDED: CLIP_ADDED, }; })(); × Search results Close "},"scripts_background_devices.js.html":{"id":"scripts_background_devices.js.html","title":"Source: scripts/background/devices.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/devices.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * A list of remote {@link Device} objects we know about * @namespace */ app.Devices = (function() { 'use strict'; new ExceptionHandler(); /** * A Map of {@link Device} objects keyed by their unique names * @type {Map} * @memberOf app.Devices */ let _devices = new Map(); /** * Convert Map to Object * @param {Map} map - a Map * @returns {Object} as Object * @private * @memberOf app.Devices */ function _mapToObj(map) { let obj = Object.create(null); for (let [k, v] of map) { // We don’t escape the key '__proto__' // which can cause problems on older engines obj[k] = v; } return obj; } /** * Get the {@link Device} objects from localStorage * @private * @memberOf app.Devices */ function _load() { _devices = new Map(); const json = Chrome.Storage.get('devices'); if (!json) { return; } for (let k in json) { if (json.hasOwnProperty(k)) { let v = json[k]; let device = new app.Device(v.model, v.sn, v.os, v.nickname, v.lastSeen); _devices.set(k, device); } } } /** * Save the {@link Device} objects to localStorage * @private * @memberOf app.Devices */ function _save() { Chrome.Storage.set('devices', _mapToObj(_devices)); // let listeners know we changed Chrome.Msg.send(app.ChromeMsg.DEVICES_CHANGED).catch(() =&gt; {}); } /** * Event: called when document and resources are loaded&lt;br /&gt; * Load the {@link Device} objects from localStorage * @private * @memberOf app.Devices */ function _onLoad() { _load(); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the message * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.Devices */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.REMOVE_DEVICE.message) { app.Devices.removeByName(request.item); } else if (request.message === app.ChromeMsg.PING.message) { app.Msg.sendPing().catch((err) =&gt; { app.Gae.sendMessageFailed(err); }); } return ret; } /** * listen for document and resources loaded */ window.addEventListener('load', _onLoad); /** * Listen for Chrome messages */ Chrome.Msg.listen(_onChromeMessage); return { /** * Get an {@link Iterator} on the Devices * @returns {Iterator.&lt;Device&gt;} Iterator * @memberOf app.Devices */ entries: function() { return _devices.entries(); }, /** * Add a new {@link Device} * @param {Device} device - {@link Device} to add * @memberOf app.Devices */ add: function(device) { _devices.set(device.getUniqueName(), device); _save(); }, /** * Remove a {@link Device} * @param {Device} device - {@link Device} to remove * @memberOf app.Devices */ remove: function(device) { this.removeByName(device.getUniqueName()); }, /** * Remove a {@link Device} with the given unique name * @param {string} uniqueName - Name of Device to remove * @memberOf app.Devices */ removeByName: function(uniqueName) { _devices.delete(uniqueName); _save(); }, /** * Remove all {@link Device} objects * @memberOf app.Devices */ clear: function() { _devices.clear(); _save(); }, }; })(); × Search results Close "},"scripts_background_firebase.js.html":{"id":"scripts_background_firebase.js.html","title":"Source: scripts/background/firebase.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/firebase.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage interaction with firebase and its Namespaces * @see https://firebase.google.com/docs/web/setup * @namespace */ app.Fb = (function() { 'use strict'; new ExceptionHandler(); /** * Error message for regToken * @type {string} * @default * @memberOf app.Fb */ const ERROR_TOKEN = 'Failed to obtain messaging token.\\n'; /** * Firebase app * @private * @memberOf app.Fb */ let _app = null; /** * Firebase messaging Namespace * @private * @memberOf app.Fb */ let _messaging; /** * Firebase auth Namespace * @private * @memberOf app.Fb */ let _auth; /** * Initialize firebase and its Namespaces * @param {ServiceWorkerRegistration} swReg - use own ServiceWorker * @returns {Promise.&lt;void&gt;} void * @private * @memberOf app.Fb */ function _initializeFirebase(swReg) { const config = { apiKey: 'AIzaSyBzqx2gVefRo3tvMFGRFs9gztd081pRgVg', authDomain: 'clip-man.firebaseapp.com', databaseURL: 'https://clip-man.firebaseio.com', storageBucket: 'clip-man.appspot.com', messagingSenderId: '597467211507', }; return _deleteFirebaseApp().then(() =&gt; { _app = firebase.initializeApp(config); _auth = firebase.auth(); _messaging = firebase.messaging(); _messaging.useServiceWorker(swReg); // Callback fired if Instance ID token is updated. _messaging.onTokenRefresh(_refreshRegToken); return Promise.resolve(); }); } /** * Delete firebase.app if it exists * @returns {Promise.&lt;void&gt;} void * @private * @memberOf app.Fb */ function _deleteFirebaseApp() { if (_app) { return firebase.app().delete(); } else { return Promise.resolve(); } } /** * Refresh the regToken when firebase changes it * @private * @memberOf app.Fb */ function _refreshRegToken() { _messaging.getToken().then((refreshedToken) =&gt; { if (app.MyData.isSignedIn()) { return app.Reg.register(false); } else { return Promise.resolve(); } }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Fb._refreshRegToken'); }); } return { /** * Initialize the firebase libraries * @param {ServiceWorkerRegistration} swReg - service worker * @returns {Promise&lt;void&gt;} void * @memberOf app.Fb */ initialize: function(swReg) { return _initializeFirebase(swReg); }, /** * SignIn to firebase * @param {string} token - token * @returns {Promise&lt;Object&gt;} The current firebase user * @memberOf app.Fb */ signIn: function(token) { return app.SW.initialize().then(() =&gt; { const credential = firebase.auth.GoogleAuthProvider.credential(null, token); // Authorize Firebase with the Google access token. return _auth.signInWithCredential(credential); }); }, /** * Unregister Service Worker and sign-out of firebase * @returns {Promise&lt;void&gt;} Error on reject * @memberOf app.Fb */ signOut: function() { return app.SW.unregister().then(() =&gt; { return _auth.signOut(); }); }, /** * Get the registration token for fcm * @returns {Promise&lt;token&gt;} A registration token for fcm * @memberOf app.Fb */ getRegToken: function() { return _messaging.getToken().then((token) =&gt; { if (token) { return Promise.resolve(token); } else { return Promise.reject(new Error(ERROR_TOKEN)); } }); }, }; })(); × Search results Close "},"scripts_my_analytics.js.html":{"id":"scripts_my_analytics.js.html","title":"Source: scripts/my_analytics.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/my_analytics.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.app = window.app || {}; /** * Manage Google Analytics tracking * @namespace */ app.GA = (function() { 'use strict'; /** * Tracking ID * @type {string} * @const * @default * @private * @memberOf app.GA */ const _TRACKING_ID = 'UA-61314754-3'; /** * Event types * @type {{}} * @property {Chrome.GA.Event} SENT - message sent * @property {Chrome.GA.Event} RECEIVED - message received * @property {Chrome.GA.Event} REGISTERED - {@link Device} registered * @property {Chrome.GA.Event} UNREGISTERED - {@link Device} unregistered * @const * @memberOf app.GA */ const EVENT = { SENT: { eventCategory: 'message', eventAction: 'sent', eventLabel: '', }, RECEIVED: { eventCategory: 'message', eventAction: 'received', eventLabel: '', }, REGISTERED: { eventCategory: 'register', eventAction: 'registered', eventLabel: '', }, UNREGISTERED: { eventCategory: 'register', eventAction: 'unregistered', eventLabel: '', }, }; /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Google Analytics * @private * @memberOf app.GA */ function _onLoad() { // initialize analytics Chrome.GA.initialize(_TRACKING_ID, 'Pushy Clipboard', 'pushy-chrome-extension', Chrome.Utils.getVersion()); } // listen for document and resources loaded window.addEventListener('load', _onLoad); return { EVENT: EVENT, }; })(); × Search results Close "},"scripts_background_gae.js.html":{"id":"scripts_background_gae.js.html","title":"Source: scripts/background/gae.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/gae.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle calls to the Google App Engine Endpoints * @see https://cloud.google.com/appengine/docs/standard/java/endpoints/ * @namespace */ app.Gae = (function() { 'use strict'; new ExceptionHandler(); /** * Base path of real gae server * @const * @default * @private * @memberOf app.Gae */ const GAE_ROOT_REMOTE = 'https://clip-man.appspot.com/_ah/api'; // noinspection Eslint,JSUnusedLocalSymbols /** * Base path of local testing server * @const * @default * @private * @memberOf app.Gae */ // eslint-disable-next-line no-unused-vars const GAE_ROOT_LOCAL = 'http://localhost:8080/_ah/api'; // Set to GAE_ROOT_LOCAL for local testing const GAE_ROOT = GAE_ROOT_REMOTE; const ERROR_UNAUTHORIZED_USER = 'Unauthorized user'; return { /** * Root path to our gae server * @type {string} * @memberOf app.Gae */ GAE_ROOT: GAE_ROOT, /** * Perform POST request to endpoint * @param {string} url - server Endpoint * @param {boolean} retryToken - if true, * retry with new token on error * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise.&lt;void&gt;} void * @memberOf app.Gae */ doPost: function(url, retryToken = false, interactive = false) { const conf = Chrome.JSONUtils.shallowCopy(Chrome.Http.conf); conf.isAuth = true; conf.retryToken = retryToken; conf.interactive = interactive; return Chrome.Http.doPost(url, conf).then((json) =&gt; { if (json.success) { return Promise.resolve(); } else { throw new Error(json.reason); } }); }, /** * Notify listeners that send message failed * @param {Error} err - what caused the failure * @memberOf app.Gae */ sendMessageFailed: function(err) { Chrome.GA.error(err, 'GAE.sendMessageFailed'); const msg = app.ChromeMsg.MSG_FAILED; msg.error = err.toString(); Chrome.Msg.send(msg).catch(() =&gt; {}); }, }; })(); × Search results Close "},"scripts_background_messaging_client.js.html":{"id":"scripts_background_messaging_client.js.html","title":"Source: scripts/background/messaging_client.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/messaging_client.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Send messages to the gae server MessagingEndpoint for delivery * @namespace */ app.Msg = (function() { 'use strict'; new ExceptionHandler(); /** * Base path of MessagingEndpoint * @const * @private * @memberOf app.Msg */ const URL_BASE = `${app.Gae.GAE_ROOT}/messaging/v1/send/`; /** * Max message length. Server may reduce it more * @const * @default * @private * @memberOf app.Msg */ const MAX_MSG_LEN = 4096; /** * Message action * @type {{MESSAGE: string, * PING: string, * PING_RESPONSE: string, * DEVICE_ADDED: string, * DEVICE_REMOVED: string}} * @const * @default * @memberOf app.Msg */ const ACTION = { MESSAGE: 'm', PING: 'ping_others', PING_RESPONSE: 'respond_to_ping', DEVICE_ADDED: 'add_our_device', DEVICE_REMOVED: 'remove_our_device', }; /** * Message body * @type {{PING: string, * PING_RESPONSE: string, * DEVICE_ADDED: string, * DEVICE_REMOVED: string}} * @const * @default * @private * @memberOf app.Msg */ const BODY = { PING: 'Contacting other devices...', PING_RESPONSE: 'Device is online', DEVICE_ADDED: 'New device added', DEVICE_REMOVED: 'Device removed', }; /** * Data packet sent to server * @typedef {{}} GaeMsg * @property {string} act - type of message * @property {string} m - content of message * @property {string} dM - {@link Device} model * @property {string} dSN - {@link Device} serial number * @property {string} dOS - {@link Device} operating system * @property {string} dN - {@link Device} nickname * @property {string} fav - '1' if favorite item (optional) * @property {string} srcRegId - source of ping (optional) */ /** * Get the data packet we will send * @param {string} action - message type * @param {string} body - message body * @returns {GaeMsg} data packet * @private * @memberOf app.Msg */ function _getData(action, body) { const msg = _getDevice(); msg.act = action; msg.m = body; return msg; } /** * Get portion of {@link Device} sent in message * @returns {{}} Subset of {@link Device} info as object literal * @memberOf app.Msg */ function _getDevice() { return { [app.Device.MODEL]: app.Device.myModel(), [app.Device.SN]: app.Device.mySN(), [app.Device.OS]: app.Device.myOS(), [app.Device.NICKNAME]: app.Device.myNickname(), }; } /** * Send message to server for delivery to our {@link Devices} * @param {GaeMsg} data - data packet * @param {boolean} notify - display notification if true * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.Msg */ function _sendMessage(data, notify) { if (!app.MyData.isSignedIn() || !app.MyData.allowPush()) { return Promise.resolve(); } let url; return app.Fb.getRegToken().then((regId) =&gt; { const json = encodeURIComponent(JSON.stringify(data)); const highPriority = Chrome.Storage.getBool('highPriority'); url = `${URL_BASE}${regId}/${json}/${highPriority}`; return app.Gae.doPost(url, true); }).then(() =&gt; { if (notify &amp;&amp; app.Notify.onSend()) { app.Notify.create(app.Notify.NOTIFY_SEND, data); } Chrome.GA.event(app.GA.EVENT.SENT); return Promise.resolve(); }); } return { ACTION: ACTION, /** * Send clipboard contents as represented by a {@link ClipItem} * @param {ClipItem} clipItem - contents of clipboard * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendClipItem: function(clipItem) { if (app.Utils.isWhiteSpace(clipItem.text)) { return Promise.resolve(); } let text = clipItem.text; if (text.length &gt; MAX_MSG_LEN) { // limit message size. Server may limit more text = text.substring(0, MAX_MSG_LEN - 1); } const data = _getData(ACTION.MESSAGE, text); data.FAV = clipItem.fav ? '1' : '0'; return _sendMessage(data, true); }, /** * Send message for adding our {@link Device} * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendDeviceAdded: function() { const data = _getData(ACTION.DEVICE_ADDED, BODY.DEVICE_ADDED); return _sendMessage(data, true); }, /** * Send message for removing our {@link Device} * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendDeviceRemoved: function() { const data = _getData(ACTION.DEVICE_REMOVED, BODY.DEVICE_REMOVED); return _sendMessage(data, true); }, /** * Ping our {@link app.Devices} * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendPing: function() { const data = _getData(ACTION.PING, BODY.PING); return _sendMessage(data, false); }, /** * Respond to a ping from one of our {@link app.Devices} * @param {string} srcRegId - source of ping * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendPingResponse: function(srcRegId) { const data = _getData(ACTION.PING_RESPONSE, BODY.PING_RESPONSE); data.srcRegId = srcRegId; return _sendMessage(data, false); }, }; })(); × Search results Close "},"scripts_my_data.js.html":{"id":"scripts_my_data.js.html","title":"Source: scripts/my_data.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/my_data.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * The extension's localStorage data * @namespace */ app.MyData = (function() { 'use strict'; new ExceptionHandler(); /** * Version of data - update when items are added, removed, changed * @type {int} * @default * @const * @private * @memberOf app.MyData */ const _VERSION = 2; /** * The data items saved to localStorage * * @typedef {Object} app.MyData.MyData * @property {int} version - version of data * @property {boolean} monitorClipboard - save clipboard contents * @property {boolean} allowPush - send push notifications * @property {boolean} autoSend - automatically send push notifications * @property {boolean} allowReceive - receive push notifications * @property {int} storageDuration - how long to save clipItems * @property {boolean} notify - xxx * @property {boolean} notifyOnSend - show notification on send push * @property {boolean} notifyOnReceive - show notification on receive push * @property {boolean} highPriority - send high priority messages * @property {string} deviceSN - serial number of our device * @property {string} deviceNickname - nickname of our device * @property {Object} devices - other devices we know about * @property {boolean} signedIn - are we logged in * @property {boolean} registered - are we registered with server * @property {boolean} needsCleanup - does are log in state need cleanup * @property {string} email - our email address * @property {string} uid - our unique id * @property {string} photoURL - path to out photo url * @property {string} permissions - enum: notSet allowed denied * @memberOf app.MyData */ /** * Default values for localStorage items * @type {app.MyData.MyData} * @const * @private * @memberOf app.MyData */ const _DEFAULTS = { 'version': _VERSION, 'monitorClipboard': true, 'allowPush': true, 'autoSend': true, 'allowReceive': true, 'storageDuration': 2, 'notify': true, 'notifyOnSend': false, 'notifyOnReceive': true, 'highPriority': true, 'deviceNickname': '', 'devices': {}, 'signedIn': false, 'registered': false, 'needsCleanup': false, 'email': '', 'uid': '', 'photoURL': '', 'permissions': 'notSet', // enum: notSet allowed denied }; return { /** * Get the current data version * @returns {int} the version of our data * @memberOf app.MyData */ getCurrentVersion: function() { return _VERSION; }, /** * Save the [_DEFAULTS]{@link app.MyData._DEFAULTS}, if they * do not already exist * @memberOf app.MyData */ saveDefaults: function() { Object.keys(_DEFAULTS).forEach(function(key) { if (Chrome.Storage.get(key) === null) { Chrome.Storage.set(key, _DEFAULTS[key]); } }); // and the autogenerated serial number if (Chrome.Storage.get('deviceSN') === null) { Chrome.Storage.set('deviceSN', app.Utils.randomString(8)); } }, /** * Are we saving clipboard contents * @returns {boolean} true if enabled * @memberOf app.MyData */ isMonitorClipboard: function() { return Chrome.Storage.getBool('monitorClipboard'); }, /** * Has user enabled pushing to {@link app.Devices} * @returns {boolean} true if enabled * @memberOf app.MyData */ allowPush: function() { return Chrome.Storage.getBool('allowPush'); }, /** * Has user enabled autoSend option * @returns {boolean} true if enabled * @memberOf app.MyData */ isAutoSend: function() { return Chrome.Storage.getBool('autoSend'); }, /** * Has user enabled receiving from {@link app.Devices} * @returns {boolean} true if enabled * @memberOf app.MyData */ allowReceive: function() { return Chrome.Storage.getBool('allowReceive'); }, /** * Are we signed in * @returns {boolean} true if signed in * @memberOf app.MyData */ isSignedIn: function() { return Chrome.Storage.getBool('signedIn'); }, /** * Are we registered with fcm * @returns {boolean} true if registered * @memberOf app.MyData */ isRegistered: function() { return Chrome.Storage.getBool('registered'); }, /** * Are we not registered with fcm * @returns {boolean} true if not registered * @memberOf app.MyData */ notRegistered: function() { return !this.isRegistered(); }, /** * Get our serial number * @returns {boolean} true if not registered * @memberOf app.MyData */ getDeviceSN: function() { return Chrome.Storage.get('deviceSN'); }, }; })(); × Search results Close "},"scripts_background_notify.js.html":{"id":"scripts_background_notify.js.html","title":"Source: scripts/background/notify.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/notify.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle display of notifications * @namespace */ app.Notify = (function() { 'use strict'; new ExceptionHandler(); /** * Send notification type * @type {string} * @default * @const * @private * @memberOf app.Notify */ const NOTIFY_SEND = 'CLIP_MAN_SEND'; /** * Icons * @type {{LOCAL_COPY: string, * ADD_DEVICE: string, * REMOVE_DEVICE: string}} * @const * @default * @private * @memberOf app.Notify */ const ICON = { LOCAL_COPY: '/images/ic_local_copy.png', ADD_DEVICE: '/images/ic_add_device.png', REMOVE_DEVICE: '/images/ic_remove_device.png', }; /** * Get the icon for the notification * @param {GaeMsg} data message object * @returns {?string} path to icon, null for * actions without notifications (ping) * @memberOf app.Notify */ function _getIcon(data) { let path = ''; if (data.act === app.Msg.ACTION.MESSAGE) { path = ICON.LOCAL_COPY; } else if (data.act === app.Msg.ACTION.DEVICE_ADDED) { path = ICON.ADD_DEVICE; } else if (data.act === app.Msg.ACTION.DEVICE_REMOVED) { path = ICON.REMOVE_DEVICE; } return path; } /** * Event: Fired when the user clicked in a non-button area * of the notification. * @see https://developer.chrome.com/apps/notifications#event-onClicked * @param {string} id - notification type * @private * @memberOf app.Notify */ function _onNotificationClicked(id) { app.Notify.showMainTab(); chrome.notifications.clear(id, () =&gt; {}); } // Listen for click on our notifications chrome.notifications.onClicked.addListener(_onNotificationClicked); return { /** * Send notification type * @memberOf app.Notify */ NOTIFY_SEND: NOTIFY_SEND, /** * Create and display a notification * @param {string} type - notification type (send or receive) * @param {GaeMsg} data - message data * @memberOf app.Notify */ create: function(type, data) { const options = { type: 'basic', title: 'Pushy', isClickable: true, eventTime: Date.now(), }; const icon = _getIcon(data); if (!icon) { // skip ping messages return; } chrome.notifications.getPermissionLevel(function(level) { if (level === 'granted') { switch (type) { case NOTIFY_SEND: options.iconUrl = chrome.runtime.getURL(icon); options.title = 'Sent push message'; options.message = data.m; chrome.notifications.create(type, options, () =&gt; {}); break; default: break; } } }); }, /** * Determine if send notifications are enabled * @returns {boolean} true if enabled * @memberOf app.Notify */ onSend: function() { const notify = Chrome.Storage.getBool('notify'); const notifyOnSend = Chrome.Storage.getBool('notifyOnSend'); return notify &amp;&amp; notifyOnSend; }, /** * Send message to the main tab to focus it. If not found, create it * @memberOf app.Notify */ showMainTab: function() { // send message to the main tab to focus it. Chrome.Msg.send(app.ChromeMsg.HIGHLIGHT).catch(() =&gt; { // no one listening, create it chrome.tabs.create({url: '../html/main.html'}); }); }, }; })(); × Search results Close "},"scripts_permissions.js.html":{"id":"scripts_permissions.js.html","title":"Source: scripts/permissions.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/permissions.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle optional permissions * @namespace */ app.Permissions = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** @memberOf app.Permissions */ const PERMISSIONS = ['tabs']; /** @memberOf app.Permissions */ const ORIGINS = ['http://*/*', 'https://*/*']; /** @memberOf app.Permissions */ const NOT_SET = 'notSet'; /** @memberOf app.Permissions */ const ALLOWED = 'allowed'; /** @memberOf app.Permissions */ const DENIED = 'denied'; return { /** @memberOf app.Permissions */ NOT_SET: NOT_SET, /** @memberOf app.Permissions */ ALLOWED: ALLOWED, /** @memberOf app.Permissions */ DENIED: DENIED, /** * Has use made choice on permissions * @returns {boolean} true if allowed or denied * @memberOf app.Permissions */ notSet: function() { return Chrome.Storage.get('permissions') === NOT_SET; }, /** * Has the user allowed the optional permissions * @returns {boolean} true if allowed * @memberOf app.Permissions */ isAllowed: function() { return Chrome.Storage.get('permissions') === ALLOWED; }, /** * Prompt for the optional permissions * @returns {Promise&lt;boolean&gt;} true if permission granted * @memberOf app.Permissions */ request: function() { // if promise chain const ifGranted = function(isTrue) { if (isTrue) { Chrome.Storage.set('permissions', app.Permissions.ALLOWED); return Promise.resolve(isTrue); } else { // remove if it has been previously granted return app.Permissions.remove().then(() =&gt; { return Promise.resolve(isTrue); }); } }; return chromep.permissions.request({ permissions: PERMISSIONS, origins: ORIGINS, }).then((granted) =&gt; { return ifGranted(granted); }); }, /** * Determine if we have the optional permissions * @returns {Promise&lt;boolean&gt;} true if we have permissions * @memberOf app.Permissions */ contains: function() { return chromep.permissions.contains({ permissions: PERMISSIONS, origins: ORIGINS, }); }, /** * Remove the optional permissions * @returns {Promise&lt;boolean&gt;} true if removed * @memberOf app.Permissions */ remove: function() { // if promise chain const ifContains = function(isTrue) { if (isTrue) { // remove permission return chromep.permissions.remove({ permissions: PERMISSIONS, }).then((removed) =&gt; { if (removed) { Chrome.Storage.set('permissions', app.Permissions.DENIED); } return Promise.resolve(removed); }); } else { return Promise.resolve(isTrue); } }; return app.Permissions.contains().then((contains) =&gt; { return ifContains(contains); }); }, /** * Inject our script into all tabs that match * @memberOf app.Permissions */ injectContentScripts: function() { // noinspection JSCheckFunctionSignatures if (app.Permissions.isAllowed()) { chrome.windows.getAll({populate: true}, function(windows) { for (let i = 0; i &lt; windows.length; i++) { // all windows const win = windows[i]; for (let j = 0; j &lt; win.tabs.length; j++) { // all tabs in window const tab = win.tabs[j]; // our matches if (tab.url.match(/(http|https):\\/\\//gi)) { app.Permissions.injectContentScript(tab.id); } } } }); } }, /** * Inject our script into the given tab * @param {int} tabId - tab to inject * @memberOf app.Permissions */ injectContentScript: function(tabId) { if (app.Permissions.isAllowed()) { chrome.tabs.executeScript(tabId, { file: 'scripts/on_copy_cut_content_script.js', allFrames: true, matchAboutBlank: true, }, function() { if (chrome.runtime.lastError) { // noinspection UnnecessaryReturnStatementJS return; } }); } }, }; })(); × Search results Close "},"scripts_background_registration_client.js.html":{"id":"scripts_background_registration_client.js.html","title":"Source: scripts/background/registration_client.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/registration_client.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle RegistrationEndpoint tasks on the gae server * @namespace */ app.Reg = (function() { 'use strict'; new ExceptionHandler(); /** * Base path of RegistrationEndpoint * @type string * @const * @private * @memberOf app.Reg */ const URL_BASE = `${app.Gae.GAE_ROOT}/registration/v1/`; /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf app.Reg */ function _onStorageChanged(event) { if (event.key === 'allowReceive') { const allowReceive = app.MyData.allowReceive(); if (allowReceive) { // user wants to receive messages now app.Reg.register(true).catch((err) =&gt; { Chrome.GA.error(err.message, 'Reg._onStorageChanged'); Chrome.Storage.set('allowReceive', !allowReceive); const msg = app.ChromeMsg.REGISTER_FAILED; msg.error = err.toString(); // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); }); } else { // user no longer wants to receive messages app.Reg.unregister(true).catch((err) =&gt; { Chrome.GA.error(err.message, 'Reg._onStorageChanged'); Chrome.Storage.set('allowReceive', !allowReceive); const msg = app.ChromeMsg.UNREGISTER_FAILED; msg.error = err.toString(); // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); }); } } } /** * Listen for changes to localStorage */ addEventListener('storage', _onStorageChanged, false); return { /** * Register {@link Device} with server * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise&lt;void&gt;} void * @memberOf app.Reg */ register: function(interactive = false) { if (app.MyData.isRegistered() || !app.MyData.allowReceive()) { return Promise.resolve(); } return app.Fb.getRegToken().then((regId) =&gt; { const url = `${URL_BASE}register/${regId}`; return app.Gae.doPost(url, true, interactive); }).then(() =&gt; { Chrome.GA.event(app.GA.EVENT.REGISTERED); Chrome.Storage.set('registered', true); return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Reg.register'); const prefix = 'Failed to register with the server.\\n'; throw new Error(prefix + err.message); }); }, /** * Unregister {@link Device} with server * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise&lt;void&gt;} void * @memberOf app.Reg */ unregister: function(interactive = false) { if (app.MyData.notRegistered()) { return Promise.resolve(); } return app.Fb.getRegToken().then((regId) =&gt; { const url = `${URL_BASE}unregister/${regId}`; return app.Gae.doPost(url, true, interactive); }).then(() =&gt; { Chrome.GA.event(app.GA.EVENT.UNREGISTERED); Chrome.Storage.set('registered', false); return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Reg.unregister'); const prefix = 'Failed to unregister with the server.\\n'; throw new Error(prefix + err.message); }); }, }; })(); × Search results Close "},"scripts_background_service_worker.js.html":{"id":"scripts_background_service_worker.js.html","title":"Source: scripts/background/service_worker.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/service_worker.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage lifecycle of our {@link ServiceWorker} * @namespace */ app.SW = (function() { 'use strict'; new ExceptionHandler(); const _ERR_REG = 'Failed to register Service Worker: '; const _ERR_UNREG = 'Failed to unregister Service Worker: '; const _ERR_NOT_REG = 'Not registered '; const _ERR_UNREG_BOOL = 'returned false'; /** * Path to our {@link ServiceWorker} * @const * @default * @private * @memberOf app.SW */ const SERVICE_WORKER = '../scripts/sw.js'; /** * Our ServiceWorkerRegistration object * @private * @memberOf app.SW */ let _swRegistration = null; /** * Register the Service Worker * Note: This can be called if already registered * @returns {Promise&lt;Object&gt;} service worker * @private * @memberOf app.SW */ function _register() { return navigator.serviceWorker.register(SERVICE_WORKER).then((swReg) =&gt; { _swRegistration = swReg; return Promise.resolve(_swRegistration); }).catch((err) =&gt; { throw new Error(_ERR_REG + err.message); }); } /** * Unsubscribe from push notifications * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.SW */ function _unsubscribePush() { return _swRegistration.pushManager.getSubscription().then((sub) =&gt; { if (sub) { return sub.unsubscribe(); } else { throw new Error('Not subscribed'); } }); } return { /** * Initialize the {@link ServiceWorker} and firebase * @returns {Promise&lt;void&gt;} void * @memberOf app.SW */ initialize: function() { if (_swRegistration) { return Promise.resolve(); } return _register().then((swReg) =&gt; { return app.Fb.initialize(swReg); }).then(() =&gt; { return Promise.resolve(); }).catch((err) =&gt; { throw new Error(_ERR_REG + err.message); }); }, /** * Unregister the Service Worker * @returns {Promise&lt;void&gt;} void * @memberOf app.SW */ unregister: function() { if (!_swRegistration) { throw new Error(_ERR_UNREG + _ERR_NOT_REG); } return _unsubscribePush().then(() =&gt; { return _swRegistration.unregister(); }).then((unregistered) =&gt; { if (unregistered) { _swRegistration = null; return Promise.resolve(); } else { throw new Error(_ERR_UNREG + _ERR_UNREG_BOOL); } }).catch((err) =&gt; { throw new Error(_ERR_UNREG + err.message); }); }, /** * Update the Service Worker * @returns {Promise&lt;void&gt;} void always resolves * @memberOf app.SW */ update: function() { if (_swRegistration) { _swRegistration.update(); } return Promise.resolve(); }, }; })(); × Search results Close "},"scripts_background_user.js.html":{"id":"scripts_background_user.js.html","title":"Source: scripts/background/user.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/user.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the current user * @namespace */ app.User = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Set signIn state * @param {boolean} val - true if signed in * @private */ function _setSignIn(val) { Chrome.Storage.set('signedIn', val); app.Utils.setBadgeText(); if (!val) { Chrome.Storage.set('photoURL', ''); } } /** * Get an OAuth2.0 token * @see https://developer.chrome.com/apps/identity#method-getAuthToken * @returns {Promise&lt;string&gt;} An access token * @private * @memberOf app.User */ function _getAuthToken() { return chromep.identity.getAuthToken({ 'interactive': false, }).then((token) =&gt; { return Promise.resolve(token); }); } /** * Event: Fired when signin state changes for an act. on the user's profile. * @see https://developer.chrome.com/apps/identity#event-onSignInChanged * @param {Object} account - chrome AccountInfo * @param {boolean} signedIn - true if signedIn * @private * @memberOf app.User */ function _onSignInChanged(account, signedIn) { const uid = Chrome.Storage.get('uid'); if (app.MyData.isSignedIn() &amp;&amp; !signedIn &amp;&amp; (account.id === uid)) { // our user signed out of Chrome while we were signed in Chrome.Storage.set('needsCleanup', true); _setSignIn(false); Chrome.Storage.set('registered', false); app.Fb.signOut().catch(() =&gt; {}); } app.User.setInfo().catch((err) =&gt; { Chrome.GA.error(err.message, 'User._onSignInChanged'); }); } /** * Cleanup if user signed-out of Browser * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.User */ function _needsCleanup() { if (Chrome.Storage.getBool('needsCleanup')) { Chrome.Storage.set('needsCleanup', false); return _getAuthToken().then((token) =&gt; { return chromep.identity.removeCachedAuthToken({'token': token}); }); } else { return Promise.resolve(); } } /** * Sign in and register our {@link Device} * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.User */ function _addAccess() { return _needsCleanup().then(() =&gt; { return app.SW.initialize(); }).then(() =&gt; { return app.Reg.register(true); }).then(() =&gt; { return _getAuthToken(); }).then((token) =&gt; { return app.Fb.signIn(token); }).then((user) =&gt; { _setSignIn(true); if (!app.Utils.isWhiteSpace(user.photoURL)) { Chrome.Storage.set('photoURL', user.photoURL); } return app.Msg.sendDeviceAdded(); }); } /** * Unregister {@link Device} and sign out of firebase * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.User */ function _removeAccess() { return app.Msg.sendDeviceRemoved().then(() =&gt; { return app.Reg.unregister(true); }).then(() =&gt; { return app.Fb.signOut(); }).then(() =&gt; { _setSignIn(false); app.Devices.clear(); return Promise.resolve(); }); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.User */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.SIGN_IN.message) { // try to signIn a user ret = true; // async _addAccess().then(() =&gt; { response({message: 'ok'}); return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'User._onChromeMessage'); _removeAccess().then(() =&gt; { return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'User._onChromeMessage'); _setSignIn(false); Chrome.Storage.set('registered', false); }); response({message: 'error', error: err.message}); }); } else if (request.message === app.ChromeMsg.SIGN_OUT.message) { // try to signOut a user ret = true; // async _removeAccess().then(() =&gt; { response({message: 'ok'}); return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'User._onChromeMessage'); response({message: 'error', error: err.message}); }); } return ret; } /** * Listen for changes to Browser sign-in */ chrome.identity.onSignInChanged.addListener(_onSignInChanged); /** * Listen for Chrome messages */ Chrome.Msg.listen(_onChromeMessage); return { /** * Persist info on current Browser user (may be no-one) * @returns {Promise&lt;void&gt;} void * @memberOf app.User */ setInfo: function() { return chromep.identity.getProfileUserInfo().then((user) =&gt; { Chrome.Storage.set('email', user.email); Chrome.Storage.set('uid', user.id); return Promise.resolve(); }); }, }; })(); × Search results Close "},"scripts_utils.js.html":{"id":"scripts_utils.js.html","title":"Source: scripts/utils.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/utils.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Misc. utility methods * @namespace */ app.Utils = (function() { 'use strict'; new ExceptionHandler(); const MIN_IN_DAY = 60 * 24; const MILLIS_IN_DAY = MIN_IN_DAY * 60 * 1000; return { /** * Number of minutes in a day * @const * @type {int} * @memberOf app.Utils */ MIN_IN_DAY: MIN_IN_DAY, /** * Number of milliseconds a in day * @const * @type {int} * @memberOf app.Utils */ MILLIS_IN_DAY: MILLIS_IN_DAY, /** * Set the badge displayed on the extension icon * @memberOf app.Utils */ setBadgeText: function() { let text = ''; if (app.MyData.isSignedIn() &amp;&amp; app.MyData.allowPush()) { text = 'SEND'; } chrome.browserAction.setBadgeText({text: text}); }, /** * Determine if a String is null or whitespace only * @param {string} str - string to check * @returns {boolean} true if str is whitespace (or null) * @memberOf app.Utils */ isWhiteSpace: function(str) { return (!str || str.length === 0 || /^\\s*$/.test(str)); }, /** * Get a date string in time ago format * @param {int} time - time since epoch in millis * @returns {string} Relative time format * @memberOf app.Utils */ getRelativeTime: function(time) { return `${moment(time).fromNow()}, ` + `${moment(time).format('h:mm a')}`; }, /** * Get a random string of the given length * @param {int|null} len - length of generated string, 8 if null * @returns {string} a random string * @memberOf app.Utils * */ randomString: function(len) { const POSS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz0123456789'; !len ? len = 8 : true; if (!len) { len = 8; } let text = ''; for (let i = 0; i &lt; len; i++) { text += POSS.charAt(Math.floor(Math.random() * POSS.length)); } return text; }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_chrome_analytics.js.html":{"id":"bower_components_chrome-extension-utils_chrome_analytics.js.html","title":"Source: bower_components/chrome-extension-utils/chrome_analytics.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/chrome_analytics.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Google Analytics tracking * @namespace */ Chrome.GA = (function() { 'use strict'; /** * Google Analytics Event * @typedef {Object} Chrome.GA.Event * @property {string} eventCategory - category * @property {string} eventAction - action * @property {string} eventLabel - label * @memberOf Chrome.GA */ /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Google Analytics * @private * @memberOf Chrome.GA */ function _onLoad() { // Standard Google Universal Analytics code // noinspection OverlyComplexFunctionJS (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; // noinspection CommaExpressionJS i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }, i[r].l = 1 * new Date(); // noinspection CommaExpressionJS a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga'); } // listen for document and resources loaded window.addEventListener('load', _onLoad); /** * Event types * @type {{}} * @property {Chrome.GA.Event} INSTALLED - extension installed * @property {Chrome.GA.Event} MENU - menu selected * @property {Chrome.GA.Event} TOGGLE - setting-toggle * @property {Chrome.GA.Event} LINK - setting-link * @property {Chrome.GA.Event} BUTTON - button click * @property {Chrome.GA.Event} ICON - toolbar icon click * @property {Chrome.GA.Event} CHECK - checkbox click * @const * @memberOf Chrome.GA */ const EVENT = { INSTALLED: { eventCategory: 'extension', eventAction: 'installed', eventLabel: '', }, MENU: { eventCategory: 'ui', eventAction: 'menuSelect', eventLabel: '', }, TOGGLE: { eventCategory: 'ui', eventAction: 'toggle', eventLabel: '', }, LINK: { eventCategory: 'ui', eventAction: 'linkSelect', eventLabel: '', }, BUTTON: { eventCategory: 'ui', eventAction: 'buttonClicked', eventLabel: '', }, ICON: { eventCategory: 'ui', eventAction: 'toolbarIconClicked', eventLabel: '', }, CHECK: { eventCategory: 'ui', eventAction: 'checkBoxClicked', eventLabel: '', }, }; return { EVENT: EVENT, /** * Initialize analytics * @param {string} trackingId - tracking id * @param {string} appName - extension name * @param {string} appId - extension Id * @param {string} appVersion - extension version * @memberOf Chrome.GA */ initialize: function(trackingId, appName, appId, appVersion) { ga('create', trackingId, 'auto'); // see: http://stackoverflow.com/a/22152353/1958200 ga('set', 'checkProtocolTask', function() { }); ga('set', 'appName', appName); ga('set', 'appId', appId); ga('set', 'appVersion', appVersion); ga('require', 'displayfeatures'); }, /** * Send a page * @param {string} page - page path * @memberOf Chrome.GA */ page: function(page) { if (page) { ga('send', 'pageview', page); } }, /** * Send an event * @param {Chrome.GA.Event} event - the event type * @param {?string} [label=null] - override label * @param {?string} [action=null] - override action * @memberOf Chrome.GA */ event: function(event, label = null, action = null) { if (event) { const ev = Chrome.JSONUtils.shallowCopy(event); ev.hitType = 'event'; ev.eventLabel = label ? label : ev.eventLabel; ev.eventAction = action ? action : ev.eventAction; ga('send', ev); } }, /** * Send an error * @param {?string} [label=null] - override label * @param {?string} [action=null] - override action * @memberOf Chrome.GA */ error: function(label = null, action = null) { const ev = { hitType: 'event', eventCategory: 'error', eventAction: 'unknownMethod', eventLabel: 'Err: unknown', }; ev.eventLabel = label ? `Err: ${label}` : ev.eventLabel; ev.eventAction = action ? action : ev.eventAction; ga('send', ev); console.error('Error: ', ev); }, /** * Send an exception * @param {string} message - the error message * @param {?string} [stack=null] - error stack * @param {boolean} [fatal=null] - true if fatal * @memberOf Chrome.GA */ exception: function(message, stack = null, fatal = true) { try { let msg = ''; if (message) { msg += message; } if (stack) { msg += `\\n${stack}`; } const ex = { hitType: 'exception', exDescription: msg, exFatal: fatal, }; ga('send', ex); console.error('Exception caught: ', ex); } catch (err) { // noinspection BadExpressionStatementJS Function.prototype; } }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_http.js.html":{"id":"bower_components_chrome-extension-utils_http.js.html","title":"Source: bower_components/chrome-extension-utils/http.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/http.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Fetch with authentication and exponential back-off * @namespace */ Chrome.Http = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Http configuration * @typedef {?Object} Chrome.Http.Config * @property {boolean} [isAuth=false] - if true, authorization required * @property {boolean} [retryToken=false] - if true, retry with new token * @property {boolean} [interactive=false] - user initiated, if true * @property {?string} [token=null] - auth token * @property {boolean} [backoff=true] - if true, do exponential back-off * @property {int} [maxRetries=_MAX_ATTEMPTS] - max retries * @memberOf Chrome.Http */ /** * Authorization header * @type {string} * @private * @memberOf Chrome.Http */ const _AUTH_HEADER = 'Authorization'; /** * Bearer parameter for authorized call * @type {string} * @private * @memberOf Chrome.Http */ const _BEARER = 'Bearer'; /** * Max retries on 500 errors * @type {int} * @private * @memberOf Chrome.Http */ const _MAX_RETRIES = 3; /** * Delay multiplier for exponential back-off * @const * @default * @private * @memberOf Chrome.Http */ const _DELAY = 1000; /** * Configuration object * @type {Chrome.Http.Config} * @private * @memberOf Chrome.Http */ const _CONFIG = { isAuth: false, retryToken: false, interactive: false, token: null, backoff: true, maxRetries: _MAX_RETRIES, }; /** * Check response and act accordingly * @param {{}} response - response from server * @param {string} url - server * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _processResponse(response, url, opts, conf, attempt) { if (response.ok) { // request succeeded - woo hoo! return response.json(); } if (attempt &gt;= conf.maxRetries) { // request still failed after maxRetries return Promise.reject(_getError(response)); } const status = response.status; if (conf.backoff &amp;&amp; (status &gt;= 500) &amp;&amp; (status &lt; 600)) { // temporary server error, maybe. Retry with backoff return _retry(url, opts, conf, attempt); } if (conf.isAuth &amp;&amp; conf.token &amp;&amp; conf.retryToken &amp;&amp; (status === 401)) { // could be expired token. Remove cached one and try again return _retryToken(url, opts, conf, attempt); } if (conf.isAuth &amp;&amp; conf.interactive &amp;&amp; conf.token &amp;&amp; conf.retryToken &amp;&amp; (status === 403)) { // user may have revoked access to extension at some point // If interactive, retry so they can authorize again return _retryToken(url, opts, conf, attempt); } // request failed return Promise.reject(_getError(response)); } /** * Get Error message * @param {{}} response - server response * @returns {Error} details on failure * @private * @memberOf Chrome.Http */ function _getError(response) { let msg = 'Unknown error.'; if (response &amp;&amp; response.status &amp;&amp; (response.statusText !== undefined)) { const statusMsg = Chrome.Utils.localize('err_status'); msg = `${statusMsg}: ${response.status}`; msg += `\\n${response.statusText}`; } return new Error(msg); } /** * Get authorization token * @param {boolean} isAuth - if true, authorization required * @param {boolean} interactive - if true, user initiated * @returns {Promise.&lt;string&gt;} auth token * @private * @memberOf Chrome.Http */ function _getAuthToken(isAuth, interactive) { if (isAuth) { return chromep.identity.getAuthToken({ 'interactive': interactive, }).then((token) =&gt; { return Promise.resolve(token); }).catch((err) =&gt; { if (interactive &amp;&amp; (err.message.includes('revoked') || err.message.includes('Authorization page could not be loaded'))) { // try one more time non-interactively // Always returns Authorization page error // when first registering, Not sure why // Other message is if user revoked access to extension return chromep.identity.getAuthToken({ 'interactive': false, }); } else { throw err; } }); } else { // non-authorization branch return Promise.resolve(null); } } /** * Retry authorized fetch with exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _retry(url, opts, conf, attempt) { attempt++; // eslint-disable-next-line promise/avoid-new return new Promise((resolve, reject) =&gt; { const delay = (Math.pow(2, attempt) - 1) * _DELAY; setTimeout(() =&gt; { const newConfig = Chrome.JSONUtils.shallowCopy(conf); newConfig.backoff = true; return _fetch(url, opts, conf, attempt).then(resolve, reject); }, delay); }); } /** * Retry fetch after removing cached auth token * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _retryToken(url, opts, conf, attempt) { Chrome.GA.error('Refresh auth token.', 'Http._retryToken'); return chromep.identity.removeCachedAuthToken({ token: conf.token, }).then(() =&gt; { const newConfig = Chrome.JSONUtils.shallowCopy(conf); newConfig.retryToken = false; return _fetch(url, opts, conf, attempt); }); } /** * Perform fetch, optionally using authorization and exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _fetch(url, opts, conf, attempt) { let token = ''; return _getAuthToken(conf.isAuth, conf.interactive).then((authToken) =&gt; { if (conf.isAuth) { token = authToken; opts.headers.set(_AUTH_HEADER, `${_BEARER} ${token}`); } return fetch(url, opts); }).then((response) =&gt; { return _processResponse(response, url, opts, conf, attempt); }).catch((err) =&gt; { let msg = err.message; if (msg === 'Failed to fetch') { msg = Chrome.Utils.localize('err_network'); } throw new Error(msg); }); } /** * Do a server request * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _doIt(url, opts, conf) { conf = (conf === null) ? _CONFIG : conf; if (conf.isAuth) { opts.headers.set(_AUTH_HEADER, `${_BEARER} unknown`); } let attempt = 0; return _fetch(url, opts, conf, attempt); } return { conf: _CONFIG, /** * Perform GET request * @param {string} url - server request * @param {Chrome.Http.Config} [conf=null] - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @memberOf Chrome.Http */ doGet: function(url, conf = null) { const opts = {method: 'GET', headers: new Headers({})}; return _doIt(url, opts, conf); }, /** * Perform POST request * @param {string} url - server request * @param {Chrome.Http.Config} [conf=null] - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @memberOf Chrome.Http */ doPost: function(url, conf = null) { const opts = {method: 'POST', headers: new Headers({})}; return _doIt(url, opts, conf); }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_json.js.html":{"id":"bower_components_chrome-extension-utils_json.js.html","title":"Source: bower_components/chrome-extension-utils/json.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/json.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * JSON utilities * @namespace */ Chrome.JSONUtils = (function() { 'use strict'; new ExceptionHandler(); return { /** * Parse JSON, with exception handling * @param {!string} jsonString - string to parse * @returns {?JSON} JSON Object, null on error * @memberOf Chrome.JSONUtils */ parse: function(jsonString) { let ret = null; try { ret = JSON.parse(jsonString); } catch (err) { Chrome.GA.exception(`Caught: JSONUtils.parse: ${err.message}`, err.stack, false); } return ret; }, /** * Return shallow copy of Object * @param {!Object} object - object to copy * @returns {?JSON} JSON Object, null on error * @memberOf Chrome.JSONUtils */ shallowCopy: function(object) { let ret = null; const jsonString = JSON.stringify(object); if (typeof(jsonString) !== 'undefined') { ret = Chrome.JSONUtils.parse(jsonString); } return ret; }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_locales.js.html":{"id":"bower_components_chrome-extension-utils_locales.js.html","title":"Source: bower_components/chrome-extension-utils/locales.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/locales.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Locale methods * @see https://developer.chrome.com/extensions/i18n * @namespace */ Chrome.Locale = (function() { 'use strict'; new ExceptionHandler(); return { /** * Get the i18n string * @param {string} messageName - key in messages.json * @returns {string} internationalized string * @memberOf Chrome.Locale */ localize: function(messageName) { return chrome.i18n.getMessage(messageName); }, /** * Get the current locale * @returns {string} current locale e.g. en_US * @memberOf Chrome.Locale */ getLocale: function() { return chrome.i18n.getMessage('@@ui_locale'); }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_chrome_msg.js.html":{"id":"bower_components_chrome-extension-utils_chrome_msg.js.html","title":"Source: bower_components/chrome-extension-utils/chrome_msg.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/chrome_msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Wrapper for chrome messages * @namespace */ Chrome.Msg = (function() { 'use strict'; new ExceptionHandler(); /** * A Chrome message * @typedef {{}} Chrome.Msg.Message * @property {string} message - Unique name * @property {Error} error - an error * @property {string|Object} item - a message specific item * @property {boolean} updated - item is new or updated * @property {string} key - key name * @property {?Object} value - value of key * @memberOf Chrome.Msg */ /** * A save attempt to localStorage exceeded its capacity * @type {Chrome.Msg.Message} * @memberOf Chrome.Msg */ const STORAGE_EXCEEDED = { message: 'storageExceeded', }; return { STORAGE_EXCEEDED: STORAGE_EXCEEDED, /** * Send a chrome message * @param {Chrome.Msg.Message} type - type of message * @returns {Promise&lt;JSON&gt;} response JSON * @memberOf Chrome.Msg */ send: function(type) { const chromep = new ChromePromise(); return chromep.runtime.sendMessage(type, null).then((response) =&gt; { return Promise.resolve(response); }).catch((err) =&gt; { if (err.message &amp;&amp; !err.message.includes('port closed') &amp;&amp; !err.message.includes('Receiving end does not exist')) { const msg = `type: ${type.message}, ${err.message}`; Chrome.GA.error(msg, 'Msg.send'); } return Promise.reject(err); }); }, /** * Add a listener for chrome messages * @param {Function} listener - function to receive messages * @memberOf Chrome.Msg */ listen: function(listener) { chrome.runtime.onMessage.addListener(listener); }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_storage.js.html":{"id":"bower_components_chrome-extension-utils_storage.js.html","title":"Source: bower_components/chrome-extension-utils/storage.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/storage.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Manage items in localStorage * @namespace */ Chrome.Storage = (function() { 'use strict'; new ExceptionHandler(); return { /** * Get a JSON parsed value from localStorage * @param {!string} key - key to get value for * @returns {?JSON} JSON object, null if key does not exist * @memberOf Chrome.Storage */ get: function(key) { let item = localStorage.getItem(key); let value = null; if (item !== null) { value = Chrome.JSONUtils.parse(item); } return value; }, /** * Get integer value from localStorage * @param {!string} key - key to get value for * @param {?int} [def=null] - optional value to return, if NaN * @returns {int} value as integer, NaN on error * @memberOf Chrome.Storage */ getInt: function(key, def = null) { let item = localStorage.getItem(key); let value = parseInt(item, 10); if (Number.isNaN(value)) { value = (def === null) ? value : def; if (def === null) { Chrome.GA.error(`NaN value for: ${key}`, 'Storage.getInt'); } } return value; }, /** * Get boolean value from localStorage * @param {!string} key - key to get value for * @returns {?boolean} value as boolean, null if key does not exist * @memberOf Chrome.Storage */ getBool: function(key) { return Chrome.Storage.get(key); }, /** * JSON stringify and save a value to localStorage * @param {!string} key - key to set value for * @param {?Object} [value=null] - new value, if null remove item * @memberOf Chrome.Storage */ set: function(key, value = null) { let val = value; if (value === null) { localStorage.removeItem(key); } else { val = JSON.stringify(value); localStorage.setItem(key, val); } }, /** * Save a value to localStorage only if there is enough room * @param {!string} key - localStorage Key * @param {Object} value - value to save * @param {string} [keyBool] - key to a boolean value * that is true if the primary key has non-empty value * @returns {boolean} true if value was set successfully * @memberOf Chrome.Storage */ safeSet: function(key, value, keyBool) { let ret = true; const oldValue = Chrome.Storage.get(key); try { Chrome.Storage.set(key, value); } catch (e) { ret = false; if (oldValue) { // revert to old value Chrome.Storage.set(key, oldValue); } if (keyBool) { // revert to old value if (oldValue &amp;&amp; oldValue.length) { Chrome.Storage.set(keyBool, true); } else { Chrome.Storage.set(keyBool, false); } } // notify listeners Chrome.Msg.send(Chrome.Msg.STORAGE_EXCEEDED).catch(() =&gt; { }); } return ret; }, }; })(); × Search results Close "},"bower_components_chrome-extension-utils_chrome_utils.js.html":{"id":"bower_components_chrome-extension-utils_chrome_utils.js.html","title":"Source: bower_components/chrome-extension-utils/chrome_utils.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/chrome_utils.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Utility methods * @namespace */ Chrome.Utils = (function() { 'use strict'; new ExceptionHandler(); return { /** Get the extension's name * @returns {string} Extension name * @memberOf Chrome.Utils */ getExtensionName: function() { return `chrome-extension://${chrome.runtime.id}`; }, /** * Get the Extension version * @returns {string} Extension version * @memberOf Chrome.Utils */ getVersion: function() { const manifest = chrome.runtime.getManifest(); return manifest.version; }, /** * Get the Chrome version * @see http://stackoverflow.com/a/4900484/4468645 * @returns {int} Chrome major version * @memberOf Chrome.Utils */ getChromeVersion: function() { const raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./); return raw ? parseInt(raw[2], 10) : false; }, /** * Get the full Chrome version * @see https://goo.gl/2ITMNO * @returns {string} Chrome version * @memberOf Chrome.Utils */ getFullChromeVersion: function() { const raw = navigator.userAgent; return raw ? raw : 'Unknown'; }, /** * Get the OS as a human readable string * @returns {Promise.&lt;string&gt;} OS name * @memberOf Chrome.Utils */ getPlatformOS: function() { const chromep = new ChromePromise(); return chromep.runtime.getPlatformInfo().then((info) =&gt; { let output = 'Unknown'; const os = info.os; switch (os) { case 'win': output = 'MS Windows'; break; case 'mac': output = 'Mac'; break; case 'android': output = 'Android'; break; case 'cros': output = 'Chrome OS'; break; case 'linux': output = 'Linux'; break; case 'openbsd': output = 'OpenBSD'; break; default: break; } return Promise.resolve(output); }); }, }; })(); × Search results Close "},"scripts_clip_item.js.html":{"id":"scripts_clip_item.js.html","title":"Source: scripts/clip_item.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/clip_item.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function(window) { 'use strict'; new ExceptionHandler(); /** * Create a new {@link ClipItem} * @constructor * @alias ClipItem * @param {string} text - The text of the clip * @param {int} date - Time in milliSecs from epoch * @param {boolean} fav - true if this has been marked as a favorite * @param {boolean} remote - true if this came from a device other than ours * @param {string} device - A String representing the source device */ const ClipItem = function(text, date, fav, remote, device) { this.text = text; this.date = date; this.fav = fav; this.remote = remote; this.device = device; }; /** * The Dexie database * @see http://dexie.org/ * @type {Object} * @private * @memberOf ClipItem */ let _db; /** * The Dexie database version * @const * @type {int} * @private * @memberOf ClipItem */ const VERSION = 1; /** * Error indicating that {@link ClipItem} text is null or all whitespace * @const * @default * @type {string} */ ClipItem.ERROR_EMPTY_TEXT = 'Empty text'; /** * Set date * @param {int} date - millis from epoch */ ClipItem.prototype.setDate = function(date) { this.date = date; }; /** * Get fav * @returns {boolean} fav */ ClipItem.prototype.getFav = function() { return this.fav; }; /** * Set favorite * @param {boolean} fav - is item a favorite */ ClipItem.prototype.setFav = function(fav) { this.fav = fav; }; /** * Set remote * @param {boolean} remote - true if not from our {@link Device} */ ClipItem.prototype.setRemote = function(remote) { this.remote = remote; }; /** * Save ourselves to storage * @returns {Promise&lt;string&gt;} primary key it was stored under */ ClipItem.prototype.save = function() { if (app.Utils.isWhiteSpace(this.text)) { return Promise.reject(new Error(ClipItem.ERROR_EMPTY_TEXT)); } return _db.clipItems.put(this); }; /** * Determine if {@link ClipItem} text exists in storage * @returns {Promise&lt;boolean&gt;} true if text exists */ ClipItem.prototype.exists = function() { return _db.clipItems.get(this.text).then((item) =&gt; { return Promise.resolve((item !== undefined)); }); }; /** * Add new {@link ClipItem} to storage * @param {string} text - The text of the clip * @param {int} date - Time in milliSecs from epoch * @param {boolean} fav - true if this has been marked as a favorite * @param {boolean} remote - true if this came from a device other than ours * @param {string} device - A String representing the source device * @returns {Promise&lt;ClipItem&gt;} A new {@link ClipItem} */ ClipItem.add = function(text, date, fav, remote, device) { let updated; const clipItem = new ClipItem(text, date, fav, remote, device); return clipItem.exists().then((isTrue) =&gt; { updated = isTrue; return clipItem.save(); }).then(() =&gt; { // let listeners know a ClipItem was added or updated const msg = app.ChromeMsg.CLIP_ADDED; msg.item = clipItem; msg.updated = updated; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); return Promise.resolve(clipItem); }); }; /** * Remove the given keys from storage * @param {string[]} keys - array of keys to delete * @returns {Promise&lt;void&gt;} void */ ClipItem.remove = function(keys) { return _db.clipItems.bulkDelete(keys); }; /** * Return true is there are no stored {@link ClipItem} objects * @returns {Promise&lt;boolean&gt;} true if no {@link ClipItem} objects */ ClipItem.isEmpty = function() { return _db.clipItems.count().then((count) =&gt; { return Promise.resolve(!count); }); }; /** * Return all the {@link ClipItem} objects from storage * @returns {Promise&lt;Array&gt;} Array of {@link ClipItem} objects */ ClipItem.loadAll = function() { return _db.clipItems.toArray(); }; /** * Delete items older than the storageDuration setting * @returns {Promise&lt;boolean&gt;} true if items were deleted */ ClipItem.deleteOld = function() { const durIndex = Chrome.Storage.getInt('storageDuration', 2); const durations = [ app.Utils.MILLIS_IN_DAY, app.Utils.MILLIS_IN_DAY * 7, app.Utils.MILLIS_IN_DAY * 30, app.Utils.MILLIS_IN_DAY * 365, ]; if (durIndex === 4) { // store forever return Promise.resolve(false); } else { const olderThanTime = Date.now() - durations[durIndex]; return ClipItem._deleteOlderThan(olderThanTime); } }; /** * Delete non-favorite {@link ClipItem} objects older than the given time * @param {int} time - time in millis since epoch * @returns {Promise&lt;boolean&gt;} true if items were deleted * @private */ ClipItem._deleteOlderThan = function(time) { return _db.clipItems.where('date').below(time).filter(function(clipItem) { return !clipItem.fav; }).delete().then((deleteCount) =&gt; { return Promise.resolve(!!deleteCount); }); }; /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Dexie * @private * @memberOf ClipItem */ function _onLoad() { _db = new Dexie('ClipItemsDB'); // define database _db.version(VERSION).stores({ clipItems: '&amp;text,date', }); _db.clipItems.mapToClass(ClipItem); } // listen for document and resources loaded window.addEventListener('load', _onLoad); window.app = window.app || {}; window.app.ClipItem = ClipItem; })(window); × Search results Close "},"scripts_on_copy_cut_content_script.js.html":{"id":"scripts_on_copy_cut_content_script.js.html","title":"Source: scripts/on_copy_cut_content_script.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/on_copy_cut_content_script.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ /** * Content script to monitor clipboard copy and cuts * @namespace ContentScript */ (function() { 'use strict'; if (window.onMyCopy) { window.removeEventListener('copy', window.onMyCopy); window.removeEventListener('cut', window.onMyCopy); } /** * On copy or cut event, send a message to our extension * @memberOf ContentScript */ window.onMyCopy = function onMyCopy() { try { chrome.runtime.sendMessage(chrome.runtime.id, { message: 'copiedToClipboard', }, () =&gt; {}); } catch(ex) { // noinspection UnnecessaryReturnStatementJS return; } }; window.addEventListener('copy', window.onMyCopy); window.addEventListener('cut', window.onMyCopy); })(); × Search results Close "},"scripts_device.js.html":{"id":"scripts_device.js.html","title":"Source: scripts/device.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/device.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function(window) { 'use strict'; new ExceptionHandler(); /** * Creates a new Device instance. * @constructor * @alias Device * @param {string} model - The model name of a device * @param {string} sn - The serial number (or other descriptor) of a device * @param {string} os - The operating system of a device * @param {string} nickname - The nickname of a device * @param {int} lastSeen - A date in millis from the epoch */ const Device = function(model, sn, os, nickname, lastSeen) { this.model = model; this.sn = sn; this.os = os; this.nickname = nickname; if (lastSeen) { this.lastSeen = lastSeen; } else { this.lastSeen = Date.now(); } }; /** * Model key * @const * @default */ Device.MODEL = 'dM'; /** * Serial Number key * @const * @default */ Device.SN = 'dSN'; /** * Operating system key * @const * @default */ Device.OS = 'dOS'; /** * Nickname key * @const * @default */ Device.NICKNAME = 'dN'; /** * Get a String that uniquely (hopefully) determines this {@link Device} * @returns {string} unique name */ Device.prototype.getUniqueName = function() { return `${this.model} - ${this.sn} - ${this.os}`; }; /** * Get name suitable for display * @returns {string} descriptive name of {@link Device} */ Device.prototype.getName = function() { let name = this.nickname; if (app.Utils.isWhiteSpace(name)) { name = this.getUniqueName(); } return name; }; /** * Determine if this is our {@link Device} * @returns {boolean} true if this is our {@link Device} */ Device.prototype.isMe = function() { return (this.getUniqueName() === Device.myUniqueName()); }; /** * Get unique name of our {@link Device} * @returns {string} unique name */ Device.myUniqueName = function() { return `${Device.myModel()} - ${Device.mySN()} - ${Device.myOS()}`; }; /** * Get display name of our {@link Device} * @returns {string} display name */ Device.myName = function() { let name = Device.myNickname(); if (app.Utils.isWhiteSpace(name)) { name = Device.myUniqueName(); } return name; }; /** * Get model name of our {@link Device} * @returns {string} model name */ Device.myModel = function() { return 'Chrome'; }; /** * Get serial number of our {@link Device} * @returns {string} serial number */ Device.mySN = function() { return Chrome.Storage.get('deviceSN'); }; /** * Get operating system of our {@link Device} * @returns {string} operating system */ Device.myOS = function() { return Chrome.Storage.get('os'); }; /** * Get os version of our {@link Device} * @returns {string} operating system version */ Device.myVersion = function() { return Chrome.Utils.getChromeVersion(); }; /** * Get nickname of our {@link Device} * @returns {string} nickname */ Device.myNickname = function() { return Chrome.Storage.get('deviceNickname'); }; window.app = window.app || {}; window.app.Device = Device; })(window); × Search results Close "},"bower_components_chrome-extension-utils_exception_handler.js.html":{"id":"bower_components_chrome-extension-utils_exception_handler.js.html","title":"Source: bower_components/chrome-extension-utils/exception_handler.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: bower_components/chrome-extension-utils/exception_handler.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ // noinspection ThisExpressionReferencesGlobalObjectJS (function(window, factory) { window.ExceptionHandler = factory(window); }(this, function(window) { 'use strict'; return ExceptionHandler; /** * Log Exceptions with analytics. Include: new ExceptionHandler()&lt;br /&gt; * at top of every js file * @constructor * @alias ExceptionHandler */ function ExceptionHandler() { if (typeof window.onerror === 'object') { // global error handler window.onerror = function(message, url, line, col, errObject) { if (Chrome &amp;&amp; Chrome.GA) { let msg = message; let stack = null; if (errObject &amp;&amp; errObject.message &amp;&amp; errObject.stack) { msg = errObject.message; stack = errObject.stack; } Chrome.GA.exception(msg, stack); } }; } } })); × Search results Close "},"scripts_main_main.js.html":{"id":"scripts_main_main.js.html","title":"Source: scripts/main/main.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/main/main.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; (function() { 'use strict'; /** * Script for the main.html page * @namespace Main */ new ExceptionHandler(); /** * Path to the extension in the Web Store * @type {string} * @memberOf Main */ const EXT_URI = `https://chrome.google.com/webstore/detail/${chrome.runtime.id}/`; /** * Path to the android app in the Play Store * @type {string} * @default * @memberOf Main */ const ANDROID_URI = 'https://play.google.com/store/apps/details' + '?id=com.weebly.opus1269.clipman'; /** * Path to my screen saver extension * @type {string} * @default * @memberOf Main */ const SCREEN_SAVER_URI = 'https://chrome.google.com/webstore/detail/photo-screen-saver/' + 'kohpcmlfdjfdggcjmjhhbcbankgmppgc'; /** * Auto-binding template * @type {Object} * @memberOf Main */ const t = document.querySelector('#t'); /** * Manage an html page that is inserted on demand&lt;br&gt; * May also be a url link to external site * @typedef page * @type {Object} * @property {string} label - label for Nav menu * @property {string} route - element name route to page * @property {string} icon - icon for Nav Menu * @property {?Object|Function} obj - something to be done when selected * @property {boolean} ready - true if html is inserted * @property {boolean} disabled - disabled state of Nav menu * @property {boolean} divider - true for divider before item * @memberOf Main */ /** * Array of {@link Main.page} objects * @type {Main.page[]} * @memberOf Main * @alias Main.pages */ t.pages = [ { label: 'Main', route: 'page-main', icon: 'myicons:list', obj: null, ready: true, disabled: false, divider: false, }, { label: 'Manage account', route: 'page-signin', icon: 'myicons:account-circle', obj: _showSignInPage, ready: false, disabled: false, divider: false, }, { label: 'Manage devices', route: 'page-devices', icon: 'myicons:phonelink', obj: _showDevicesPage, ready: false, disabled: false, divider: false, }, { label: 'Settings', route: 'page-settings', icon: 'myicons:settings', obj: _showSettingsPage, ready: false, disabled: false, divider: false, }, { label: 'Manage optional permissions', route: 'page-permissions', icon: 'myicons:perm-data-setting', obj: _showPermissionsDialog, ready: true, disabled: false, divider: false, }, { label: 'Help &amp; feedback', route: 'page-help', icon: 'myicons:help', obj: _showHelpPage, ready: false, disabled: false, divider: false, }, { label: 'Get android app', route: 'page-android', icon: 'myicons:android', obj: ANDROID_URI, ready: true, disabled: false, divider: true, }, { label: 'Rate extension', route: 'page-rate', icon: 'myicons:grade', obj: `${EXT_URI}reviews`, ready: true, disabled: false, divider: false, }, { label: 'Try Photo Screen Saver', route: 'page-screensaver', icon: 'myicons:extension', obj: SCREEN_SAVER_URI, ready: true, disabled: false, divider: true, }, ]; /** * Error dialog title * @type {string} * @memberOf Main */ t.dialogTitle = ''; /** * Error dialog text * @type {string} * @memberOf Main */ t.dialogText = ''; /** * Current route * @type {string} * @memberOf Main */ t.route = 'page-main'; /** * User photo * @type {string} * @memberOf Main */ t.avatar = Chrome.Storage.get('photoURL'); /** * Previous route * @type {string} * @memberOf Main */ let prevRoute = 'page-main'; /** * signin-page element * @type {element} * @memberOf Main */ let signInPage; /** * devices-page element * @type {element} * @memberOf Main */ let devicesPage; /** * Is the mainPage being displayed * @type {boolean} * @memberOf Main */ let isMainPage = true; /** * Listen for template bound event to know when bindings * have resolved and content has been stamped to the page */ t.addEventListener('dom-change', () =&gt; { // track usage Chrome.GA.page('/main.html'); // disable devices-page if not signed in const idx = _getPageIdx('page-devices'); t.pages[idx].disabled = !app.MyData.isSignedIn(); // listen for Chrome messages Chrome.Msg.listen(_onChromeMessage); // check for permissions _checkPermissions(); }); /** * Event: navigation menu selected * @param {Event} event - event * @memberOf Main */ t.onNavMenuItemTapped = function(event) { // Close drawer after menu item is selected _closeDrawer(); prevRoute = t.route; const idx = _getPageIdx(event.currentTarget.id); Chrome.GA.event(Chrome.GA.EVENT.MENU, t.pages[idx].route); if (!t.pages[idx].obj) { // some pages are just pages t.route = t.pages[idx].route; _scrollPageToTop(); } else if (typeof t.pages[idx].obj === 'string') { // some pages are url links t.$.mainMenu.select(prevRoute); chrome.tabs.create({url: t.pages[idx].obj}); } else { // some pages have functions to view them t.pages[idx].obj(idx); } isMainPage = (t.route === 'page-main'); }; /** * Event: display error dialog * @param {Event} event - event * @memberOf Main */ t.onShowErrorDialog = function(event) { t.dialogTitle = event.detail.title; t.dialogText = event.detail.text; t.$.errorDialog.open(); }; /** * Event: {@link Main.page} finished animating in * @memberOf Main */ t.onPageAnimation = function() { if (t.route === 'page-main') { t.$.mainPage.onCurrentPage(); } else if (t.route === 'page-signin') { signInPage.onCurrentPage(); } else if (t.route === 'page-devices') { devicesPage.onCurrentPage(); } }; /** * Event: Clicked on accept permissions dialog button * @memberOf Main */ t.onAcceptPermissionsClicked = function() { app.Permissions.request().then((granted) =&gt; { if (granted) { app.Permissions.injectContentScripts(); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Main.onAcceptPermissionsClicked'); }); }; /** * Event: Clicked on deny permissions dialog button * @memberOf Main */ t.onDenyPermissionsClicked = function() { app.Permissions.remove().catch((err) =&gt; { Chrome.GA.error(err.message, 'Main.onDenyPermissionsClicked'); }); }; /** * Computed Binding: Determine if avatar should be visible * @param {string} avatar - photo url * @returns {string} display type * @memberOf Main */ t.computeAvatarDisplay = function(avatar) { let ret = 'inline'; if (app.Utils.isWhiteSpace(avatar)) { ret = 'none'; } return ret; }; // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @private * @memberOf Main */ function _onChromeMessage(request, sender, response) { if (request.message === app.ChromeMsg.HIGHLIGHT.message) { // highlight ourselves and let the sender know we are here const chromep = new ChromePromise(); chromep.tabs.getCurrent().then((t) =&gt; { chrome.tabs.update(t.id, {'highlighted': true}); return null; }).catch((err) =&gt; { Chrome.GA.error(err.message, 'chromep.tabs.getCurrent'); }); response(JSON.stringify({message: 'OK'})); } else if (request.message === app.ChromeMsg.MSG_FAILED.message) { t.dialogTitle = 'Failed to send push notification'; t.dialogText = request.error; t.$.errorDialog.open(); } } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - value that changed * @private * @memberOf Main */ function _onStorageChanged(event) { if (event.key === 'signedIn') { _setDevicesState(); } else if (event.key === 'photoURL') { t.avatar = Chrome.Storage.get('photoURL'); } } /** * Event: Fired when the highlighted or selected tabs in a window changes. * @see https://developer.chrome.com/extensions/tabs#event-onHighlighted * @param {Object} highlightInfo - info * @private * @memberOf Main */ function _onHighlighted(highlightInfo) { const tabIds = highlightInfo.tabIds; chrome.tabs.getCurrent(function(myTab) { for (let i = 0; i &lt; tabIds.length; i++) { const tabId = tabIds[i]; if (tabId === myTab.id) { // our tab if (!isMainPage) { // focus main page prevRoute = t.route; t.route = 'page-main'; isMainPage = true; t.$.mainMenu.select(t.route); } else { t.$.mainPage.updateDates(); } break; } } }); } /** * Display dialog to prompt for accepting optional permissions * if it has not been set yet * @memberOf Main * @private */ function _checkPermissions() { if (Chrome.Storage.get('permissions') === app.Permissions.NOT_SET) { _showPermissionsDialog(); } } /** * Get the index into the {@link Main.pages} array * @param {string} name - {@link Main.page} route * @returns {int} index into array * @private * @memberOf Main */ function _getPageIdx(name) { return t.pages.map(function(e) { return e.route; }).indexOf(name); } /** * Show the signin page * @param {int} index - index into {@link Main.pages} * @private * @memberOf Main */ function _showSignInPage(index) { if (!t.pages[index].ready) { // insert the page the first time t.pages[index].ready = true; signInPage = new app.SignInPageFactory(); Polymer.dom(t.$.signInInsertion).appendChild(signInPage); } t.route = t.pages[index].route; _scrollPageToTop(); } /** * Show the devices page * @param {int} index - - index into {@link Main.pages} * @private * @memberOf Main */ function _showDevicesPage(index) { if (!t.pages[index].ready) { // insert the page the first time t.pages[index].ready = true; devicesPage = new app.DevicesPageFactory(); Polymer.dom(t.$.devicesInsertion).appendChild(devicesPage); } t.route = t.pages[index].route; _scrollPageToTop(); } /** * Show the settings page * @param {int} index - index into {@link Main.pages} * @private * @memberOf Main */ function _showSettingsPage(index) { if (!t.pages[index].ready) { // insert the page the first time t.pages[index].ready = true; const el = new app.SettingsPageFactory(); Polymer.dom(t.$.settingsInsertion).appendChild(el); } t.route = t.pages[index].route; _scrollPageToTop(); } /** * Show the help page * @param {int} index - index into {@link Main.pages} * @private * @memberOf Main */ function _showHelpPage(index) { if (!t.pages[index].ready) { // insert the page the first time t.pages[index].ready = true; const el = new app.HelpPageFactory(); Polymer.dom(t.$.helpInsertion).appendChild(el); } t.route = t.pages[index].route; _scrollPageToTop(); } /** * Show the permissions dialog * @private * @memberOf Main */ function _showPermissionsDialog() { t.$.permissionsDialog.open(); } /** * Scroll Main Panel to top * @private * @memberOf Main */ function _scrollPageToTop() { t.$.mainPanel.scroller.scrollTop = 0; } /** * Close drawer if drawerPanel is narrow * @private * @memberOf Main */ function _closeDrawer() { const drawerPanel = document.querySelector('#paperDrawerPanel'); if (drawerPanel.narrow) { drawerPanel.closeDrawer(); } } /** * Set enabled state of Devices menu item * @private * @memberOf Main */ function _setDevicesState() { // disable devices-page if not signed in const idx = _getPageIdx('page-devices'); const el = document.getElementById(t.pages[idx].route); if (el &amp;&amp; app.MyData.isSignedIn()) { el.removeAttribute('disabled'); } else if (el) { el.setAttribute('disabled', 'true'); } } // listen for changes to localStorage addEventListener('storage', _onStorageChanged, false); // listen for changes to highlighted tabs chrome.tabs.onHighlighted.addListener(_onHighlighted); })(); × Search results Close "},"scripts_background_receive_msg.js.html":{"id":"scripts_background_receive_msg.js.html","title":"Source: scripts/background/receive_msg.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/background/receive_msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * Handle incoming push messages * @namespace ReceiveMsg */ new ExceptionHandler(); /** * Delay time for fcm message processing * @type {int} * @default * @const * @private * @memberOf ReceiveMsg */ const MESSAGE_WAIT_MILLIS = 500; /** * Get new {@link Device} from {@link GaeMsg} * @param {GaeMsg} data - push data * @returns {Device} a {@link Device} * @private * @memberOf ReceiveMsg */ function _getDevice(data) { return new app.Device(data.dM, data.dSN, data.dOS, data.dN, Date.now()); } /** * Process received push notifications * @param {GaeMsg} data - push message * @private * @memberOf ReceiveMsg */ function _process(data) { const device = _getDevice(data); if (!app.MyData.isSignedIn() || device.isMe()) { // don't handle our messages or if we are signed out return; } Chrome.GA.event(app.GA.EVENT.RECEIVED); try { data.m = decodeURIComponent(data.m); } catch (ex) { // noinspection BadExpressionStatementJS () =&gt; {}; } if (data.act === app.Msg.ACTION.MESSAGE) { // received remote ClipItem app.Devices.add(device); const fav = (data.fav === '1'); // persist app.ClipItem.add(data.m, Date.now(), fav, true, device.getName()). catch((err) =&gt; { Chrome.GA.error(err.message, 'ReceiveMsg._process'); }); // save to clipboard app.CB.copyToClipboard(data.m); } else if (data.act === app.Msg.ACTION.PING) { // we were pinged app.Devices.add(device); // respond to ping app.Msg.sendPingResponse(data.srcRegId).catch((err) =&gt; { app.Gae.sendMessageFailed(err); }); } else if (data.act === app.Msg.ACTION.PING_RESPONSE) { // someone is around app.Devices.add(device); } else if (data.act === app.Msg.ACTION.DEVICE_ADDED) { // someone new is here app.Devices.add(device); } else if (data.act === app.Msg.ACTION.DEVICE_REMOVED) { // someone went away app.Devices.remove(device); } } /** * Event: Fired when a Web request is about to occur. * Capture the Service Worker request and process messages * @see https://goo.gl/4j4RtY * @param {Object} details - details on the request * @returns {Object} cancel the request * @private * @memberOf ReceiveMsg */ function _onWebRequestBefore(details) { let url = details.url; try { url = decodeURI(url); } catch (ex) { // noinspection BadExpressionStatementJS () =&gt; {}; } const regex = /https:\\/\\/pushy-clipboard\\.github\\.io\\/\\?(.*)/; let text; const matches = url.match(regex); if (matches &amp;&amp; (matches.length &gt; 1)) { text = matches[1]; } if (text) { let dataArray = null; try { dataArray = JSON.parse(text); } catch (ex) { // noinspection BadExpressionStatementJS () =&gt; {}; } if (dataArray) { for (let i = 0; i &lt; dataArray.length; i++) { (function(index) { setTimeout(function() { // slow down message stream _process(dataArray[index]); }, MESSAGE_WAIT_MILLIS); })(i); } } // cancel fake request return {cancel: true}; } } // Listen for web requests chrome.webRequest.onBeforeRequest.addListener(_onWebRequestBefore, { urls: ['https://pushy-clipboard.github.io/*'], }, ['blocking']); })(); × Search results Close "},"scripts_sw.js.html":{"id":"scripts_sw.js.html","title":"Source: scripts/sw.js","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Source: scripts/sw.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * Service Worker to handle push notifications * @namespace ServiceWorker */ /** * Fake fetch base path * @const * @default * @type {string} * @memberOf ServiceWorker */ const URL_FETCH_BASE = 'https://pushy-clipboard.github.io/?'; /** * Google search base path * @const * @default * @type {string} * @memberOf ServiceWorker */ const URL_SEARCH_BASE = 'https://www.google.com/search?q='; /** * Path to extension's main page * @const * @default * @type {string} * @memberOf ServiceWorker */ const URL_EXT = 'chrome-extension://jemdfhaheennfkehopbpkephjlednffd/html/main.html'; /** @memberOf ServiceWorker */ const TAG_MESSAGE = 'tag-message'; /** @memberOf ServiceWorker */ const TAG_DEVICE = 'tag-device'; /** @memberOf ServiceWorker */ const ACTION_MESSAGE = 'm'; /** @memberOf ServiceWorker */ const ACTION_DEVICE_REMOVED = 'remove_our_device'; /** @memberOf ServiceWorker */ const IC_REMOTE_COPY = '../images/ic_remote_copy.png'; /** @memberOf ServiceWorker */ const IC_ADD_DEVICE = '../images/ic_add_device.png'; /** @memberOf ServiceWorker */ const IC_REMOVE_DEVICE = '../images/ic_remove_device.png'; /** @memberOf ServiceWorker */ const IC_SEARCH = '../images/search-web.png'; // temporary variable to help get all messages at Chrome start-up // normally, can't use globals in service worker, but this is // only used when Chrome first starts up. Pretty sure it won't be // stopped during this time // could use indexedDB if we really have to /** @memberOf ServiceWorker */ let msgArr = []; /** * Service Worker Events * @typedef {Event} SWEvent * @property {Function} waitUntil(Promise) - wait till promise returns * @property {Object} notification - notification * @property {Object} action - notification action * @memberOf ServiceWorker */ /** * Get the name of the Device who sent the message * @param {GaeMsg} data - message object * @returns {string} device name * @memberOf ServiceWorker */ function getDeviceName(data) { let name; if (data.dN) { name = data.dN; } else { name = `${data.dM} - ${data.dSN} - ${data.dOS}`; } return name; } /** * Get the tag for the notification * @param {GaeMsg} data - message object * @returns {string} notification tag * @memberOf ServiceWorker */ function getTag(data) { let tag = TAG_DEVICE; if (data.act === ACTION_MESSAGE) { tag = TAG_MESSAGE; } return tag; } /** * Get the icon for the notification * @param {GaeMsg} data - message object * @returns {string} path to icon * @memberOf ServiceWorker */ function getIcon(data) { let path = IC_ADD_DEVICE; if (data.act === ACTION_MESSAGE) { path = IC_REMOTE_COPY; } else if (data.act === ACTION_DEVICE_REMOVED) { path = IC_REMOVE_DEVICE; } return path; } /** * Send any data attached to a notification to the extension * @param {GaeMsg[]} dataArray - possible array of {@link GaeMsg} objects * @returns {Promise&lt;void&gt;} always resolves */ function processNotificationData(dataArray) { if (dataArray instanceof Array) { return doFakeFetch(dataArray).catch(() =&gt; {}); } else { return Promise.resolve(); } } /** * Send fake GET request so extension can intercept it and get the payload * @see https://bugs.chromium.org/p/chromium/issues/detail?id=452942 * @param {GaeMsg[]} dataArray Array of {@link GaeMsg} objects * @returns {Promise&lt;void&gt;} fails if extension successfully canceled request * @memberOf ServiceWorker */ function doFakeFetch(dataArray) { msgArr = []; let URL_FETCH = URL_FETCH_BASE + JSON.stringify(dataArray); URL_FETCH = encodeURI(URL_FETCH); return fetch(URL_FETCH, {method: 'GET'}); } /** * Event: Received push message * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onPush(event) { const payload = event.data.json(); const data = payload.data; let body; try { body = decodeURIComponent(data.m); } catch(ex) { // noinspection BadExpressionStatementJS () =&gt; {}; } const tag = getTag(data); const noteOpt = { requireInteraction: (tag === TAG_MESSAGE), body: body, icon: getIcon(data), tag: tag, timestamp: Date.now(), data: null, }; if ((tag === TAG_MESSAGE)) { // add web search action noteOpt.actions = [{ action: 'search', title: 'Search web', icon: IC_SEARCH, }]; } let title = `From ${getDeviceName(data)}`; const promiseChain = clients.matchAll({ includeUncontrolled: true, type: 'window', }).then((clients) =&gt; { for (let i = 0; i &lt; clients.length; i++) { if (clients[i].focused === true) { // we have focus, don't display notification // send data to extension return doFakeFetch([data]).catch(() =&gt; {}); } } return self.registration.getNotifications({ tag: tag, }).then((notifications) =&gt; { if ((notifications.length &gt; 0)) { // append to existing notification noteOpt.renotify = true; const noteData = notifications[0].data; if (noteData instanceof Array) { // data is in the notification // add current and send all to extension noteData.push(data); return processNotificationData(noteData).then(() =&gt; { title += `\\n${noteData.length} new items`; // set data back to item count noteOpt.data = noteData.length; // simulate doFakeFetch cancel error throw new Error('fetch failed'); }); } else { // count of notifications noteOpt.data = notifications[0].data + 1; title = `${noteOpt.data} new items\\n${title}`; } } else { // new notification noteOpt.data = 1; } // send data to extension return doFakeFetch([data]); }).then(() =&gt; { // Extension did not cancel the fake fetch // add data to the notification instead // this is necessary for Chrome OS at startup at least if (tag === TAG_MESSAGE) { msgArr.push(data); if (msgArr.length &gt; 1) { title += `\\n${msgArr.length} new items`; } // shallow copy noteOpt.data = JSON.parse(JSON.stringify(msgArr)); } return self.registration.showNotification(title, noteOpt); }).catch(() =&gt; { // This is the normal outcome of the extension canceling // the fake fetch return self.registration.showNotification(title, noteOpt); }); }); event.waitUntil(promiseChain); } /** * Event: Notification clicked. * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onNotificationClick(event) { let url = URL_EXT; if (event.action === 'search') { // clicked on search action url = URL_SEARCH_BASE + encodeURIComponent(event.notification.body); } event.notification.close(); const promiseChain = clients.matchAll({ includeUncontrolled: true, type: 'window', }).then((windowClients) =&gt; { return processNotificationData(event.notification.data).then(() =&gt; { for (let i = 0; i &lt; windowClients.length; i++) { const client = windowClients[i]; if ((client.url === url) &amp;&amp; 'focus' in client) { // tab exists, focus it return client.focus(); } } if (clients.openWindow) { // create new tab return clients.openWindow(url); } return Promise.resolve(); }).catch(() =&gt; {}); }); event.waitUntil(promiseChain); } /** * Event: Notification closed - can't open or focus window here. * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onNotificationClose(event) { event.waitUntil( processNotificationData(event.notification.data).catch(() =&gt; {}) ); } // Listen for install events self.addEventListener('install', (event) =&gt; { event.waitUntil(self.skipWaiting()); }); // Listen for activate events self.addEventListener('activate', (event) =&gt; { event.waitUntil(self.clients.claim()); }); // Listen for push events self.addEventListener('push', onPush); // Listen for notificationclick events self.addEventListener('notificationclick', onNotificationClick); // Listen for notificationclose events self.addEventListener('notificationclose', onNotificationClose); })(); × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Global Type Definitions GaeMsg Data packet sent to server Type: Object Properties: Name Type Description act string type of message m string content of message dM string Device model dSN string Device serial number dOS string Device operating system dN string Device nickname fav string '1' if favorite item (optional) srcRegId string source of ping (optional) Source: scripts/background/messaging_client.js, line 72 × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Classes Classes ClipItem Device ExceptionHandler Namespaces Alarm Background CB ChromeMsg Devices Fb GA Gae Msg MyData Notify Permissions Reg SW User Utils GA Http JSONUtils Locale Msg Storage Utils ContentScript Main ReceiveMsg ServiceWorker × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespaces Classes ClipItem Device ExceptionHandler Namespaces Alarm Background CB ChromeMsg Devices Fb GA Gae Msg MyData Notify Permissions Reg SW User Utils GA Http JSONUtils Locale Msg Storage Utils ContentScript Main ReceiveMsg ServiceWorker × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Github Pages for Pushy ClipboardMonitor, store, and manage all text placed on the clipboard. Mark favorite items for easy access. Share between your devices using push notifications: Any desktop hardware that supports the Chrome Browser using the Pushy Clipboard Chrome Extension Android phones and tablets using the Pushy Clipboard app Free and advertising free. I write software for fun and hope it benefits others. × Search results Close "},"app.Alarm.html":{"id":"app.Alarm.html","title":"Namespace: Alarm","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Alarm Alarm Manage the chrome.alarm Source: scripts/background/alarm.js, line 13 Members &lt;private, static, constant&gt; ALARM_STORAGE :string Alarm for cleaning up old ClipItem objects Type: string Default Value: storage Source: scripts/background/alarm.js, line 26 Methods &lt;private, static&gt; _onAlarm(alarm) Event: Fired when an alarm has elapsed. Parameters: Name Type Description alarm Object details on alarm Source: scripts/background/alarm.js, line 35 See: https://developer.chrome.com/apps/alarms#event-onAlarm &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: scripts/background/alarm.js, line 49 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;static&gt; deleteOldClipItems() Delete ClipItem objects older than the storageDuration setting Source: scripts/background/alarm.js, line 93 &lt;static&gt; updateAlarms() Set the repeating alarms Source: scripts/background/alarm.js, line 70 × Search results Close "},"app.Background.html":{"id":"app.Background.html","title":"Namespace: Background","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Background Background The background script for the extension. Note: We can't be an Event Page because we use the chrome.webRequest API Source: scripts/background/background.js, line 10 Members &lt;private, static, constant&gt; INTRO_TEXT :string Initial ClipItem Type: string Source: scripts/background/background.js, line 26 Methods &lt;private, static&gt; _initializeData() Initialize the data saved in localStorage Source: scripts/background/background.js, line 151 &lt;private, static&gt; _initializeFirebase() → {Promise.&lt;void&gt;} Initialize firebase and Service Worker if signed in Source: scripts/background/background.js, line 197 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _onIconClicked() Event: Fired when a browser action icon is clicked. Source: scripts/background/background.js, line 102 See: https://goo.gl/abVwKu &lt;private, static&gt; _onInstalled(details) Event: Fired when the extension is first installed, when the extension is updated to a new version, and when Chrome is updated to a new version. Parameters: Name Type Description details Object type of event Source: scripts/background/background.js, line 53 See: https://developer.chrome.com/extensions/runtime#event-onInstalled &lt;private, static&gt; _onStartup() Event: Fired when a profile that has this extension installed first starts up Source: scripts/background/background.js, line 86 See: https://developer.chrome.com/extensions/runtime#event-onStartup &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: scripts/background/background.js, line 140 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;private, static&gt; _onTabUpdated(tabId) Event: Fired when a tab is updated. Parameters: Name Type Description tabId int id of tab Source: scripts/background/background.js, line 128 See: https://developer.chrome.com/extensions/tabs#event-onUpdated &lt;private, static&gt; _updateData() Update the data saved in localStorage Source: scripts/background/background.js, line 171 × Search results Close "},"app.CB.html":{"id":"app.CB.html","title":"Namespace: CB","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: CB CB Manage the clipboard Source: scripts/background/clipboard.js, line 13 Members &lt;private, static, constant&gt; WAIT_MILLIS :int Delay time for reading from clipboard Type: int Default Value: 250 Source: scripts/background/clipboard.js, line 25 Methods &lt;private, static&gt; _addClipItemFromClipboard() Add a new ClipItem from the Clipboard contents Source: scripts/background/clipboard.js, line 47 &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: scripts/background/clipboard.js, line 85 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _sendLocalClipItem(clipItem) Send local ClipItem push notification if enabled Parameters: Name Type Description clipItem ClipItem ClipItem to send Source: scripts/background/clipboard.js, line 33 &lt;static&gt; copyToClipboard(text) Copy the given text to the clipboard Parameters: Name Type Description text string text to copy Source: scripts/background/clipboard.js, line 130 &lt;static&gt; getTextFromClipboard() → {string} Get the text from the clipboard Source: scripts/background/clipboard.js, line 113 Returns: text from clipboard Type string × Search results Close "},"app.ChromeMsg.html":{"id":"app.ChromeMsg.html","title":"Namespace: ChromeMsg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: ChromeMsg ChromeMsg Chrome messages for the extension Source: scripts/my_chrome_msg.js, line 13 Members &lt;static, constant&gt; CLIP_ADDED :Chrome.Msg.Message A app.ClipItem was added or updated Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 144 &lt;static, constant&gt; COPIED_TO_CLIPBOARD :Chrome.Msg.Message We copied something to the clipboard Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 90 &lt;static, constant&gt; COPY_TO_CLIPBOARD :Chrome.Msg.Message Copy the item to the clipboard Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 80 &lt;static, constant&gt; DEVICES_CHANGED :Chrome.Msg.Message The list of app.Devices changed Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 62 &lt;static, constant&gt; HIGHLIGHT :Chrome.Msg.Message Highlight a tab Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 32 &lt;static, constant&gt; MSG_FAILED :Chrome.Msg.Message Send app.Msg failed Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 117 &lt;static, constant&gt; PING :Chrome.Msg.Message Ping our app.Devices Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 71 &lt;static, constant&gt; REGISTER_FAILED :Chrome.Msg.Message Register with server failed Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 126 &lt;static, constant&gt; REMOVE_DEVICE :Chrome.Msg.Message A app.Device was removed from the app.Devices Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 52 &lt;static, constant&gt; RESTORE_DEFAULTS :Chrome.Msg.Message Restore default settings Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 23 &lt;static, constant&gt; SIGN_IN :Chrome.Msg.Message User signed in Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 99 &lt;static, constant&gt; SIGN_OUT :Chrome.Msg.Message User signed OUT Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 108 &lt;static, constant&gt; STORE :Chrome.Msg.Message Save value to storage message Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 41 &lt;static, constant&gt; UNREGISTER_FAILED :Chrome.Msg.Message Unregister with server failed Type: Chrome.Msg.Message Source: scripts/my_chrome_msg.js, line 135 × Search results Close "},"app.Devices.html":{"id":"app.Devices.html","title":"Namespace: Devices","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Devices Devices A list of remote Device objects we know about Source: scripts/background/devices.js, line 13 Members &lt;static&gt; _devices :Map A Map of Device objects keyed by their unique names Type: Map Source: scripts/background/devices.js, line 23 Methods &lt;private, static&gt; _load() Get the Device objects from localStorage Source: scripts/background/devices.js, line 47 &lt;private, static&gt; _mapToObj(map) → {Object} Convert Map to Object Parameters: Name Type Description map Map a Map Source: scripts/background/devices.js, line 32 Returns: as Object Type Object &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the message sender Object MessageSender object response function function to call once after processing Source: scripts/background/devices.js, line 96 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Load the Device objects from localStorage Source: scripts/background/devices.js, line 80 &lt;private, static&gt; _save() Save the Device objects to localStorage Source: scripts/background/devices.js, line 68 &lt;static&gt; add(device) Add a new Device Parameters: Name Type Description device Device Device to add Source: scripts/background/devices.js, line 134 &lt;static&gt; clear() Remove all Device objects Source: scripts/background/devices.js, line 162 &lt;static&gt; entries() → {Iterator.&lt;Device&gt;} Get an Iterator on the Devices Source: scripts/background/devices.js, line 125 Returns: Iterator Type Iterator.&lt;Device&gt; &lt;static&gt; remove(device) Remove a Device Parameters: Name Type Description device Device Device to remove Source: scripts/background/devices.js, line 144 &lt;static&gt; removeByName(uniqueName) Remove a Device with the given unique name Parameters: Name Type Description uniqueName string Name of Device to remove Source: scripts/background/devices.js, line 153 × Search results Close "},"app.Fb.html":{"id":"app.Fb.html","title":"Namespace: Fb","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Fb Fb Manage interaction with firebase and its Namespaces Source: scripts/background/firebase.js, line 14 See: https://firebase.google.com/docs/web/setup Members &lt;private, static&gt; _app Firebase app Source: scripts/background/firebase.js, line 33 &lt;private, static&gt; _auth Firebase auth Namespace Source: scripts/background/firebase.js, line 47 &lt;private, static&gt; _messaging Firebase messaging Namespace Source: scripts/background/firebase.js, line 40 &lt;static, constant&gt; ERROR_TOKEN :string Error message for regToken Type: string Default Value: Failed to obtain messaging token. Source: scripts/background/firebase.js, line 25 Methods &lt;private, static&gt; _deleteFirebaseApp() → {Promise.&lt;void&gt;} Delete firebase.app if it exists Source: scripts/background/firebase.js, line 85 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _initializeFirebase(swReg) → {Promise.&lt;void&gt;} Initialize firebase and its Namespaces Parameters: Name Type Description swReg ServiceWorkerRegistration use own ServiceWorker Source: scripts/background/firebase.js, line 56 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _refreshRegToken() Refresh the regToken when firebase changes it Source: scripts/background/firebase.js, line 98 &lt;static&gt; getRegToken() → {Promise.&lt;token&gt;} Get the registration token for fcm Source: scripts/background/firebase.js, line 152 Returns: A registration token for fcm Type Promise.&lt;token&gt; &lt;static&gt; initialize(swReg) → {Promise.&lt;void&gt;} Initialize the firebase libraries Parameters: Name Type Description swReg ServiceWorkerRegistration service worker Source: scripts/background/firebase.js, line 117 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; signIn(token) → {Promise.&lt;Object&gt;} SignIn to firebase Parameters: Name Type Description token string token Source: scripts/background/firebase.js, line 127 Returns: The current firebase user Type Promise.&lt;Object&gt; &lt;static&gt; signOut() → {Promise.&lt;void&gt;} Unregister Service Worker and sign-out of firebase Source: scripts/background/firebase.js, line 141 Returns: Error on reject Type Promise.&lt;void&gt; × Search results Close "},"app.GA.html":{"id":"app.GA.html","title":"Namespace: GA","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: GA GA Manage Google Analytics tracking Source: scripts/my_analytics.js, line 19 Members &lt;private, static, constant&gt; _TRACKING_ID :string Tracking ID Type: string Default Value: UA-61314754-3 Source: scripts/my_analytics.js, line 30 &lt;static, constant&gt; EVENT :Object Event types Type: Object Properties: Name Type Description SENT Chrome.GA.Event message sent RECEIVED Chrome.GA.Event message received REGISTERED Chrome.GA.Event Device registered UNREGISTERED Chrome.GA.Event Device unregistered Source: scripts/my_analytics.js, line 42 Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Google Analytics Source: scripts/my_analytics.js, line 71 × Search results Close "},"app.Gae.html":{"id":"app.Gae.html","title":"Namespace: Gae","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Gae Gae Handle calls to the Google App Engine Endpoints Source: scripts/background/gae.js, line 14 See: https://cloud.google.com/appengine/docs/standard/java/endpoints/ Members &lt;static&gt; GAE_ROOT :string Root path to our gae server Type: string Source: scripts/background/gae.js, line 50 &lt;private, static, constant&gt; GAE_ROOT_LOCAL Base path of local testing server Default Value: http://localhost:8080/_ah/api Source: scripts/background/gae.js, line 37 &lt;private, static, constant&gt; GAE_ROOT_REMOTE Base path of real gae server Default Value: https://clip-man.appspot.com/_ah/api Source: scripts/background/gae.js, line 26 Methods &lt;static&gt; doPost(url, retryToken [, interactive]) → {Promise.&lt;void&gt;} Perform POST request to endpoint Parameters: Name Type Argument Default Description url string server Endpoint retryToken boolean if true, retry with new token on error interactive boolean &lt;optional&gt; false true if user initiated Source: scripts/background/gae.js, line 61 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendMessageFailed(err) Notify listeners that send message failed Parameters: Name Type Description err Error what caused the failure Source: scripts/background/gae.js, line 80 × Search results Close "},"app.Msg.html":{"id":"app.Msg.html","title":"Namespace: Msg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Msg Msg Send messages to the gae server MessagingEndpoint for delivery Source: scripts/background/messaging_client.js, line 13 Members &lt;static, constant&gt; ACTION :Object Message action Type: Object Default Value: {&quot;MESSAGE&quot;:&quot;m&quot;,&quot;PING&quot;:&quot;ping_others&quot;,&quot;PING_RESPONSE&quot;:&quot;respond_to_ping&quot;,&quot;DEVICE_ADDED&quot;:&quot;add_our_device&quot;,&quot;DEVICE_REMOVED&quot;:&quot;remove_our_device&quot;} Source: scripts/background/messaging_client.js, line 46 &lt;private, static, constant&gt; BODY :Object Message body Type: Object Default Value: {&quot;PING&quot;:&quot;Contacting other devices...&quot;,&quot;PING_RESPONSE&quot;:&quot;Device is online&quot;,&quot;DEVICE_ADDED&quot;:&quot;New device added&quot;,&quot;DEVICE_REMOVED&quot;:&quot;Device removed&quot;} Source: scripts/background/messaging_client.js, line 65 &lt;private, static, constant&gt; MAX_MSG_LEN Max message length. Server may reduce it more Default Value: 4096 Source: scripts/background/messaging_client.js, line 33 &lt;private, static, constant&gt; URL_BASE Base path of MessagingEndpoint Source: scripts/background/messaging_client.js, line 24 Methods &lt;private, static&gt; _getData(action, body) → {GaeMsg} Get the data packet we will send Parameters: Name Type Description action string message type body string message body Source: scripts/background/messaging_client.js, line 93 Returns: data packet Type GaeMsg &lt;static&gt; _getDevice() → {Object} Get portion of Device sent in message Source: scripts/background/messaging_client.js, line 105 Returns: Subset of Device info as object literal Type Object &lt;private, static&gt; _sendMessage(data, notify) → {Promise.&lt;void&gt;} Send message to server for delivery to our Devices Parameters: Name Type Description data GaeMsg data packet notify boolean display notification if true Source: scripts/background/messaging_client.js, line 122 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendClipItem(clipItem) → {Promise.&lt;void&gt;} Send clipboard contents as represented by a ClipItem Parameters: Name Type Description clipItem ClipItem contents of clipboard Source: scripts/background/messaging_client.js, line 151 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendDeviceAdded() → {Promise.&lt;void&gt;} Send message for adding our Device Source: scripts/background/messaging_client.js, line 172 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendDeviceRemoved() → {Promise.&lt;void&gt;} Send message for removing our Device Source: scripts/background/messaging_client.js, line 182 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendPing() → {Promise.&lt;void&gt;} Ping our app.Devices Source: scripts/background/messaging_client.js, line 192 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendPingResponse(srcRegId) → {Promise.&lt;void&gt;} Respond to a ping from one of our app.Devices Parameters: Name Type Description srcRegId string source of ping Source: scripts/background/messaging_client.js, line 203 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.MyData.html":{"id":"app.MyData.html","title":"Namespace: MyData","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: MyData MyData The extension's localStorage data Source: scripts/my_data.js, line 13 Members &lt;private, static, constant&gt; _DEFAULTS :app.MyData.MyData Default values for localStorage items Type: app.MyData.MyData Source: scripts/my_data.js, line 62 &lt;private, static, constant&gt; _VERSION :int Version of data - update when items are added, removed, changed Type: int Default Value: 2 Source: scripts/my_data.js, line 26 Methods &lt;static&gt; allowPush() → {boolean} Has user enabled pushing to app.Devices Source: scripts/my_data.js, line 125 Returns: true if enabled Type boolean &lt;static&gt; allowReceive() → {boolean} Has user enabled receiving from app.Devices Source: scripts/my_data.js, line 143 Returns: true if enabled Type boolean &lt;static&gt; getCurrentVersion() → {int} Get the current data version Source: scripts/my_data.js, line 90 Returns: the version of our data Type int &lt;static&gt; getDeviceSN() → {boolean} Get our serial number Source: scripts/my_data.js, line 179 Returns: true if not registered Type boolean &lt;static&gt; isAutoSend() → {boolean} Has user enabled autoSend option Source: scripts/my_data.js, line 134 Returns: true if enabled Type boolean &lt;static&gt; isMonitorClipboard() → {boolean} Are we saving clipboard contents Source: scripts/my_data.js, line 116 Returns: true if enabled Type boolean &lt;static&gt; isRegistered() → {boolean} Are we registered with fcm Source: scripts/my_data.js, line 161 Returns: true if registered Type boolean &lt;static&gt; isSignedIn() → {boolean} Are we signed in Source: scripts/my_data.js, line 152 Returns: true if signed in Type boolean &lt;static&gt; notRegistered() → {boolean} Are we not registered with fcm Source: scripts/my_data.js, line 170 Returns: true if not registered Type boolean &lt;static&gt; saveDefaults() Save the _DEFAULTS, if they do not already exist Source: scripts/my_data.js, line 99 Type Definitions MyData The data items saved to localStorage Type: Object Properties: Name Type Description version int version of data monitorClipboard boolean save clipboard contents allowPush boolean send push notifications autoSend boolean automatically send push notifications allowReceive boolean receive push notifications storageDuration int how long to save clipItems notify boolean xxx notifyOnSend boolean show notification on send push notifyOnReceive boolean show notification on receive push highPriority boolean send high priority messages deviceSN string serial number of our device deviceNickname string nickname of our device devices Object other devices we know about signedIn boolean are we logged in registered boolean are we registered with server needsCleanup boolean does are log in state need cleanup email string our email address uid string our unique id photoURL string path to out photo url permissions string enum: notSet allowed denied Source: scripts/my_data.js, line 28 × Search results Close "},"app.Notify.html":{"id":"app.Notify.html","title":"Namespace: Notify","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Notify Notify Handle display of notifications Source: scripts/background/notify.js, line 13 Members &lt;private, static, constant&gt; ICON :Object Icons Type: Object Default Value: {&quot;LOCAL_COPY&quot;:&quot;/images/ic_local_copy.png&quot;,&quot;ADD_DEVICE&quot;:&quot;/images/ic_add_device.png&quot;,&quot;REMOVE_DEVICE&quot;:&quot;/images/ic_remove_device.png&quot;} Source: scripts/background/notify.js, line 38 &lt;private, static, constant&gt; NOTIFY_SEND :string Send notification type Type: string Default Value: CLIP_MAN_SEND Source: scripts/background/notify.js, line 26 &lt;static&gt; NOTIFY_SEND Send notification type Source: scripts/background/notify.js, line 84 Methods &lt;static&gt; _getIcon(data) → {string} Get the icon for the notification Parameters: Name Type Description data GaeMsg message object Source: scripts/background/notify.js, line 51 Returns: path to icon, null for actions without notifications (ping) Type string &lt;private, static&gt; _onNotificationClicked(id) Event: Fired when the user clicked in a non-button area of the notification. Parameters: Name Type Description id string notification type Source: scripts/background/notify.js, line 71 See: https://developer.chrome.com/apps/notifications#event-onClicked &lt;static&gt; create(type, data) Create and display a notification Parameters: Name Type Description type string notification type (send or receive) data GaeMsg message data Source: scripts/background/notify.js, line 92 &lt;static&gt; onSend() → {boolean} Determine if send notifications are enabled Source: scripts/background/notify.js, line 126 Returns: true if enabled Type boolean &lt;static&gt; showMainTab() Send message to the main tab to focus it. If not found, create it Source: scripts/background/notify.js, line 136 × Search results Close "},"app.Permissions.html":{"id":"app.Permissions.html","title":"Namespace: Permissions","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Permissions Permissions Handle optional permissions Source: scripts/permissions.js, line 13 Members &lt;static&gt; ALLOWED Source: scripts/permissions.js, line 36 &lt;static, constant&gt; ALLOWED Source: scripts/permissions.js, line 28 &lt;static, constant&gt; DENIED Source: scripts/permissions.js, line 30 &lt;static&gt; DENIED Source: scripts/permissions.js, line 38 &lt;static&gt; NOT_SET Source: scripts/permissions.js, line 34 &lt;static, constant&gt; NOT_SET Source: scripts/permissions.js, line 26 &lt;static, constant&gt; ORIGINS Source: scripts/permissions.js, line 23 &lt;static, constant&gt; PERMISSIONS Source: scripts/permissions.js, line 21 Methods &lt;static&gt; contains() → {Promise.&lt;boolean&gt;} Determine if we have the optional permissions Source: scripts/permissions.js, line 90 Returns: true if we have permissions Type Promise.&lt;boolean&gt; &lt;static&gt; injectContentScript(tabId) Inject our script into the given tab Parameters: Name Type Description tabId int tab to inject Source: scripts/permissions.js, line 155 &lt;static&gt; injectContentScripts() Inject our script into all tabs that match Source: scripts/permissions.js, line 130 &lt;static&gt; isAllowed() → {boolean} Has the user allowed the optional permissions Source: scripts/permissions.js, line 54 Returns: true if allowed Type boolean &lt;static&gt; notSet() → {boolean} Has use made choice on permissions Source: scripts/permissions.js, line 45 Returns: true if allowed or denied Type boolean &lt;static&gt; remove() → {Promise.&lt;boolean&gt;} Remove the optional permissions Source: scripts/permissions.js, line 102 Returns: true if removed Type Promise.&lt;boolean&gt; &lt;static&gt; request() → {Promise.&lt;boolean&gt;} Prompt for the optional permissions Source: scripts/permissions.js, line 63 Returns: true if permission granted Type Promise.&lt;boolean&gt; × Search results Close "},"app.Reg.html":{"id":"app.Reg.html","title":"Namespace: Reg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Reg Reg Handle RegistrationEndpoint tasks on the gae server Source: scripts/background/registration_client.js, line 13 Members &lt;private, static, constant&gt; URL_BASE :string Base path of RegistrationEndpoint Type: string Source: scripts/background/registration_client.js, line 25 Methods &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: scripts/background/registration_client.js, line 35 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;static&gt; register( [interactive]) → {Promise.&lt;void&gt;} Register Device with server Parameters: Name Type Argument Default Description interactive boolean &lt;optional&gt; false true if user initiated Source: scripts/background/registration_client.js, line 74 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; unregister( [interactive]) → {Promise.&lt;void&gt;} Unregister Device with server Parameters: Name Type Argument Default Description interactive boolean &lt;optional&gt; false true if user initiated Source: scripts/background/registration_client.js, line 99 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.SW.html":{"id":"app.SW.html","title":"Namespace: SW","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: SW SW Manage lifecycle of our ServiceWorker Source: scripts/background/service_worker.js, line 13 Members &lt;private, static&gt; _swRegistration Our ServiceWorkerRegistration object Source: scripts/background/service_worker.js, line 37 &lt;private, static, constant&gt; SERVICE_WORKER Path to our ServiceWorker Default Value: ../scripts/sw.js Source: scripts/background/service_worker.js, line 30 Methods &lt;private, static&gt; _register() → {Promise.&lt;Object&gt;} Register the Service Worker Note: This can be called if already registered Source: scripts/background/service_worker.js, line 46 Returns: service worker Type Promise.&lt;Object&gt; &lt;private, static&gt; _unsubscribePush() → {Promise.&lt;void&gt;} Unsubscribe from push notifications Source: scripts/background/service_worker.js, line 61 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; initialize() → {Promise.&lt;void&gt;} Initialize the ServiceWorker and firebase Source: scripts/background/service_worker.js, line 77 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; unregister() → {Promise.&lt;void&gt;} Unregister the Service Worker Source: scripts/background/service_worker.js, line 96 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; update() → {Promise.&lt;void&gt;} Update the Service Worker Source: scripts/background/service_worker.js, line 120 Returns: void always resolves Type Promise.&lt;void&gt; × Search results Close "},"app.User.html":{"id":"app.User.html","title":"Namespace: User","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: User User Manage the current user Source: scripts/background/user.js, line 13 Methods &lt;private, static&gt; _addAccess() → {Promise.&lt;void&gt;} Sign in and register our Device Source: scripts/background/user.js, line 93 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _getAuthToken() → {Promise.&lt;string&gt;} Get an OAuth2.0 token Source: scripts/background/user.js, line 40 See: https://developer.chrome.com/apps/identity#method-getAuthToken Returns: An access token Type Promise.&lt;string&gt; &lt;private, static&gt; _needsCleanup() → {Promise.&lt;void&gt;} Cleanup if user signed-out of Browser Source: scripts/background/user.js, line 76 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: scripts/background/user.js, line 141 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onSignInChanged(account, signedIn) Event: Fired when signin state changes for an act. on the user's profile. Parameters: Name Type Description account Object chrome AccountInfo signedIn boolean true if signedIn Source: scripts/background/user.js, line 56 See: https://developer.chrome.com/apps/identity#event-onSignInChanged &lt;private, static&gt; _removeAccess() → {Promise.&lt;void&gt;} Unregister Device and sign out of firebase Source: scripts/background/user.js, line 117 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; setInfo() → {Promise.&lt;void&gt;} Persist info on current Browser user (may be no-one) Source: scripts/background/user.js, line 191 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.Utils.html":{"id":"app.Utils.html","title":"Namespace: Utils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Utils Utils Misc. utility methods Source: scripts/utils.js, line 13 Members &lt;static, constant&gt; MILLIS_IN_DAY :int Number of milliseconds a in day Type: int Source: scripts/utils.js, line 37 &lt;static, constant&gt; MIN_IN_DAY :int Number of minutes in a day Type: int Source: scripts/utils.js, line 29 Methods &lt;static&gt; getRelativeTime(time) → {string} Get a date string in time ago format Parameters: Name Type Description time int time since epoch in millis Source: scripts/utils.js, line 67 Returns: Relative time format Type string &lt;static&gt; isWhiteSpace(str) → {boolean} Determine if a String is null or whitespace only Parameters: Name Type Description str string string to check Source: scripts/utils.js, line 57 Returns: true if str is whitespace (or null) Type boolean &lt;static&gt; randomString(len) → {string} Get a random string of the given length Parameters: Name Type Description len int | null length of generated string, 8 if null Source: scripts/utils.js, line 79 Returns: a random string Type string &lt;static&gt; setBadgeText() Set the badge displayed on the extension icon Source: scripts/utils.js, line 43 × Search results Close "},"Chrome.GA.html":{"id":"Chrome.GA.html","title":"Namespace: GA","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: GA GA Google Analytics tracking Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 13 Members &lt;static, constant&gt; EVENT :Object Event types Type: Object Properties: Name Type Description INSTALLED Chrome.GA.Event extension installed MENU Chrome.GA.Event menu selected TOGGLE Chrome.GA.Event setting-toggle LINK Chrome.GA.Event setting-link BUTTON Chrome.GA.Event button click ICON Chrome.GA.Event toolbar icon click CHECK Chrome.GA.Event checkbox click Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 66 Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Google Analytics Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 31 &lt;static&gt; error( [label] [, action]) Send an error Parameters: Name Type Argument Default Description label string &lt;optional&gt; &lt;nullable&gt; null override label action string &lt;optional&gt; &lt;nullable&gt; null override action Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 160 &lt;static&gt; event(event [, label] [, action]) Send an event Parameters: Name Type Argument Default Description event Chrome.GA.Event the event type label string &lt;optional&gt; &lt;nullable&gt; null override label action string &lt;optional&gt; &lt;nullable&gt; null override action Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 144 &lt;static&gt; exception(message [, stack] [, fatal]) Send an exception Parameters: Name Type Argument Default Description message string the error message stack string &lt;optional&gt; &lt;nullable&gt; null error stack fatal boolean &lt;optional&gt; null true if fatal Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 180 &lt;static&gt; initialize(trackingId, appName, appId, appVersion) Initialize analytics Parameters: Name Type Description trackingId string tracking id appName string extension name appId string extension Id appVersion string extension version Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 115 &lt;static&gt; page(page) Send a page Parameters: Name Type Description page string page path Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 131 Type Definitions Event Google Analytics Event Type: Object Properties: Name Type Description eventCategory string category eventAction string action eventLabel string label Source: bower_components/chrome-extension-utils/chrome_analytics.js, line 16 × Search results Close "},"Chrome.Http.html":{"id":"Chrome.Http.html","title":"Namespace: Http","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Http Http Fetch with authentication and exponential back-off Source: bower_components/chrome-extension-utils/http.js, line 13 Members &lt;private, static, constant&gt; _AUTH_HEADER :string Authorization header Type: string Source: bower_components/chrome-extension-utils/http.js, line 38 &lt;private, static, constant&gt; _BEARER :string Bearer parameter for authorized call Type: string Source: bower_components/chrome-extension-utils/http.js, line 46 &lt;private, static, constant&gt; _CONFIG :Chrome.Http.Config Configuration object Type: Chrome.Http.Config Source: bower_components/chrome-extension-utils/http.js, line 71 &lt;private, static, constant&gt; _DELAY Delay multiplier for exponential back-off Default Value: 1000 Source: bower_components/chrome-extension-utils/http.js, line 63 &lt;private, static, constant&gt; _MAX_RETRIES :int Max retries on 500 errors Type: int Source: bower_components/chrome-extension-utils/http.js, line 54 Methods &lt;private, static&gt; _doIt(url, opts, conf) → {Promise.&lt;JSON&gt;} Do a server request Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration Source: bower_components/chrome-extension-utils/http.js, line 259 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _fetch(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Perform fetch, optionally using authorization and exponential back-off Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: bower_components/chrome-extension-utils/http.js, line 231 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _getAuthToken(isAuth, interactive) → {Promise.&lt;string&gt;} Get authorization token Parameters: Name Type Description isAuth boolean if true, authorization required interactive boolean if true, user initiated Source: bower_components/chrome-extension-utils/http.js, line 151 Returns: auth token Type Promise.&lt;string&gt; &lt;private, static&gt; _getError(response) → {Error} Get Error message Parameters: Name Type Description response Object server response Source: bower_components/chrome-extension-utils/http.js, line 132 Returns: details on failure Type Error &lt;private, static&gt; _processResponse(response, url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Check response and act accordingly Parameters: Name Type Description response Object response from server url string server opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: bower_components/chrome-extension-utils/http.js, line 91 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retry(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Retry authorized fetch with exponential back-off Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: bower_components/chrome-extension-utils/http.js, line 187 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retryToken(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Retry fetch after removing cached auth token Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: bower_components/chrome-extension-utils/http.js, line 210 Returns: response from server Type Promise.&lt;JSON&gt; &lt;static&gt; doGet(url [, conf]) → {Promise.&lt;JSON&gt;} Perform GET request Parameters: Name Type Argument Default Description url string server request conf Chrome.Http.Config &lt;optional&gt; null configuration Source: bower_components/chrome-extension-utils/http.js, line 278 Returns: response from server Type Promise.&lt;JSON&gt; &lt;static&gt; doPost(url [, conf]) → {Promise.&lt;JSON&gt;} Perform POST request Parameters: Name Type Argument Default Description url string server request conf Chrome.Http.Config &lt;optional&gt; null configuration Source: bower_components/chrome-extension-utils/http.js, line 290 Returns: response from server Type Promise.&lt;JSON&gt; Type Definitions Config Http configuration Type: Object Properties: Name Type Argument Default Description isAuth boolean &lt;optional&gt; false if true, authorization required retryToken boolean &lt;optional&gt; false if true, retry with new token interactive boolean &lt;optional&gt; false user initiated, if true token string &lt;optional&gt; &lt;nullable&gt; null auth token backoff boolean &lt;optional&gt; true if true, do exponential back-off maxRetries int &lt;optional&gt; _MAX_ATTEMPTS max retries Source: bower_components/chrome-extension-utils/http.js, line 20 × Search results Close "},"Chrome.JSONUtils.html":{"id":"Chrome.JSONUtils.html","title":"Namespace: JSONUtils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: JSONUtils JSONUtils JSON utilities Source: bower_components/chrome-extension-utils/json.js, line 13 Methods &lt;static&gt; parse(jsonString) → {JSON} Parse JSON, with exception handling Parameters: Name Type Description jsonString string string to parse Source: bower_components/chrome-extension-utils/json.js, line 25 Returns: JSON Object, null on error Type JSON &lt;static&gt; shallowCopy(object) → {JSON} Return shallow copy of Object Parameters: Name Type Description object Object object to copy Source: bower_components/chrome-extension-utils/json.js, line 42 Returns: JSON Object, null on error Type JSON × Search results Close "},"Chrome.Locale.html":{"id":"Chrome.Locale.html","title":"Namespace: Locale","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Locale Locale Locale methods Source: bower_components/chrome-extension-utils/locales.js, line 14 See: https://developer.chrome.com/extensions/i18n Methods &lt;static&gt; getLocale() → {string} Get the current locale Source: bower_components/chrome-extension-utils/locales.js, line 35 Returns: current locale e.g. en_US Type string &lt;static&gt; localize(messageName) → {string} Get the i18n string Parameters: Name Type Description messageName string key in messages.json Source: bower_components/chrome-extension-utils/locales.js, line 26 Returns: internationalized string Type string × Search results Close "},"Chrome.Msg.html":{"id":"Chrome.Msg.html","title":"Namespace: Msg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Msg Msg Wrapper for chrome messages Source: bower_components/chrome-extension-utils/chrome_msg.js, line 13 Members &lt;static, constant&gt; STORAGE_EXCEEDED :Chrome.Msg.Message A save attempt to localStorage exceeded its capacity Type: Chrome.Msg.Message Source: bower_components/chrome-extension-utils/chrome_msg.js, line 35 Methods &lt;static&gt; listen(listener) Add a listener for chrome messages Parameters: Name Type Description listener function function to receive messages Source: bower_components/chrome-extension-utils/chrome_msg.js, line 68 &lt;static&gt; send(type) → {Promise.&lt;JSON&gt;} Send a chrome message Parameters: Name Type Description type Chrome.Msg.Message type of message Source: bower_components/chrome-extension-utils/chrome_msg.js, line 48 Returns: response JSON Type Promise.&lt;JSON&gt; Type Definitions Message A Chrome message Type: Object Properties: Name Type Argument Description message string Unique name error Error an error item string | Object a message specific item updated boolean item is new or updated key string key name value Object &lt;nullable&gt; value of key Source: bower_components/chrome-extension-utils/chrome_msg.js, line 18 × Search results Close "},"Chrome.Storage.html":{"id":"Chrome.Storage.html","title":"Namespace: Storage","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Storage Storage Manage items in localStorage Source: bower_components/chrome-extension-utils/storage.js, line 13 Methods &lt;static&gt; get(key) → {JSON} Get a JSON parsed value from localStorage Parameters: Name Type Description key string key to get value for Source: bower_components/chrome-extension-utils/storage.js, line 25 Returns: JSON object, null if key does not exist Type JSON &lt;static&gt; getBool(key) → {boolean} Get boolean value from localStorage Parameters: Name Type Description key string key to get value for Source: bower_components/chrome-extension-utils/storage.js, line 59 Returns: value as boolean, null if key does not exist Type boolean &lt;static&gt; getInt(key [, def]) → {int} Get integer value from localStorage Parameters: Name Type Argument Default Description key string key to get value for def int &lt;optional&gt; &lt;nullable&gt; null optional value to return, if NaN Source: bower_components/chrome-extension-utils/storage.js, line 41 Returns: value as integer, NaN on error Type int &lt;static&gt; safeSet(key, value [, keyBool]) → {boolean} Save a value to localStorage only if there is enough room Parameters: Name Type Argument Description key string localStorage Key value Object value to save keyBool string &lt;optional&gt; key to a boolean value that is true if the primary key has non-empty value Source: bower_components/chrome-extension-utils/storage.js, line 88 Returns: true if value was set successfully Type boolean &lt;static&gt; set(key [, value]) JSON stringify and save a value to localStorage Parameters: Name Type Argument Default Description key string key to set value for value Object &lt;optional&gt; &lt;nullable&gt; null new value, if null remove item Source: bower_components/chrome-extension-utils/storage.js, line 69 × Search results Close "},"Chrome.Utils.html":{"id":"Chrome.Utils.html","title":"Namespace: Utils","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Utils Utils Utility methods Source: bower_components/chrome-extension-utils/chrome_utils.js, line 13 Methods &lt;static&gt; getChromeVersion() → {int} Get the Chrome version Source: bower_components/chrome-extension-utils/chrome_utils.js, line 43 See: http://stackoverflow.com/a/4900484/4468645 Returns: Chrome major version Type int &lt;static&gt; getExtensionName() → {string} Get the extension's name Source: bower_components/chrome-extension-utils/chrome_utils.js, line 23 Returns: Extension name Type string &lt;static&gt; getFullChromeVersion() → {string} Get the full Chrome version Source: bower_components/chrome-extension-utils/chrome_utils.js, line 54 See: https://goo.gl/2ITMNO Returns: Chrome version Type string &lt;static&gt; getPlatformOS() → {Promise.&lt;string&gt;} Get the OS as a human readable string Source: bower_components/chrome-extension-utils/chrome_utils.js, line 64 Returns: OS name Type Promise.&lt;string&gt; &lt;static&gt; getVersion() → {string} Get the Extension version Source: bower_components/chrome-extension-utils/chrome_utils.js, line 32 Returns: Extension version Type string × Search results Close "},"ClipItem.html":{"id":"ClipItem.html","title":"Class: ClipItem","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Class: ClipItem ClipItem new ClipItem(text, date, fav, remote, device) Create a new ClipItem Parameters: Name Type Description text string The text of the clip date int Time in milliSecs from epoch fav boolean true if this has been marked as a favorite remote boolean true if this came from a device other than ours device string A String representing the source device Source: scripts/clip_item.js, line 22 Members &lt;private, static&gt; _db :Object The Dexie database Type: Object Source: scripts/clip_item.js, line 37 See: http://dexie.org/ &lt;static, constant&gt; ERROR_EMPTY_TEXT :string Error indicating that ClipItem text is null or all whitespace Type: string Default Value: Empty text Source: scripts/clip_item.js, line 54 &lt;private, static, constant&gt; VERSION :int The Dexie database version Type: int Source: scripts/clip_item.js, line 46 Methods &lt;private, static&gt; _deleteOlderThan(time) → {Promise.&lt;boolean&gt;} Delete non-favorite ClipItem objects older than the given time Parameters: Name Type Description time int time in millis since epoch Source: scripts/clip_item.js, line 190 Returns: true if items were deleted Type Promise.&lt;boolean&gt; &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Dexie Source: scripts/clip_item.js, line 204 &lt;static&gt; add(text, date, fav, remote, device) → {Promise.&lt;ClipItem&gt;} Add new ClipItem to storage Parameters: Name Type Description text string The text of the clip date int Time in milliSecs from epoch fav boolean true if this has been marked as a favorite remote boolean true if this came from a device other than ours device string A String representing the source device Source: scripts/clip_item.js, line 118 Returns: A new ClipItem Type Promise.&lt;ClipItem&gt; &lt;static&gt; deleteOld() → {Promise.&lt;boolean&gt;} Delete items older than the storageDuration setting Source: scripts/clip_item.js, line 166 Returns: true if items were deleted Type Promise.&lt;boolean&gt; &lt;static&gt; isEmpty() → {Promise.&lt;boolean&gt;} Return true is there are no stored ClipItem objects Source: scripts/clip_item.js, line 148 Returns: true if no ClipItem objects Type Promise.&lt;boolean&gt; &lt;static&gt; loadAll() → {Promise.&lt;Array&gt;} Return all the ClipItem objects from storage Source: scripts/clip_item.js, line 158 Returns: Array of ClipItem objects Type Promise.&lt;Array&gt; &lt;static&gt; remove(keys) → {Promise.&lt;void&gt;} Remove the given keys from storage Parameters: Name Type Description keys Array.&lt;string&gt; array of keys to delete Source: scripts/clip_item.js, line 140 Returns: void Type Promise.&lt;void&gt; exists() → {Promise.&lt;boolean&gt;} Determine if ClipItem text exists in storage Source: scripts/clip_item.js, line 103 Returns: true if text exists Type Promise.&lt;boolean&gt; getFav() → {boolean} Get fav Source: scripts/clip_item.js, line 68 Returns: fav Type boolean save() → {Promise.&lt;string&gt;} Save ourselves to storage Source: scripts/clip_item.js, line 92 Returns: primary key it was stored under Type Promise.&lt;string&gt; setDate(date) Set date Parameters: Name Type Description date int millis from epoch Source: scripts/clip_item.js, line 60 setFav(fav) Set favorite Parameters: Name Type Description fav boolean is item a favorite Source: scripts/clip_item.js, line 76 setRemote(remote) Set remote Parameters: Name Type Description remote boolean true if not from our Device Source: scripts/clip_item.js, line 84 × Search results Close "},"ContentScript.html":{"id":"ContentScript.html","title":"Namespace: ContentScript","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: ContentScript ContentScript Content script to monitor clipboard copy and cuts Source: scripts/on_copy_cut_content_script.js, line 8 Methods &lt;static&gt; window.onMyCopy() On copy or cut event, send a message to our extension Source: scripts/on_copy_cut_content_script.js, line 24 × Search results Close "},"Device.html":{"id":"Device.html","title":"Class: Device","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Class: Device Device new Device(model, sn, os, nickname, lastSeen) Creates a new Device instance. Parameters: Name Type Description model string The model name of a device sn string The serial number (or other descriptor) of a device os string The operating system of a device nickname string The nickname of a device lastSeen int A date in millis from the epoch Source: scripts/device.js, line 22 Members &lt;static, constant&gt; MODEL Model key Default Value: dM Source: scripts/device.js, line 39 &lt;static, constant&gt; NICKNAME Nickname key Default Value: dN Source: scripts/device.js, line 60 &lt;static, constant&gt; OS Operating system key Default Value: dOS Source: scripts/device.js, line 53 &lt;static, constant&gt; SN Serial Number key Default Value: dSN Source: scripts/device.js, line 46 Methods &lt;static&gt; myModel() → {string} Get model name of our Device Source: scripts/device.js, line 114 Returns: model name Type string &lt;static&gt; myName() → {string} Get display name of our Device Source: scripts/device.js, line 102 Returns: display name Type string &lt;static&gt; myNickname() → {string} Get nickname of our Device Source: scripts/device.js, line 146 Returns: nickname Type string &lt;static&gt; myOS() → {string} Get operating system of our Device Source: scripts/device.js, line 130 Returns: operating system Type string &lt;static&gt; mySN() → {string} Get serial number of our Device Source: scripts/device.js, line 122 Returns: serial number Type string &lt;static&gt; myUniqueName() → {string} Get unique name of our Device Source: scripts/device.js, line 94 Returns: unique name Type string &lt;static&gt; myVersion() → {string} Get os version of our Device Source: scripts/device.js, line 138 Returns: operating system version Type string getName() → {string} Get name suitable for display Source: scripts/device.js, line 74 Returns: descriptive name of Device Type string getUniqueName() → {string} Get a String that uniquely (hopefully) determines this Device Source: scripts/device.js, line 66 Returns: unique name Type string isMe() → {boolean} Determine if this is our Device Source: scripts/device.js, line 86 Returns: true if this is our Device Type boolean × Search results Close "},"ExceptionHandler.html":{"id":"ExceptionHandler.html","title":"Class: ExceptionHandler","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Class: ExceptionHandler ExceptionHandler new ExceptionHandler() Log Exceptions with analytics. Include: new ExceptionHandler() at top of every js file Source: bower_components/chrome-extension-utils/exception_handler.js, line 21 × Search results Close "},"Main.html":{"id":"Main.html","title":"Namespace: Main","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: Main Main Script for the main.html page Source: scripts/main/main.js, line 12 Members &lt;static, constant&gt; ANDROID_URI :string Path to the android app in the Play Store Type: string Source: scripts/main/main.js, line 33 &lt;static&gt; devicesPage :element devices-page element Type: element Source: scripts/main/main.js, line 170 &lt;static, constant&gt; EXT_URI :string Path to the extension in the Web Store Type: string Source: scripts/main/main.js, line 24 &lt;static&gt; isMainPage :boolean Is the mainPage being displayed Type: boolean Source: scripts/main/main.js, line 177 &lt;static&gt; pages :Array.&lt;Main.page&gt; Array of Main.page objects Type: Array.&lt;Main.page&gt; Source: scripts/main/main.js, line 75 &lt;static&gt; prevRoute :string Previous route Type: string Source: scripts/main/main.js, line 156 &lt;static, constant&gt; SCREEN_SAVER_URI :string Path to my screen saver extension Type: string Source: scripts/main/main.js, line 43 &lt;static&gt; signInPage :element signin-page element Type: element Source: scripts/main/main.js, line 163 &lt;static, constant&gt; t :Object Auto-binding template Type: Object Source: scripts/main/main.js, line 52 &lt;static&gt; t.avatar :string User photo Type: string Source: scripts/main/main.js, line 149 &lt;static&gt; t.dialogText :string Error dialog text Type: string Source: scripts/main/main.js, line 135 &lt;static&gt; t.dialogTitle :string Error dialog title Type: string Source: scripts/main/main.js, line 128 &lt;static&gt; t.route :string Current route Type: string Source: scripts/main/main.js, line 142 Methods &lt;private, static&gt; _checkPermissions() Display dialog to prompt for accepting optional permissions if it has not been set yet Source: scripts/main/main.js, line 370 &lt;private, static&gt; _closeDrawer() Close drawer if drawerPanel is narrow Source: scripts/main/main.js, line 480 &lt;private, static&gt; _getPageIdx(name) → {int} Get the index into the Main.pages array Parameters: Name Type Description name string Main.page route Source: scripts/main/main.js, line 383 Returns: index into array Type int &lt;private, static&gt; _onChromeMessage(request, sender, response) Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: scripts/main/main.js, line 301 See: https://developer.chrome.com/extensions/runtime#event-onMessage &lt;private, static&gt; _onHighlighted(highlightInfo) Event: Fired when the highlighted or selected tabs in a window changes. Parameters: Name Type Description highlightInfo Object info Source: scripts/main/main.js, line 342 See: https://developer.chrome.com/extensions/tabs#event-onHighlighted &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string value that changed Source: scripts/main/main.js, line 327 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;private, static&gt; _scrollPageToTop() Scroll Main Panel to top Source: scripts/main/main.js, line 471 &lt;private, static&gt; _setDevicesState() Set enabled state of Devices menu item Source: scripts/main/main.js, line 492 &lt;private, static&gt; _showDevicesPage(index) Show the devices page Parameters: Name Type Description index int index into Main.pages Source: scripts/main/main.js, line 412 &lt;private, static&gt; _showHelpPage(index) Show the help page Parameters: Name Type Description index int index into Main.pages Source: scripts/main/main.js, line 446 &lt;private, static&gt; _showPermissionsDialog() Show the permissions dialog Source: scripts/main/main.js, line 462 &lt;private, static&gt; _showSettingsPage(index) Show the settings page Parameters: Name Type Description index int index into Main.pages Source: scripts/main/main.js, line 429 &lt;private, static&gt; _showSignInPage(index) Show the signin page Parameters: Name Type Description index int index into Main.pages Source: scripts/main/main.js, line 395 &lt;static&gt; t.computeAvatarDisplay(avatar) → {string} Computed Binding: Determine if avatar should be visible Parameters: Name Type Description avatar string photo url Source: scripts/main/main.js, line 282 Returns: display type Type string &lt;static&gt; t.onAcceptPermissionsClicked() Event: Clicked on accept permissions dialog button Source: scripts/main/main.js, line 255 &lt;static&gt; t.onDenyPermissionsClicked() Event: Clicked on deny permissions dialog button Source: scripts/main/main.js, line 270 &lt;static&gt; t.onNavMenuItemTapped(event) Event: navigation menu selected Parameters: Name Type Description event Event event Source: scripts/main/main.js, line 200 &lt;static&gt; t.onPageAnimation() Event: Main.page finished animating in Source: scripts/main/main.js, line 241 &lt;static&gt; t.onShowErrorDialog(event) Event: display error dialog Parameters: Name Type Description event Event event Source: scripts/main/main.js, line 231 Type Definitions page Manage an html page that is inserted on demand May also be a url link to external site Type: Object Properties: Name Type Description label string label for Nav menu route string element name route to page icon string icon for Nav Menu obj Object | function something to be done when selected ready boolean true if html is inserted disabled boolean disabled state of Nav menu divider boolean true for divider before item Source: scripts/main/main.js, line 54 × Search results Close "},"ReceiveMsg.html":{"id":"ReceiveMsg.html","title":"Namespace: ReceiveMsg","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: ReceiveMsg ReceiveMsg Handle incoming push messages Source: scripts/background/receive_msg.js, line 10 Members &lt;private, static, constant&gt; MESSAGE_WAIT_MILLIS :int Delay time for fcm message processing Type: int Default Value: 500 Source: scripts/background/receive_msg.js, line 24 Methods &lt;private, static&gt; _getDevice(data) → {Device} Get new Device from GaeMsg Parameters: Name Type Description data GaeMsg push data Source: scripts/background/receive_msg.js, line 33 Returns: a Device Type Device &lt;private, static&gt; _onWebRequestBefore(details) → {Object} Event: Fired when a Web request is about to occur. Capture the Service Worker request and process messages Parameters: Name Type Description details Object details on the request Source: scripts/background/receive_msg.js, line 98 See: https://goo.gl/4j4RtY Returns: cancel the request Type Object &lt;private, static&gt; _process(data) Process received push notifications Parameters: Name Type Description data GaeMsg push message Source: scripts/background/receive_msg.js, line 43 × Search results Close "},"ServiceWorker.html":{"id":"ServiceWorker.html","title":"Namespace: ServiceWorker","body":" Documentation Namespaces app.Alarmapp.Backgroundapp.CBapp.ChromeMsgapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.MyDataapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.MsgChrome.StorageChrome.UtilsContentScriptMainReceiveMsgServiceWorker Classes ClipItemDeviceExceptionHandler Global Global Namespace: ServiceWorker ServiceWorker Service Worker to handle push notifications Source: scripts/sw.js, line 10 Members &lt;static, constant&gt; ACTION_DEVICE_REMOVED Source: scripts/sw.js, line 51 &lt;static, constant&gt; ACTION_MESSAGE Source: scripts/sw.js, line 49 &lt;static, constant&gt; IC_ADD_DEVICE Source: scripts/sw.js, line 56 &lt;static, constant&gt; IC_REMOTE_COPY Source: scripts/sw.js, line 54 &lt;static, constant&gt; IC_REMOVE_DEVICE Source: scripts/sw.js, line 58 &lt;static, constant&gt; IC_SEARCH Source: scripts/sw.js, line 60 &lt;static&gt; msgArr Source: scripts/sw.js, line 68 &lt;static, constant&gt; TAG_DEVICE Source: scripts/sw.js, line 46 &lt;static, constant&gt; TAG_MESSAGE Source: scripts/sw.js, line 44 &lt;static, constant&gt; URL_EXT :string Path to extension's main page Type: string Default Value: chrome-extension://jemdfhaheennfkehopbpkephjlednffd/html/main.html Source: scripts/sw.js, line 40 &lt;static, constant&gt; URL_FETCH_BASE :string Fake fetch base path Type: string Default Value: https://pushy-clipboard.github.io/? Source: scripts/sw.js, line 22 &lt;static, constant&gt; URL_SEARCH_BASE :string Google search base path Type: string Default Value: https://www.google.com/search?q= Source: scripts/sw.js, line 31 Methods &lt;static&gt; doFakeFetch(dataArray) → {Promise.&lt;void&gt;} Send fake GET request so extension can intercept it and get the payload Parameters: Name Type Description dataArray Array.&lt;GaeMsg&gt; Array of GaeMsg objects Source: scripts/sw.js, line 145 See: https://bugs.chromium.org/p/chromium/issues/detail?id=452942 Returns: fails if extension successfully canceled request Type Promise.&lt;void&gt; &lt;static&gt; getDeviceName(data) → {string} Get the name of the Device who sent the message Parameters: Name Type Description data GaeMsg message object Source: scripts/sw.js, line 85 Returns: device name Type string &lt;static&gt; getIcon(data) → {string} Get the icon for the notification Parameters: Name Type Description data GaeMsg message object Source: scripts/sw.js, line 115 Returns: path to icon Type string &lt;static&gt; getTag(data) → {string} Get the tag for the notification Parameters: Name Type Description data GaeMsg message object Source: scripts/sw.js, line 101 Returns: notification tag Type string &lt;static&gt; onNotificationClick(event) Event: Notification clicked. Parameters: Name Type Description event SWEvent the event Source: scripts/sw.js, line 255 &lt;static&gt; onNotificationClose(event) Event: Notification closed - can't open or focus window here. Parameters: Name Type Description event SWEvent the event Source: scripts/sw.js, line 292 &lt;static&gt; onPush(event) Event: Received push message Parameters: Name Type Description event SWEvent the event Source: scripts/sw.js, line 157 Type Definitions SWEvent Service Worker Events Type: Event Properties: Name Type Description waitUntil(Promise) function wait till promise returns notification Object notification action Object notification action Source: scripts/sw.js, line 70 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
