<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"background_alarm.js.html":{"id":"background_alarm.js.html","title":"Source: background/alarm.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/alarm.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the chrome.alarm * @namespace */ app.Alarm = (function() { 'use strict'; new ExceptionHandler(); /** * Alarm for cleaning up old {@link ClipItem} objects * @type {string} * @const * @default * @private * @memberOf app.Alarm */ const ALARM_STORAGE = 'storage'; /** * Event: Fired when an alarm has elapsed. * @see https://developer.chrome.com/apps/alarms#event-onAlarm * @param {Object} alarm - details on alarm * @private * @memberOf app.Alarm */ function _onAlarm(alarm) { if (alarm.name === ALARM_STORAGE) { app.Alarm.deleteOldClipItems(); } } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf app.Alarm */ function _onStorageChanged(event) { if (event.key === 'storageDuration') { app.Alarm.updateAlarms(); } } /** * Event: called when document and resources are loaded * @private * @memberOf app.Alarm */ function _onLoad() { // Listen for alarms chrome.alarms.onAlarm.addListener(_onAlarm); // Listen for changes to localStorage addEventListener('storage', _onStorageChanged, false); } // listen for document and resources loaded window.addEventListener('load', _onLoad); return { /** * Set the repeating alarms * @memberOf app.Alarm */ updateAlarms: function() { const durationType = Chrome.Storage.getInt('storageDuration', 2); if (durationType === 4) { // until room is needed chrome.alarms.clear(ALARM_STORAGE); } else { // Add daily alarm to delete old clipItems chrome.alarms.get(ALARM_STORAGE, (alarm) =&gt; { if (!alarm) { chrome.alarms.create(ALARM_STORAGE, { when: Date.now() + app.Utils.MILLIS_IN_DAY, periodInMinutes: app.Utils.MIN_IN_DAY, }); } }); } }, /** * Delete {@link ClipItem} objects older than the * storageDuration setting * @memberOf app.Alarm */ deleteOldClipItems: function() { app.ClipItem.deleteOld().catch((err) =&gt; { Chrome.Log.error(err.message, 'Alarm.deleteOldClipItems'); }); }, }; })(); × Search results Close "},"background_clipboard.js.html":{"id":"background_clipboard.js.html","title":"Source: background/clipboard.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/clipboard.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the clipboard * @namespace */ app.CB = (function() { 'use strict'; new ExceptionHandler(); /** * Delay time for reading from clipboard * @type {int} * @default * @private * @memberOf app.CB */ const WAIT_MILLIS = 250; /** * Send local {@link ClipItem} push notification if enabled * @param {ClipItem} clipItem - {@link ClipItem} to send * @private * @memberOf app.CB */ function _sendLocalClipItem(clipItem) { if (!clipItem.remote &amp;&amp; app.Utils.isAutoSend()) { // send to our devices app.Msg.sendClipItem(clipItem).catch((err) =&gt; { app.Msg.sendFailed(err); }); } } /** * Add a new {@link ClipItem} from the Clipboard contents * @private * @memberOf app.CB */ function _addClipItemFromClipboard() { if (!app.Utils.isMonitorClipboard()) { return; } // wait a little to make sure clipboard is ready setTimeout(function() { // get the clipboard contents const text = app.CB.getTextFromClipboard(); if (app.Notify.onCopy()) { app.Notify.create(app.Notify.TYPE.CLIPBOARD_CHANGED, text); } // Persist app.ClipItem.add(text, Date.now(), false, false, app.Device.myName(), true).then((clipItem) =&gt; { // send to our devices _sendLocalClipItem(clipItem); return Promise.resolve(); }).catch((err) =&gt; { const msg = err.message; if (msg !== app.ClipItem.ERROR_EMPTY_TEXT) { Chrome.Log.error(msg, 'CB._addClipItemFromClipboard'); } if (app.Notify.onError()) { app.Notify.create(app.Notify.TYPE.ERROR_STORE_CLIP, msg, new Chrome.Storage.LastError()); } }); }, WAIT_MILLIS); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.CB */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.COPIED_TO_CLIPBOARD.message) { // clipboard change detected _addClipItemFromClipboard(); } else if (request.message === app.ChromeMsg.COPY_TO_CLIPBOARD.message) { // copy a ClipItem to the clipboard const clip = request.item; const clipItem = new app.ClipItem(clip.text, clip.lastSeen, clip.fav, clip.remote, clip.device, clip.labelsId, clip.labels); app.CB.copyToClipboard(clipItem.text); _sendLocalClipItem(clipItem); } return ret; } Chrome.Msg.listen(_onChromeMessage); return { /** * Get the text from the clipboard * @returns {string} text from clipboard * @memberOf app.CB */ getTextFromClipboard: function() { const input = document.createElement('textArea'); document.body.appendChild(input); input.focus(); input.select(); document.execCommand('Paste'); const text = input.value; input.remove(); return text; }, /** * Copy the given text to the clipboard * @param {string} text - text to copy * @memberOf app.CB */ copyToClipboard: function(text) { const input = document.createElement('textArea'); document.body.appendChild(input); input.textContent = text; input.focus(); input.select(); document.execCommand('Copy'); input.remove(); if (app.Notify.onCopy()) { app.Notify.create(app.Notify.TYPE.CLIPBOARD_CHANGED, text); } }, }; })(); × Search results Close "},"chrome_msg.js.html":{"id":"chrome_msg.js.html","title":"Source: chrome_msg.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: chrome_msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Chrome messages for the extension * @namespace */ app.ChromeMsg = (function() { 'use strict'; new ExceptionHandler(); /** * Chrome Messages * @type {{}} * @property {Chrome.Msg.Message} REMOVE_DEVICE - a {@link Device} was * removed from {@link app.Devices} * @property {Chrome.Msg.Message} DEVICES_CHANGED - list of {@link * app.Devices} changed * @property {Chrome.Msg.Message} PING - ping our {@link app.Devices} * @property {Chrome.Msg.Message} COPY_TO_CLIPBOARD - copy {@link ClipItem} * to clipboard * @property {Chrome.Msg.Message} COPIED_TO_CLIPBOARD - {@link ClipItem} * copied to clipboard * @property {Chrome.Msg.Message} SIGN_IN - {@link app.User} sign in * @property {Chrome.Msg.Message} SIGN_OUT - {@link app.User} sign out * @property {Chrome.Msg.Message} FORCE_SIGN_OUT - {@link app.User} sign out * but don't unregister * @property {Chrome.Msg.Message} MSG_FAILED - send {@link app.Msg} failed * @property {Chrome.Msg.Message} REGISTER_FAILED - register with server * failed * @property {Chrome.Msg.Message} UNREGISTER_FAILED - unregister with server * failed * @property {Chrome.Msg.Message} CLIP_ITEM_CREATED - new clip created * @property {Chrome.Msg.Message} CLIP_ITEM_DELETED - clip deleted * @property {Chrome.Msg.Message} CLIP_ITEM_UPDATED - existing clip updated * @const * @memberOf app.ChromeMsg */ const _MSG = { REMOVE_DEVICE: { message: 'removeDevice', item: '', }, DEVICES_CHANGED: { message: 'devicesChanged', }, PING: { message: 'ping', }, COPY_TO_CLIPBOARD: { message: 'copyToClipboard', item: '', }, COPIED_TO_CLIPBOARD: { message: 'copiedToClipboard', }, SIGN_IN: { message: 'signIn', }, SIGN_OUT: { message: 'signOut', }, FORCE_SIGN_OUT: { message: 'forceSignOut', }, MSG_FAILED: { message: 'sendMessageFailed', }, REGISTER_FAILED: { message: 'registerFailed', }, UNREGISTER_FAILED: { message: 'unregisterFailed', }, NO_REMOTE_DEVICES: { message: 'noRemoteDevices', item: '', }, CLIP_ITEM_CREATED: { message: 'clipItemCreated', item: '', }, CLIP_ITEM_DELETED: { message: 'clipItemDeleted', item: '', }, CLIP_ITEM_UPDATED: { message: 'clipItemUpdated', item: '', }, }; return { REMOVE_DEVICE: _MSG.REMOVE_DEVICE, DEVICES_CHANGED: _MSG.DEVICES_CHANGED, PING: _MSG.PING, COPY_TO_CLIPBOARD: _MSG.COPY_TO_CLIPBOARD, COPIED_TO_CLIPBOARD: _MSG.COPIED_TO_CLIPBOARD, SIGN_IN: _MSG.SIGN_IN, SIGN_OUT: _MSG.SIGN_OUT, FORCE_SIGN_OUT: _MSG.FORCE_SIGN_OUT, MSG_FAILED: _MSG.MSG_FAILED, REGISTER_FAILED: _MSG.REGISTER_FAILED, UNREGISTER_FAILED: _MSG.UNREGISTER_FAILED, NO_REMOTE_DEVICES: _MSG.NO_REMOTE_DEVICES, CLIP_ITEM_CREATED: _MSG.CLIP_ITEM_CREATED, CLIP_ITEM_DELETED: _MSG.CLIP_ITEM_DELETED, CLIP_ITEM_UPDATED: _MSG.CLIP_ITEM_UPDATED, }; })(); × Search results Close "},"background_data.js.html":{"id":"background_data.js.html","title":"Source: background/data.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/data.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the extension's data sources * @namespace */ app.Data = (function() { 'use strict'; new ExceptionHandler(); /** * Version of data - update when items are added, removed, changed * @type {int} * @const * @private * @memberOf app.Data */ const _VERSION = 8; /** * The data items saved to localStorage * * @typedef {Object} app.Data.Items * @property {int} version - version of data * @property {boolean} monitorClipboard - save clipboard contents * @property {boolean} allowPush - send push notifications * @property {boolean} autoSend - automatically send push notifications * @property {boolean} allowReceive - receive push notifications * @property {int} storageDuration - how long to save clipItems * @property {boolean} pinFavs - Pin favorite clips to top of list * @property {boolean} notify - xxx * @property {boolean} notifyOnCopy - show notification when copy detected * @property {boolean} notifyOnSend - show notification on send push * @property {boolean} notifyOnError - show notification on errors * @property {boolean} highPriority - send high priority messages * @property {string} deviceNickname - nickname of our device * @property {Object} devices - other devices we know about * @property {boolean} signedIn - are we logged in * @property {boolean} registered - are we registered with server * @property {boolean} needsCleanup - does are log in state need cleanup * @property {string} email - our email address * @property {string} uid - our unique id * @property {string} photoURL - path to out photo url * @property {string} permissions - enum: notSet allowed denied * @property {int} noDevicesCt - count of noDevice send errors * @property {Chrome.Storage.LastError} lastError - last error that we saved * @memberOf app.Data */ /** * Default values for localStorage items * @type {app.Data.Items} * @const * @private * @memberOf app.Data */ const _DEFAULTS = { 'version': _VERSION, 'monitorClipboard': true, 'allowPush': true, 'autoSend': true, 'allowReceive': true, 'storageDuration': 2, 'pinFavs': false, 'notify': true, 'notifyOnCopy': false, 'notifyOnSend': false, 'notifyOnError': true, 'highPriority': true, 'deviceNickname': '', 'devices': {}, 'signedIn': false, 'registered': false, 'needsCleanup': false, 'email': '', 'uid': '', 'photoURL': '', 'permissions': 'notSet', // enum: notSet allowed denied 'noDevicesCt': 0, }; /** * Initial {@link ClipItem} * @type {string} * @const * @private * @memberOf app.Data */ const _ITEM_TXT = `A clipboard manager that can share with all your devices. https://pushy-clipboard.github.io/index.html Please signin from the &quot;Manage Account&quot; page to share with your \\ other devices. You can click on the toolbar icon at any time to send the current \\ contents of the clipboard to all your other devices. Information you copy in most Chrome pages will \\ automatically be sent if you have enabled that in &quot;Settings&quot;. You can display this page by right clicking on the toolbar icon and \\ selecting &quot;Options&quot;. It is a good idea to go to the &quot;Settings&quot; page and enter a nickname \\ for this device. Contact me for support or to provide feedback pushyclipboard@gmail.com I write free, open source software for fun and hope it benefits others. If you find the extension of value please rate it. Thanks. \\ `; /** * Labeled {@link ClipItem} * @type {string} * @const * @private * @memberOf app.Data */ const _EXAMPLE_LABEL = 'You can label items to categorize them.'; /** * Labeled {@link ClipItem} * @type {string} * @const * @private * @memberOf app.Data */ const _ERROR_INIT = 'Data initialization error.'; /** * Save the [_DEFAULTS]{@link app.Data._DEFAULTS} if they don't exist * @private * @memberOf app.Data */ function _addDefaults() { Object.keys(_DEFAULTS).forEach(function(key) { if (Chrome.Storage.get(key) === null) { Chrome.Storage.set(key, _DEFAULTS[key]); } }); // and the autogenerated serial number if (Chrome.Storage.get('deviceSN') === null) { Chrome.Storage.set('deviceSN', Chrome.Utils.getRandomString(8)); } } /** * Add a {@link ClipItem} with a {@link Label} * @returns {Promise&lt;void&gt;} * @private * @memberOf app.Data */ function _addLabelExample() { let label; return app.Label.add('Example').then((lbl) =&gt; { label = lbl; return app.ClipItem.add(_EXAMPLE_LABEL, Date.now() - 1000, true, false, app.Device.myName()); }).then((clipItem) =&gt; { return clipItem.addLabel(label); }); } /** * Event: called when document and resources are loaded&lt;br /&gt; * Monitor database * @private * @memberOf app.Data */ function _onLoad() { const db = app.DB.get(); db.clipItems.hook('creating', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.CLIP_ITEM_CREATED); msg.item = obj.text; Chrome.Msg.send(msg).catch(() =&gt; {}); }; }); db.clipItems.hook('updating', function(mods, primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.CLIP_ITEM_UPDATED); msg.item = { text: obj.text, mods: mods, }; Chrome.Msg.send(msg).catch(() =&gt; {}); }; }); db.clipItems.hook('deleting', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.CLIP_ITEM_DELETED); msg.item = obj.text; Chrome.Msg.send(msg).catch(() =&gt; {}); }; }); } window.addEventListener('load', _onLoad); return { /** * Initialize the data saved in localStorage * @returns {Promise&lt;void&gt;} * @memberOf app.Data */ initialize: function() { _addDefaults(); // info. on chrome user return app.User.setInfo().then(() =&gt; { // initialize LastError return Chrome.Storage.clearLastError(); }).then(() =&gt; { // add clip with label return _addLabelExample(); }).then(() =&gt; { // add intro clip const date = Date.now(); const dName = app.Device.myName(); const introClip = new app.ClipItem(_ITEM_TXT, date, true, false, dName); return introClip.save(); }); }, /** * Update the data saved in localStorage * @memberOf app.Data */ update: function() { // New items and removal of unused items can take place here // when the version changes const oldVersion = Chrome.Storage.getInt('version'); if (Number.isNaN(oldVersion) || (_VERSION &gt; oldVersion)) { // update version number Chrome.Storage.set('version', _VERSION); } if (!Number.isNaN(oldVersion)) { if (oldVersion &lt; 2) { // remove unused variables localStorage.removeItem('lastEmail'); localStorage.removeItem('lastUid'); } if (oldVersion &lt; 3) { // remove unused variables localStorage.removeItem('notifyOnReceive'); } if (oldVersion &lt; 5) { // move lastError const lastError = Chrome.Storage.get('lastError'); if (lastError) { // transfer to chrome.storage.local Chrome.Storage.setLastError(lastError).catch((err) =&gt; { Chrome.Log.error(err.message, 'Data.update', _ERROR_INIT); }); localStorage.removeItem('lastError'); } else { // add empty Chrome.Storage.clearLastError().catch((err) =&gt; { Chrome.Log.error(err.message, 'Data.update', _ERROR_INIT); }); } } if (oldVersion &lt; 6) { _addLabelExample().catch((err) =&gt; { Chrome.Log.error(err.message, 'Data.update', _ERROR_INIT); }); } } _addDefaults(); }, }; })(); × Search results Close "},"db.js.html":{"id":"db.js.html","title":"Source: db.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: db.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the Dexie database * @see http://dexie.org/ * @namespace */ app.DB = (function() { 'use strict'; new ExceptionHandler(); const _CLIP_ITEM = 'clipItem'; const _LABEL = 'label'; const _CREATE = 'create'; const _UPDATE = 'update'; const _DELETE = 'delete'; const _CREATING = 'creating'; const _UPDATING = 'updating'; const _DELETING = 'deleting'; /** * The Dexie database * @see http://dexie.org/ * @type {Object} * @private * @memberOf app.DB */ let _db; /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Dexie * @private * @memberOf app.DB */ function _onLoad() { _db = new Dexie('ClipItemsDB'); // define database _db.version(1).stores({ clipItems: '&amp;text, date', }); // add labels table and store current clips to tmp table _db.version(2).stores({ clipItems: null, clipItemsTmp: '&amp;text, date', labels: '++_id, &amp;name', }).upgrade(function(t) { let clipItems; return t.db.clipItems.toArray().then((ob) =&gt; { clipItems = ob; return t.idbtrans.objectStore('clipItemsTmp'); }).then((clipItemsTmp) =&gt; { clipItems.forEach((clipItem) =&gt; clipItemsTmp.put(clipItem)); return Promise.resolve(); }); }); // add new clip table, copy in old items and delete tmp table _db.version(3).stores({ clipItems: '++_id, &amp;text, date, *labelsId', }).upgrade(function(t) { let clipItems; return t.db.clipItemsTmp.toArray().then((clips) =&gt; { clipItems = clips; clips.forEach((clipItem) =&gt; { clipItem.labelsId = []; }); return t.idbtrans.objectStore('clipItems'); }).then((clipItemsTable) =&gt; { clipItems.forEach((clipItem) =&gt; clipItemsTable.put(clipItem)); return Promise.resolve(); }).then(() =&gt; { t.idbtrans.db.deleteObjectStore('clipItemsTmp'); return Promise.resolve(); }); }); // add labels array to clipItems _db.version(4).stores({ clipItems: '++_id, &amp;text, date, *labelsId', labels: '++_id, &amp;name', }).upgrade(function(t) { let clipItems; return t.db.clipItems.toArray().then((clips) =&gt; { clipItems = clips; return t.db.labels.toArray(); }).then((labels) =&gt; { clipItems.forEach((clipItem) =&gt; { clipItem.labels = []; labels.forEach((label) =&gt; { if (clipItem.labelsId.includes(label._id)) { clipItem.labels.push(label); } }); }); return t.idbtrans.objectStore('clipItems'); }).then((clipItemsTable) =&gt; { clipItems.forEach((clipItem) =&gt; clipItemsTable.put(clipItem)); return Promise.resolve(); }); }); _db.labels.hook(_CREATING, function() { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { Chrome.GA.event(app.GA.EVENT.DB, _LABEL, _CREATE); }; }); _db.labels.hook(_UPDATING, function(mods, primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { if (mods.hasOwnProperty('name')) { // 'name' property is being updated if (typeof mods.name === 'string') { Chrome.GA.event(app.GA.EVENT.DB, _LABEL, _UPDATE); app.ClipItem.updateLabel(mods.name, obj.name); } } }; }); _db.labels.hook(_DELETING, function(primKey) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { Chrome.GA.event(app.GA.EVENT.DB, _LABEL, _DELETE); app.ClipItem.removeLabel(primKey); }; }); _db.clipItems.hook(_CREATING, function() { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { Chrome.GA.event(app.GA.EVENT.DB, _CLIP_ITEM, _CREATE); }; }); _db.clipItems.hook(_UPDATING, function() { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { Chrome.GA.event(app.GA.EVENT.DB, _CLIP_ITEM, _UPDATE); }; }); _db.clipItems.hook(_DELETING, function() { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { Chrome.GA.event(app.GA.EVENT.DB, _CLIP_ITEM, _DELETE); }; }); _db.clipItems.mapToClass(app.ClipItem); _db.labels.mapToClass(app.Label); } // listen for document and resources loaded addEventListener('load', _onLoad); return { /** * Get the database * @returns {Object} the Dexie db object * @memberOf app.DB */ get: function() { return _db; }, /** * Get the clipItems table * @returns {Object} * @memberOf app.DB */ clips: function() { return _db.clipItems; }, /** * Get the labels table * @returns {Object} * @memberOf app.DB */ labels: function() { return _db.labels; }, }; })(); × Search results Close "},"background_devices.js.html":{"id":"background_devices.js.html","title":"Source: background/devices.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/devices.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * A list of remote {@link Device} objects we know about * @namespace */ app.Devices = (function() { 'use strict'; new ExceptionHandler(); /** * A Map of {@link Device} objects keyed by their unique names * @type {Map} * @private * @memberOf app.Devices */ let _devices = new Map(); /** * Convert Map to Object * @param {Map} map * @returns {Object} as Object * @private * @memberOf app.Devices */ function _mapToObj(map) { let obj = Object.create(null); for (let [k, v] of map) { // We don’t escape the key '__proto__' // which can cause problems on older engines obj[k] = v; } return obj; } /** * Get the {@link Device} objects from localStorage * @private * @memberOf app.Devices */ function _load() { _devices = new Map(); const json = Chrome.Storage.get('devices'); if (!json) { return; } for (let k in json) { if (json.hasOwnProperty(k)) { let v = json[k]; let device = new app.Device(v.model, v.sn, v.os, v.nickname, v.lastSeen); _devices.set(k, device); } } } /** * Save the {@link Device} objects to localStorage * @private * @memberOf app.Devices */ function _save() { Chrome.Storage.set('devices', _mapToObj(_devices)); // let listeners know we changed Chrome.Msg.send(app.ChromeMsg.DEVICES_CHANGED).catch(() =&gt; {}); } /** * Event: called when document and resources are loaded&lt;br /&gt; * Load the {@link Device} objects from localStorage * @private * @memberOf app.Devices */ function _onLoad() { _load(); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the message * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.Devices */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.REMOVE_DEVICE.message) { app.Devices.removeByName(request.item); } else if (request.message === app.ChromeMsg.PING.message) { app.Msg.sendPing().catch((err) =&gt; { app.Msg.sendFailed(err); }); } return ret; } // listen for document and resources loaded window.addEventListener('load', _onLoad); // listen for Chrome messages Chrome.Msg.listen(_onChromeMessage); return { /** * Get an {@link Iterator} on the Devices * @returns {Iterator.&lt;Device&gt;} * @memberOf app.Devices */ entries: function() { return _devices.entries(); }, /** * Add a new {@link Device} * @param {Device} device * @memberOf app.Devices */ add: function(device) { _devices.set(device.getUniqueName(), device); _save(); }, /** * Remove a {@link Device} * @param {Device} device * @memberOf app.Devices */ remove: function(device) { this.removeByName(device.getUniqueName()); }, /** * Remove a {@link Device} with the given unique name * @param {string} uniqueName * @memberOf app.Devices */ removeByName: function(uniqueName) { _devices.delete(uniqueName); _save(); }, /** * Remove all {@link Device} objects * @memberOf app.Devices */ clear: function() { _devices.clear(); _save(); }, }; })(); × Search results Close "},"background_firebase.js.html":{"id":"background_firebase.js.html","title":"Source: background/firebase.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/firebase.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage interaction with firebase and its Namespaces * @see https://firebase.google.com/docs/web/setup * @namespace */ app.Fb = (function() { 'use strict'; new ExceptionHandler(); /** * Error message for regToken * @type {string} * @memberOf app.Fb */ const ERROR_TOKEN = 'Failed to obtain messaging token.\\n'; /** * Error message for no internet * @type {string} * @memberOf app.Fb */ const ERROR_NETWORK = 'There is no Internet connection.\\n'; /** * Firebase app * @private * @memberOf app.Fb */ let _app = null; /** * Firebase messaging Namespace * @private * @memberOf app.Fb */ let _messaging; /** * Firebase auth Namespace * @private * @memberOf app.Fb */ let _auth; /** * Initialize firebase and its Namespaces * @param {ServiceWorkerRegistration} swReg - use own ServiceWorker * @returns {Promise.&lt;void&gt;} void * @private * @memberOf app.Fb */ function _initializeFirebase(swReg) { // noinspection SpellCheckingInspection const config = { apiKey: 'AIzaSyBzqx2gVefRo3tvMFGRFs9gztd081pRgVg', authDomain: 'clip-man.firebaseapp.com', databaseURL: 'https://clip-man.firebaseio.com', storageBucket: 'clip-man.appspot.com', messagingSenderId: '597467211507', }; return _deleteFirebaseApp().then(() =&gt; { _app = firebase.initializeApp(config); _auth = firebase.auth(); _messaging = firebase.messaging(); _messaging.useServiceWorker(swReg); // Callback fired if Instance ID token is updated. _messaging.onTokenRefresh(_refreshRegToken); return Promise.resolve(); }); } /** * Delete firebase.app if it exists * @returns {firebase.Promise&lt;void&gt;|Promise&lt;void&gt;} void * @private * @memberOf app.Fb */ function _deleteFirebaseApp() { if (_app) { return firebase.app().delete(); } return Promise.resolve(); } /** * Refresh the regToken when firebase changes it * @private * @memberOf app.Fb */ function _refreshRegToken() { let token = ''; _messaging.getToken().then((refreshedToken) =&gt; { token = refreshedToken; Chrome.GA.event(app.GA.EVENT.TOKEN_REFRESHED, refreshedToken); if (app.Utils.isRegistered()) { return app.Reg.register(false); } return Promise.resolve(); }).catch((err) =&gt; { const msg = `${err.message} Token: ${token}`; Chrome.Log.error(msg, 'Fb._refreshRegToken'); }); } return { /** * Initialize the firebase libraries * @param {ServiceWorkerRegistration} swReg - service worker * @returns {Promise&lt;void&gt;} void * @memberOf app.Fb */ initialize: function(swReg) { return _initializeFirebase(swReg); }, /** * SignIn to firebase * @param {string} token - token * @returns {Promise&lt;Object&gt;} The current firebase user * @memberOf app.Fb */ signIn: function(token) { return app.SW.initialize().then(() =&gt; { const credential = firebase.auth.GoogleAuthProvider.credential(null, token); // Authorize Firebase with the Google access token. return _auth.signInWithCredential(credential); }); }, /** * Unregister Service Worker and sign-out of firebase * @returns {Promise&lt;void&gt;} Error on reject * @memberOf app.Fb */ signOut: function() { return app.SW.unregister().then(() =&gt; { return _auth.signOut(); }); }, /** * Get the registration token for fcm * @returns {Promise&lt;token&gt;} A registration token for fcm * @memberOf app.Fb */ getRegToken: function() { // this will at least ensure the LAN is connected // may get false positives for other failures if (navigator.onLine) { // you have to already have the notification permission // or this will fail silently return _messaging.requestPermission().then(() =&gt; { return _messaging.getToken(); }).then((token) =&gt; { if (token) { return Promise.resolve(token); } return Promise.reject(new Error(ERROR_TOKEN)); }); } return Promise.reject(new Error(ERROR_NETWORK)); }, }; })(); × Search results Close "},"my_analytics.js.html":{"id":"my_analytics.js.html","title":"Source: my_analytics.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: my_analytics.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage Google Analytics tracking * @namespace */ app.GA = (function() { 'use strict'; /** * Tracking ID * @type {string} * @const * @default * @private * @memberOf app.GA */ const _TRACKING_ID = 'UA-61314754-3'; /** * Event types * @type {{}} * @property {Chrome.GA.Event} CLICK - generic click * @property {Chrome.GA.Event} IMAGE_BUTTON - icon clicked (non-menu) * @property {Chrome.GA.Event} FAB_BUTTON - fab clicked * @property {Chrome.GA.Event} SENT - message sent * @property {Chrome.GA.Event} RECEIVED - message received * @property {Chrome.GA.Event} REGISTERED - {@link Device} registered * @property {Chrome.GA.Event} UNREGISTERED - {@link Device} unregistered * @property {Chrome.GA.Event} TOKEN_REFRESHED - firebase token refreshed * @property {Chrome.GA.Event} DB - any db change * @property {Chrome.GA.Event} CHROME_SIGN_OUT - Chrome signed out of our act. * @const * @memberOf app.GA */ const EVENT = { CLICK: { eventCategory: 'ui', eventAction: 'click', eventLabel: '', }, IMAGE_BUTTON: { eventCategory: 'ui', eventAction: 'imageButtonClicked', eventLabel: '', }, FAB_BUTTON: { eventCategory: 'ui', eventAction: 'fabButtonClicked', eventLabel: '', }, SENT: { eventCategory: 'message', eventAction: 'sent', eventLabel: '', }, RECEIVED: { eventCategory: 'message', eventAction: 'received', eventLabel: '', }, REGISTERED: { eventCategory: 'register', eventAction: 'registered', eventLabel: '', }, UNREGISTERED: { eventCategory: 'register', eventAction: 'unregistered', eventLabel: '', }, TOKEN_REFRESHED: { eventCategory: 'token', eventAction: 'refreshed', eventLabel: '', }, DB: { eventCategory: 'database', eventAction: 'unknown', eventLabel: '', }, CHROME_SIGN_OUT: { eventCategory: 'user', eventAction: 'chromeSignOut', eventLabel: '', }, }; /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Google Analytics * @private * @memberOf app.GA */ function _onLoad() { // initialize analytics Chrome.GA.initialize(_TRACKING_ID, 'Pushy Clipboard', 'pushy-chrome-extension', Chrome.Utils.getVersion()); } // listen for document and resources loaded window.addEventListener('load', _onLoad); return { EVENT: EVENT, }; })(); × Search results Close "},"background_gae.js.html":{"id":"background_gae.js.html","title":"Source: background/gae.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/gae.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle calls to the Google App Engine Endpoints * @see https://cloud.google.com/appengine/docs/standard/java/endpoints/ * @namespace */ app.Gae = (function() { 'use strict'; new ExceptionHandler(); /** * Base path of real gae server * @const * @default * @private * @memberOf app.Gae */ const GAE_ROOT_REMOTE = 'https://clip-man.appspot.com/_ah/api'; // noinspection Eslint,JSUnusedLocalSymbols /** * Base path of local testing server * @const * @default * @private * @memberOf app.Gae */ // eslint-disable-next-line no-unused-vars const GAE_ROOT_LOCAL = 'http://localhost:8080/_ah/api'; // Set to GAE_ROOT_LOCAL for local testing // noinspection UnnecessaryLocalVariableJS const GAE_ROOT = GAE_ROOT_REMOTE; return { /** * Root path to our gae server * @type {string} * @memberOf app.Gae */ GAE_ROOT: GAE_ROOT, /** * Perform POST request to endpoint * @param {string} url - server Endpoint * @param {boolean} retryToken - if true, * retry with new token on error * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise.&lt;void&gt;} void * @memberOf app.Gae */ doPost: function(url, retryToken = false, interactive = false) { const conf = Chrome.JSONUtils.shallowCopy(Chrome.Http.conf); conf.isAuth = true; conf.retryToken = retryToken; conf.interactive = interactive; return Chrome.Http.doPost(url, conf).then((json) =&gt; { if (json.success) { return Promise.resolve(); } else { return Promise.reject(new Error(json.reason)); } }); }, }; })(); × Search results Close "},"background_messaging_client.js.html":{"id":"background_messaging_client.js.html","title":"Source: background/messaging_client.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/messaging_client.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Send messages to the GAE server MessagingEndpoint for delivery * @namespace */ app.Msg = (function() { 'use strict'; new ExceptionHandler(); /** * Data packet sent to server * @typedef {{}} app.Msg.GaeMsg * @property {string} act - type of message * @property {string} m - content of message * @property {string} dM - {@link Device} model * @property {string} dSN - {@link Device} serial number * @property {string} dOS - {@link Device} operating system * @property {string} dN - {@link Device} nickname * @property {string} fav - '1' if favorite item (optional) * @property {string} srcRegId - source of ping (optional) * @memberOf app.Msg */ /** * Base path of MessagingEndpoint * @const * @private * @memberOf app.Msg */ const _URL_BASE = `${app.Gae.GAE_ROOT}/messaging/v1/send/`; /** * Max message length. Server may reduce it more * @const * @private * @memberOf app.Msg */ const _MAX_MSG_LEN = 4096; /** * Message action * @type {{}} * @property {string} MESSAGE * @property {string} PING * @property {string} PING_RESPONSE * @property {string} DEVICE_ADDED * @property {string} DEVICE_REMOVED * @const * @memberOf app.Msg */ const _ACTION = { MESSAGE: 'm', PING: 'ping_others', PING_RESPONSE: 'respond_to_ping', DEVICE_ADDED: 'add_our_device', DEVICE_REMOVED: 'remove_our_device', }; /** * Message body * @type {{}} * @property {string} PING * @property {string} PING_RESPONSE * @property {string} DEVICE_ADDED * @property {string} DEVICE_REMOVED * @const * @private * @memberOf app.Msg */ const _BODY = { PING: 'Contacting other devices...', PING_RESPONSE: 'Device is online', DEVICE_ADDED: 'New device added', DEVICE_REMOVED: 'Device removed', }; /** * Max number of no device errors before turning off push to devices * @const * @private * @memberOf app.Msg */ const _MAX_NO_DEVICES_CT = 10; /** * Starting portion of server error indicating no other registered devices * @const * @private * @memberOf app.Msg */ const _ERR_NO_DEVICES = 'No other devices are registered'; /** * Error to display if we have disabled push to devices * @const * @private * @memberOf app.Msg */ // const _ERR_PUSH_DISABLED = 'No other devices are registered.\\n' + // 'Push to devices has been disabled.\\n' + // 'You can reenable it in the Settings.'; /** * Get the data packet we will send * @param {string} action - message type * @param {string} body - message body * @returns {app.Msg.GaeMsg} * @private * @memberOf app.Msg */ function _getData(action, body) { const msg = _getDevice(); msg.act = action; msg.m = body; return msg; } /** * Get portion of {@link Device} sent in message * @returns {{}} Subset of {@link Device} info as object literal * @memberOf app.Msg */ function _getDevice() { return { [app.Device.MODEL]: app.Device.myModel(), [app.Device.SN]: app.Device.mySN(), [app.Device.OS]: app.Device.myOS(), [app.Device.NICKNAME]: app.Device.myNickname(), }; } /** * Send message to server for delivery to our {@link Devices} * @param {app.Msg.GaeMsg} data - data packet * @param {boolean} notify - display notification if true * @param {?app.Notify.TYPE} type=null - notification type * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.Msg */ function _sendMessage(data, notify, type = null) { if (!app.Utils.canSend()) { return Promise.resolve(); } let url; return app.SW.cantReceive().then((cantReceive) =&gt; { if (cantReceive) { // we don't have a valid regId anymore return Promise.resolve('unknownRegId'); } return app.Fb.getRegToken(); }).then((regId) =&gt; { const json = encodeURIComponent(JSON.stringify(data)); const highPriority = Chrome.Storage.getBool('highPriority'); url = `${_URL_BASE}${regId}/${json}/${highPriority}`; return app.Gae.doPost(url, true); }).then(() =&gt; { if (type &amp;&amp; notify &amp;&amp; app.Notify.onSend()) { app.Notify.create(type, data.m); } Chrome.GA.event(app.GA.EVENT.SENT, data.act); return Promise.resolve(); }); } return { ACTION: _ACTION, /** * Send clipboard contents as represented by a {@link ClipItem} * @param {ClipItem} clipItem - contents of clipboard * @returns {Promise&lt;void&gt;} * @memberOf app.Msg */ sendClipItem: function(clipItem) { if (Chrome.Utils.isWhiteSpace(clipItem.text)) { return Promise.resolve(); } let text = clipItem.text; if (text.length &gt; _MAX_MSG_LEN) { // limit message size. Server may limit more text = text.substring(0, _MAX_MSG_LEN - 1); } const data = _getData(_ACTION.MESSAGE, text); data.fav = clipItem.fav ? '1' : '0'; const notifyType = app.Notify.TYPE.MESSAGE_SENT; return _sendMessage(data, true, notifyType).catch((err) =&gt; { if (err.message.includes(_ERR_NO_DEVICES)) { // check for too many sends without any remote devices let errCt = Chrome.Storage.getInt('noDevicesCt', 0); if (errCt &gt;= _MAX_NO_DEVICES_CT) { Chrome.Storage.set('allowPush', false); // because Background._onStorageChanged won't be called app.Utils.setBadgeText(); // send Chrome message on this error const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.NO_REMOTE_DEVICES); msg.item = _ERR_NO_DEVICES; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); // return Promise.reject(new Error(_ERR_PUSH_DISABLED)); // be silent about turning it off. return Promise.resolve(); } else { // let it go, but increment error count errCt++; Chrome.Storage.set('noDevicesCt', errCt); return Promise.resolve(); } } else { // all other errors return Promise.reject(err); } }); }, /** * Send message for adding our {@link Device} * @returns {Promise&lt;void&gt;} * @memberOf app.Msg */ sendDeviceAdded: function() { const data = _getData(_ACTION.DEVICE_ADDED, _BODY.DEVICE_ADDED); return _sendMessage(data, true, app.Notify.TYPE.DEVICE_ADDED); }, /** * Send message for removing our {@link Device} * @returns {Promise&lt;void&gt;} * @memberOf app.Msg */ sendDeviceRemoved: function() { const data = _getData(_ACTION.DEVICE_REMOVED, _BODY.DEVICE_REMOVED); return _sendMessage(data, true, app.Notify.TYPE.DEVICE_REMOVED); }, /** * Ping our {@link app.Devices} * @returns {Promise&lt;void&gt;} void * @memberOf app.Msg */ sendPing: function() { const data = _getData(_ACTION.PING, _BODY.PING); return _sendMessage(data, false).catch((err) =&gt; { if (err.message.includes(_ERR_NO_DEVICES)) { // send Chrome message on this error const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.NO_REMOTE_DEVICES); msg.item = _ERR_NO_DEVICES; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); return Promise.resolve(); } else { // all other errors return Promise.reject(err); } }); }, /** * Respond to a ping from a {@link Device} * @param {string} srcRegId - source of ping * @returns {Promise&lt;void&gt;} * @memberOf app.Msg */ sendPingResponse: function(srcRegId) { const data = _getData(_ACTION.PING_RESPONSE, _BODY.PING_RESPONSE); data.srcRegId = srcRegId; return _sendMessage(data, false); }, /** * Display notification that send message failed * @param {Error} err * @memberOf app.Msg */ sendFailed: function(err) { Chrome.Log.error(err.message, 'Msg.sendFailed'); if (app.Notify.onError()) { app.Notify.create(app.Notify.TYPE.ERROR_SEND, err.message, new Chrome.Storage.LastError()); } }, }; })(); × Search results Close "},"background_notify.js.html":{"id":"background_notify.js.html","title":"Source: background/notify.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/notify.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle display of notifications * @see https://developer.chrome.com/apps/notifications * @namespace */ app.Notify = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); const _ICON_ERROR = '/images/ic_email_black_48dp.png'; const _ERROR_NO_NOTIFICATIONS = 'Display of notifications on received messages has been disabled.'; /** * Notification type * @typedef {Object} app.Notify.TYPE * @property {string} id - unique notification id * @property {string} title - title * @property {string} message - message * @property {string} icon - path to icon * @property {boolean} isError - if true, error notification * @property {string} pageRoute - page in main.html to route too * @property {boolean} requireInteraction - if true, visible until dismissed * @property {boolean} hasButtons - if true, we have buttons * @property {Array} buttons - button description * @property {Array} buttonFunctions - button click functions * @memberOf app.Notify */ /** * Notification types * @type {{}} * @property {app.Notify.TYPE} CLIPBOARD_CHANGED - detected clipboard change * @property {app.Notify.TYPE} MESSAGE_SENT - message sent to remote devices * @property {app.Notify.TYPE} DEVICE_ADDED - added our device * @property {app.Notify.TYPE} DEVICE_REMOVED - removed our device * @property {app.Notify.TYPE} SEND_ERROR - error sending message * @property {app.Notify.TYPE} ERROR_STORE_CLIP - error saving to DB * @const * @memberOf app.Notify */ const TYPE = { CLIPBOARD_CHANGED: { id: 'localCopy', title: 'Clipboard change detected', message: 'Not set', icon: '/images/ic_local_copy.png', isError: false, pageRoute: 'page-main', requireInteraction: false, hasButtons: false, buttons: [], buttonFunctions: [], }, MESSAGE_SENT: { id: 'localCopy', title: 'Sent push message', message: 'Not set', icon: '/images/ic_local_copy.png', isError: false, pageRoute: 'page-main', requireInteraction: false, hasButtons: false, buttons: [], buttonFunctions: [], }, DEVICE_ADDED: { id: 'added', title: 'Sent push message', message: 'Not set', icon: '/images/ic_add_device.png', isError: false, pageRoute: 'page-devices', requireInteraction: false, hasButtons: false, buttons: [], buttonFunctions: [], }, DEVICE_REMOVED: { id: 'removed', title: 'Sent push message', message: 'Not set', icon: '/images/ic_remove_device.png', isError: false, pageRoute: 'page-main', requireInteraction: false, hasButtons: false, buttons: [], buttonFunctions: [], }, ERROR_SEND: { id: 'error_send', title: 'Failed to send message', message: 'Not set', icon: '/images/ic_error.png', isError: true, pageRoute: 'page-error', requireInteraction: true, hasButtons: true, buttons: [ { 'title': 'Contact support', 'iconUrl': chrome.runtime.getURL(_ICON_ERROR), }, ], buttonFunctions: [_sendErrorEmail], }, ERROR_STORE_CLIP: { id: 'error_store_clip', title: 'Failed to store clipboard contents', message: 'Not set', icon: '/images/ic_error.png', isError: true, pageRoute: 'page-error', requireInteraction: true, hasButtons: true, buttons: [ { 'title': 'Contact support', 'iconUrl': chrome.runtime.getURL(_ICON_ERROR), }, ], buttonFunctions: [_sendErrorEmail], }, ERROR_FORCE_SIGN_OUT: { id: 'error_force_sign_out', title: 'Forced to sign out of extension', message: 'Not set', icon: '/images/ic_error.png', isError: true, pageRoute: 'page-error', requireInteraction: true, hasButtons: true, buttons: [ { 'title': 'Contact support', 'iconUrl': chrome.runtime.getURL(_ICON_ERROR), }, ], buttonFunctions: [_sendErrorEmail], }, }; /** * Get the Notification options object * @param {app.Notify.TYPE} type - notification type * @param {string} message - message to display * @returns {Object} options object * @private */ function _getOptions(type, message) { let options = { type: 'basic', contextMessage: 'Pushy Clipboard', isClickable: true, eventTime: Date.now(), }; options.title = type.title; options.requireInteraction = type.requireInteraction; options.iconUrl = chrome.runtime.getURL(type.icon); options.message = message; if (type.hasButtons) { options.buttons = type.buttons; } return options; } /** * Send an email with info on an error * @param {app.Notify.TYPE} type - notification type * @private */ function _sendErrorEmail(type) { const body = `${type.message}\\n\\n${app.Utils.getEmailBody()}` + 'Please provide what information you can on what led to the error\\n\\n'; const url = app.Utils.getEmailUrl(`Error: ${type.title}`, body); chrome.tabs.create({url: url}); } /** * Event: Fired when the user clicked in a non-button area * of the notification. * @see https://developer.chrome.com/apps/notifications#event-onClicked * @param {string} id - notification type * @private * @memberOf app.Notify */ function _onNotificationClicked(id) { for (let type in TYPE) { if (TYPE.hasOwnProperty(type)) { const item = TYPE[type]; if (item.id === id) { if (item.pageRoute) { // route to proper page app.Utils.showMainTab(item.pageRoute); chrome.notifications.clear(id, () =&gt; {}); } break; } } } } /** * Event: Fired when the user clicked on a button * of the notification. * @see https://developer.chrome.com/apps/notifications#event-onClicked * @param {string} id - notification type * @param {int} btnIdx - index of clicked button * @private * @memberOf app.Notify */ function _onButtonClicked(id, btnIdx) { for (const prop in TYPE) { if (TYPE.hasOwnProperty(prop)) { const item = TYPE[prop]; if (item.hasButtons &amp;&amp; (item.id === id)) { // call button click function if (item.buttonFunctions[btnIdx]) { item.buttonFunctions[btnIdx](item); chrome.notifications.clear(id, () =&gt; {}); } break; } } } } // Listen for click on our notifications chrome.notifications.onClicked.addListener(_onNotificationClicked); // Listen for click on our notification buttons chrome.notifications.onButtonClicked.addListener(_onButtonClicked); return { /** * notification types * @memberOf app.Notify */ TYPE: TYPE, /** * System Notifications not granted error message * @const * @type {string} * @memberOf app.Notify */ ERROR_NO_NOTIFICATIONS: _ERROR_NO_NOTIFICATIONS, /** * Create and display a notification * @param {app.Notify.TYPE} type - notification type * @param {string} message - message to display * @param {Chrome.Storage.LastError} [lastError=null] - lastError * @memberOf app.Notify */ create: function(type, message, lastError = null) { if (Chrome.Utils.isWhiteSpace(type.icon) || Chrome.Utils.isWhiteSpace(message)) { // skip if no icon or message return; } // save message type.message = message; if (type.isError) { let error; if (lastError) { error = lastError; error.message = type.message; error.title = type.title; } else { error = new Chrome.Storage.LastError(type.message, type.title); } Chrome.Storage.setLastError(error); type.message += `\\n\\n${error.stack}`; } // setup notification option object let options = _getOptions(type, type.message); chromep.notifications.getPermissionLevel().then((level) =&gt; { if (level === 'granted') { return chromep.notifications.create(type.id, options); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Notify.create'); }); }, /** * Determine if copy notifications are enabled * @returns {boolean} true if enabled * @memberOf app.Notify */ onCopy: function() { const notify = Chrome.Storage.getBool('notify'); return notify &amp;&amp; Chrome.Storage.getBool('notifyOnCopy'); }, /** * Determine if send notifications are enabled * @returns {boolean} true if enabled * @memberOf app.Notify */ onSend: function() { const notify = Chrome.Storage.getBool('notify'); return notify &amp;&amp; Chrome.Storage.getBool('notifyOnSend'); }, /** * Determine if error notifications are enabled * @returns {boolean} true if enabled * @memberOf app.Notify */ onError: function() { const notify = Chrome.Storage.getBool('notify'); return notify &amp;&amp; Chrome.Storage.getBool('notifyOnError'); }, /** * Determine if navigator Notifications permission has been granted * Note: this will work from the background script of an extension, * unlike the other solutions * @see https://goo.gl/RzekrB * @see https://w3c.github.io/permissions/ * @see https://www.chromestatus.com/features/6443143280984064 * @returns {Promise&lt;boolean&gt;} true if granted * @memberOf app.Notify */ hasNavigatorPermission: function() { return navigator.permissions.query({ name: 'notifications', }).then((status) =&gt; { if (status.state === 'granted') { return Promise.resolve(true); } return Promise.resolve(false); }); }, }; })(); × Search results Close "},"permissions.js.html":{"id":"permissions.js.html","title":"Source: permissions.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: permissions.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle optional permissions * @namespace */ app.Permissions = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** @memberOf app.Permissions */ const PERMISSIONS = ['tabs']; /** @memberOf app.Permissions */ const ORIGINS = ['http://*/*', 'https://*/*']; /** @memberOf app.Permissions */ const NOT_SET = 'notSet'; /** @memberOf app.Permissions */ const ALLOWED = 'allowed'; /** @memberOf app.Permissions */ const DENIED = 'denied'; return { /** @memberOf app.Permissions */ NOT_SET: NOT_SET, /** @memberOf app.Permissions */ ALLOWED: ALLOWED, /** @memberOf app.Permissions */ DENIED: DENIED, /** * Has use made choice on permissions * @returns {boolean} true if allowed or denied * @memberOf app.Permissions */ notSet: function() { return Chrome.Storage.get('permissions') === NOT_SET; }, /** * Has the user allowed the optional permissions * @returns {boolean} true if allowed * @memberOf app.Permissions */ isAllowed: function() { return Chrome.Storage.get('permissions') === ALLOWED; }, /** * Prompt for the optional permissions * @returns {Promise&lt;boolean&gt;} true if permission granted * @memberOf app.Permissions */ request: function() { // if promise chain const ifGranted = function(isTrue) { if (isTrue) { Chrome.Storage.set('permissions', app.Permissions.ALLOWED); return Promise.resolve(isTrue); } else { // remove if it has been previously granted return app.Permissions.remove().then(() =&gt; { return Promise.resolve(isTrue); }); } }; return chromep.permissions.request({ permissions: PERMISSIONS, origins: ORIGINS, }).then((granted) =&gt; { return ifGranted(granted); }); }, /** * Determine if we have the optional permissions * @returns {Promise&lt;boolean&gt;} true if we have permissions * @memberOf app.Permissions */ contains: function() { return chromep.permissions.contains({ permissions: PERMISSIONS, origins: ORIGINS, }); }, /** * Remove the optional permissions * @returns {Promise&lt;boolean&gt;} true if removed * @memberOf app.Permissions */ remove: function() { // if promise chain const ifContains = function(isTrue) { if (isTrue) { // remove permission return chromep.permissions.remove({ permissions: PERMISSIONS, }).then((removed) =&gt; { if (removed) { Chrome.Storage.set('permissions', app.Permissions.DENIED); } return Promise.resolve(removed); }); } else { return Promise.resolve(isTrue); } }; return app.Permissions.contains().then((contains) =&gt; { return ifContains(contains); }); }, /** * Inject our script into all tabs that match * @memberOf app.Permissions */ injectContentScripts: function() { // noinspection JSCheckFunctionSignatures if (app.Permissions.isAllowed()) { chrome.windows.getAll({populate: true}, function(windows) { for (let i = 0; i &lt; windows.length; i++) { // all windows const win = windows[i]; for (let j = 0; j &lt; win.tabs.length; j++) { // all tabs in window const tab = win.tabs[j]; // our matches if (tab.url.match(/(http|https):\\/\\//gi)) { app.Permissions.injectContentScript(tab.id); } } } }); } }, /** * Inject our script into the given tab * @param {int} tabId - tab to inject * @memberOf app.Permissions */ injectContentScript: function(tabId) { if (app.Permissions.isAllowed()) { chrome.tabs.executeScript(tabId, { file: 'scripts/on_copy_cut_content_script.js', allFrames: true, matchAboutBlank: true, }, function() { if (chrome.runtime.lastError) { // noinspection UnnecessaryReturnStatementJS return; } }); } }, }; })(); × Search results Close "},"background_registration_client.js.html":{"id":"background_registration_client.js.html","title":"Source: background/registration_client.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/registration_client.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Handle RegistrationEndpoint tasks on the gae server * @namespace */ app.Reg = (function() { 'use strict'; new ExceptionHandler(); /** * Base path of RegistrationEndpoint * @type string * @const * @private * @memberOf app.Reg */ const URL_BASE = `${app.Gae.GAE_ROOT}/registration/v1/`; /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf app.Reg */ function _onStorageChanged(event) { if (event.key === 'allowReceive') { const allowReceive = app.Utils.allowReceive(); if (allowReceive) { // user wants to receive messages now if (!app.Utils.isSignedIn()) { return; } app.Reg.register(true).catch((err) =&gt; { Chrome.Log.error(err.message, 'Reg._onStorageChanged'); Chrome.Storage.set('allowReceive', !allowReceive); const msg = app.ChromeMsg.REGISTER_FAILED; msg.error = err.message; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); }); } else { // user no longer wants to receive messages if (!app.Utils.isSignedIn()) { return; } app.Reg.unregister(true).catch((err) =&gt; { Chrome.Log.error(err.message, 'Reg._onStorageChanged'); Chrome.Storage.set('allowReceive', !allowReceive); const msg = app.ChromeMsg.UNREGISTER_FAILED; msg.error = err.message; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); }); } } } /** * Listen for changes to localStorage */ addEventListener('storage', _onStorageChanged, false); return { /** * Register {@link Device} with server * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise&lt;void&gt;} void * @memberOf app.Reg */ register: function(interactive = false) { if (!app.Utils.allowReceive()) { return Promise.resolve(); } return app.Fb.getRegToken().then((regId) =&gt; { const url = `${URL_BASE}register/${regId}`; return app.Gae.doPost(url, true, interactive); }).then(() =&gt; { Chrome.GA.event(app.GA.EVENT.REGISTERED); Chrome.Storage.set('registered', true); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Reg.register'); const prefix = 'Failed to register with the server.\\n'; return Promise.reject(new Error(prefix + err.message)); }); }, /** * Unregister {@link Device} with server * @param {boolean} [interactive=false] - true if user initiated * @returns {Promise&lt;void&gt;} void * @memberOf app.Reg */ unregister: function(interactive = false) { if (!app.Utils.isSignedIn()) { Chrome.Storage.set('registered', false); return Promise.resolve(); } return app.Fb.getRegToken().then((regId) =&gt; { const url = `${URL_BASE}unregister/${regId}`; return app.Gae.doPost(url, true, interactive); }).then(() =&gt; { Chrome.GA.event(app.GA.EVENT.UNREGISTERED); Chrome.Storage.set('registered', false); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Reg.unregister'); const prefix = 'Failed to unregister with the server.\\n'; return Promise.reject(new Error(prefix + err.message)); }); }, }; })(); × Search results Close "},"background_service_worker.js.html":{"id":"background_service_worker.js.html","title":"Source: background/service_worker.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/service_worker.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage lifecycle of our {@link ServiceWorker} * @namespace */ app.SW = (function() { 'use strict'; new ExceptionHandler(); const _ERR_REG = 'Failed to register Service Worker: '; const _ERR_UNREG = 'Failed to unregister Service Worker: '; const _ERR_UNREG_BOOL = 'returned false'; const _ERROR_NOT_SUBSCRIBED = 'The extension has lost the subscription to receive push notifications.'; /** * Path to our {@link ServiceWorker} * @const * @private * @memberOf app.SW */ const _PATH = '../scripts/sw.js'; /** * Our ServiceWorkerRegistration object * @private * @memberOf app.SW */ let _reg = null; /** * Register the Service Worker * Note: This can be called if already registered * @returns {Promise&lt;Object&gt;} service worker * @private * @memberOf app.SW */ function _register() { return navigator.serviceWorker.register(_PATH).then((swReg) =&gt; { _reg = swReg; return Promise.resolve(_reg); }).catch((err) =&gt; { return Promise.reject(new Error(_ERR_REG + err.message)); }); } /** * Unsubscribe from push notifications * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.SW */ function _unsubscribePush() { return _reg.pushManager.getSubscription().then((sub) =&gt; { if (sub) { return sub.unsubscribe(); } return Promise.resolve(); }); } return { /** * Not subscribed to push error message * @const * @type {string} * @memberOf app.SW */ ERROR_NOT_SUBSCRIBED: _ERROR_NOT_SUBSCRIBED, /** * Initialize the {@link ServiceWorker} and firebase * @returns {Promise&lt;void&gt;} void * @memberOf app.SW */ initialize: function() { return _register().then((swReg) =&gt; { return app.Fb.initialize(swReg); }).catch((err) =&gt; { return Promise.reject(new Error(_ERR_REG + err.message)); }); }, /** * Unregister the Service Worker * @returns {Promise&lt;void&gt;} void * @memberOf app.SW */ unregister: function() { if (!_reg) { return Promise.resolve(); } return _unsubscribePush().then(() =&gt; { return _reg.unregister(); }).then((unregistered) =&gt; { if (unregistered) { _reg = null; return Promise.resolve(); } else { return Promise.reject(new Error(_ERR_UNREG + _ERR_UNREG_BOOL)); } }).catch((err) =&gt; { return Promise.reject(new Error(_ERR_UNREG + err.message)); }); }, /** * Update the Service Worker * @returns {Promise&lt;void&gt;} void always resolves * @memberOf app.SW */ update: function() { if (_reg) { _reg.update(); } return Promise.resolve(); }, /** * Are we subscribed to push notifications * @returns {Promise&lt;boolean&gt;} true if subscribed * @memberOf app.SW */ isSubscribed: function() { if (_reg) { return _reg.pushManager.getSubscription().then((sub) =&gt; { // sub null if not subscribed return Promise.resolve(!!sub); }); } return Promise.resolve(false); }, /** * Check if the ServiceWorker is not in a state for receiving messages * @returns {Promise&lt;?string&gt;} reason if it can't, or null * @memberOf app.SW */ cantReceive: function() { // Need to be subscribed and have notifications permission let cantMsg = null; return app.Notify.hasNavigatorPermission().then((granted) =&gt; { if (!granted) { cantMsg = app.Notify.ERROR_NO_NOTIFICATIONS; } return app.SW.isSubscribed(); }).then((subscribed) =&gt; { if (!subscribed &amp;&amp; !cantMsg) { cantMsg = app.SW.ERROR_NOT_SUBSCRIBED; } return Promise.resolve(cantMsg); }); }, }; })(); × Search results Close "},"background_user.js.html":{"id":"background_user.js.html","title":"Source: background/user.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/user.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Manage the current user * @namespace */ app.User = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Set signIn state * @param {boolean} val - true if signed in * @private */ function _setSignIn(val) { Chrome.Storage.set('signedIn', val); // because Background._onStorageChanged won't be called app.Utils.setBadgeText(); if (!val) { Chrome.Storage.set('photoURL', ''); } } /** * Event: Fired when signin state changes for an act. on the user's profile. * @see https://developer.chrome.com/apps/identity#event-onSignInChanged * @param {Object} account - chrome AccountInfo * @param {boolean} signedIn - true if signedIn * @private * @memberOf app.User */ function _onSignInChanged(account, signedIn) { const uid = Chrome.Storage.get('uid'); if (app.Utils.isSignedIn() &amp;&amp; !signedIn &amp;&amp; (account.id === uid)) { // our user signed out of Chrome while we were signed in Chrome.GA.event(app.GA.EVENT.CHROME_SIGN_OUT); Chrome.Storage.set('needsCleanup', true); _setSignIn(false); app.Devices.clear(); Chrome.Storage.set('registered', false); app.Fb.signOut().catch(() =&gt; {}); } app.User.setInfo().catch((err) =&gt; { Chrome.Log.error(err.message, 'User._onSignInChanged'); }); } /** * Remove the cached auth token * @returns {Promise.&lt;void&gt;} void * @private */ function _removeAuthToken() { return Chrome.Auth.removeCachedToken().catch((err) =&gt; { Chrome.Log.error(err.message, 'User._removeAuthToken'); return Promise.resolve(); }); } /** * Cleanup if user signed-out of Browser * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.User */ function _needsCleanup() { if (Chrome.Storage.getBool('needsCleanup')) { Chrome.Storage.set('needsCleanup', false); return _removeAuthToken(); } else { return Promise.resolve(); } } /** * Sign in and register our {@link Device} * @returns {Promise&lt;void&gt;} void * @private * @memberOf app.User */ function _signIn() { return _needsCleanup().then(() =&gt; { return app.SW.initialize(); }).then(() =&gt; { return Chrome.Auth.getToken(true); }).then((token) =&gt; { return app.Fb.signIn(token); }).then((user) =&gt; { _setSignIn(true); if (!Chrome.Utils.isWhiteSpace(user.photoURL)) { Chrome.Storage.set('photoURL', user.photoURL); } return app.Reg.register(true); }).then(() =&gt; { return app.Msg.sendDeviceAdded(); }); } /** * Unregister {@link Device} and sign out of firebase * @returns {Promise&lt;void&gt;} - always resolves * @private * @memberOf app.User */ function _signOut() { return app.Msg.sendDeviceRemoved().then(() =&gt; { return app.Reg.unregister(true); }).then(() =&gt; { return app.Fb.signOut(); }).then(() =&gt; { return _removeAuthToken(); }).then(() =&gt; { _setSignIn(false); app.Devices.clear(); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'User._signOut'); // just force the sign out return app.User.forceSignOut(false, err.message); }).catch((err) =&gt; { Chrome.Storage.set('registered', false); _setSignIn(false); app.Devices.clear(); Chrome.Log.error(err.message, 'User.forceSignOut'); return Promise.resolve(); }); } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf app.User */ function _onChromeMessage(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.SIGN_IN.message) { // try to signIn a user ret = true; // async _signIn().then(() =&gt; { response({message: 'ok'}); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(`${request.message}: ${err.message}`, 'User._onChromeMessage'); // eslint-disable-next-line promise/no-nesting _signOut().catch(() =&gt; { // always resolves }); response({message: 'error', error: err.message}); }); } else if (request.message === app.ChromeMsg.SIGN_OUT.message) { // signOut a user - will always sign out ret = true; // async _signOut().then(() =&gt; { response({message: 'ok'}); return Promise.resolve(); }).catch(() =&gt; { // always resolves response({message: 'ok'}); }); } else if (request.message === app.ChromeMsg.FORCE_SIGN_OUT.message) { // force sign out ret = true; // async app.User.forceSignOut().then(() =&gt; { response({message: 'ok'}); return Promise.resolve(); }).catch(() =&gt; { _setSignIn(false); app.Devices.clear(); response({message: 'ok'}); }); } return ret; } /** * Listen for changes to Browser sign-in */ chrome.identity.onSignInChanged.addListener(_onSignInChanged); /** * Listen for Chrome messages */ Chrome.Msg.listen(_onChromeMessage); return { /** * Persist info on current Browser user (may be no-one) * @returns {Promise&lt;void&gt;} void * @memberOf app.User */ setInfo: function() { return chromep.identity.getProfileUserInfo().then((user) =&gt; { Chrome.Storage.set('email', user.email); Chrome.Storage.set('uid', user.id); return Promise.resolve(); }); }, /** * Force signOut without unregistering from App Engine and without * needing OAuth * @param {boolean} [notify=false] if true, post error notification * @param {string} [reason='Unknown Error'] reason for call * @returns {Promise&lt;void&gt;} void * @memberOf app.User */ forceSignOut: function(notify = false, reason = 'Unknown Error') { Chrome.Storage.set('registered', false); return app.Fb.signOut().then(() =&gt; { _setSignIn(false); app.Devices.clear(); Chrome.Log.error(reason, 'User.forceSignOut'); if (notify &amp;&amp; app.Notify.onError()) { let msg = reason; msg += '\\n\\nTry to sign in again. If the problem persists, please ' + 'contact support.'; app.Notify.create(app.Notify.TYPE.ERROR_FORCE_SIGN_OUT, msg, new Chrome.Storage.LastError()); } return _removeAuthToken(); }); }, }; })(); × Search results Close "},"utils.js.html":{"id":"utils.js.html","title":"Source: utils.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: utils.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ window.app = window.app || {}; /** * Misc. utility methods * @namespace */ app.Utils = (function() { 'use strict'; new ExceptionHandler(); const MIN_IN_DAY = 60 * 24; const MILLIS_IN_DAY = MIN_IN_DAY * 60 * 1000; return { /** * Number of minutes in a day * @const * @type {int} * @memberOf app.Utils */ MIN_IN_DAY: MIN_IN_DAY, /** * Number of milliseconds a in day * @const * @type {int} * @memberOf app.Utils */ MILLIS_IN_DAY: MILLIS_IN_DAY, /** * Get our email address * @returns {string} * @memberOf app.Utils */ getEmail: function() { return 'pushyclipboard@gmail.com'; }, /** * Get our Github base path * @returns {string} * @memberOf app.Utils */ getGithubPath: function() { return 'https://github.com/Pushy-Clipboard/pushy-chrome-extension/'; }, /** * Get our Github pages base path * @returns {string} * @memberOf app.Utils */ getGithubPagesPath: function() { return 'https://pushy-clipboard.github.io/'; }, /** * Get body for an email with basic extension info * @returns {string} text * @memberOf app.Utils */ getEmailBody: function() { return `Extension version: ${Chrome.Utils.getVersion()}\\n` + `Chrome version: ${Chrome.Utils.getFullChromeVersion()}\\n` + `OS: ${Chrome.Storage.get('os')}\\n\\n\\n`; }, /** * Get encoded url for an email * @param {string} subject - email subject * @param {string} body - email body * @returns {string} * @memberOf app.Utils */ getEmailUrl: function(subject, body) { const email = encodeURIComponent(app.Utils.getEmail()); const sub = encodeURIComponent(subject); const bod = encodeURIComponent(body); return `mailto:${email}?subject=${sub}&amp;body=${bod}`; }, /** * Set the badge displayed on the extension icon * @memberOf app.Utils */ setBadgeText: function() { let text = 'SAVE'; if (app.Utils.canSend()) { text = 'SEND'; } chrome.browserAction.setBadgeText({text: text}); }, /** * Send message to the main tab to focus it. If not found, create it * @param {?string} [route='page-main'] - the page to route to * @memberOf app.Utils */ showMainTab: function(route = 'page-main') { // send message to the main tab to focus it. const msg = Chrome.JSONUtils.shallowCopy(Chrome.Msg.HIGHLIGHT); msg.item = route; Chrome.Msg.send(msg).catch(() =&gt; { // no one listening, create it chrome.tabs.create({url: '../html/main.html'}); }); }, /** * Get a date string in time ago format * @param {int} time - time since epoch in millis * @returns {string} * @memberOf app.Utils */ getRelativeTime: function(time) { return `${moment(time).fromNow()}, ` + `${moment(time).format('h:mm a')}`; }, /** * Should we show the favorites at the top of the list * @returns {boolean} * @memberOf app.Utils */ isPinFavs: function() { return Chrome.Storage.getBool('pinFavs'); }, /** * Are we saving clipboard contents * @returns {boolean} * @memberOf app.Utils */ isMonitorClipboard: function() { return Chrome.Storage.getBool('monitorClipboard'); }, /** * Has user enabled pushing to {@link app.Devices} * @returns {boolean} * @memberOf app.Utils */ allowPush: function() { return Chrome.Storage.getBool('allowPush'); }, /** * Has user enabled autoSend option * @returns {boolean} * @memberOf app.Utils */ isAutoSend: function() { return Chrome.Storage.getBool('autoSend'); }, /** * Has user enabled receiving from {@link app.Devices} * @returns {boolean} * @memberOf app.Utils */ allowReceive: function() { return Chrome.Storage.getBool('allowReceive'); }, /** * Are we signed in * @returns {boolean} true if signed in * @memberOf app.Utils */ isSignedIn: function() { return Chrome.Storage.getBool('signedIn'); }, /** * Are we registered with fcm * @returns {boolean} true if registered * @memberOf app.Utils */ isRegistered: function() { return Chrome.Storage.getBool('registered'); }, /** * Are we not registered with fcm * @returns {boolean} true if not registered * @memberOf app.Utils */ notRegistered: function() { return !this.isRegistered(); }, /** * Has user allowed backup of data to Google Drive * @returns {boolean} * @memberOf app.Utils */ allowBackup: function() { return Chrome.Storage.getBool('backup'); }, /** * Can we send messages to our devices * @returns {boolean} * @memberOf app.Utils */ canSend: function() { return app.Utils.isSignedIn() &amp;&amp; app.Utils.allowPush(); }, }; })(); × Search results Close "},"background_background.js.html":{"id":"background_background.js.html","title":"Source: background/background.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/background.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * The background script for the extension.&lt;br&gt; * Note: We can't be an Event Page because we use * the chrome.webRequest API * @namespace Background */ new ExceptionHandler(); /** * Event: Fired when the extension is first installed,&lt;br /&gt; * when the extension is updated to a new version,&lt;br /&gt; * and when Chrome is updated to a new version. * @see https://developer.chrome.com/extensions/runtime#event-onInstalled * @param {Object} details - type of event * @param {string} details.reason - reason for install * @param {string} details.previousVersion - old version if 'update' reason * @private * @memberOf Background */ function _onInstalled(details) { if (details.reason === 'install') { // extension installed Chrome.GA.event(Chrome.GA.EVENT.INSTALLED); // save OS Chrome.Utils.getPlatformOS().then((os) =&gt; { Chrome.Storage.set('os', os); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Background._onInstalled'); }); app.Data.initialize().then(() =&gt; { app.Utils.showMainTab(); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Background._onInstalled'); app.Utils.showMainTab(); }); } else if (details.reason === 'update') { if (!Chrome.Utils.DEBUG) { if (Chrome.Utils.getVersion() === details.previousVersion) { // spurious update: // https://bugs.chromium.org/p/chromium/issues/detail?id=303481 return; } } app.Data.update(); _initializeFirebase().then(() =&gt; { return app.SW.update(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Background._onInstalled'); }); } app.Utils.setBadgeText(); app.Alarm.updateAlarms(); app.Permissions.injectContentScripts(); } /** * Event: Fired when a profile that has this extension installed first * starts up * @see https://developer.chrome.com/extensions/runtime#event-onStartup * @private * @memberOf Background */ function _onStartup() { Chrome.GA.page('/background.html'); app.Alarm.updateAlarms(); app.Alarm.deleteOldClipItems(); _initializeFirebase().catch((err) =&gt; { Chrome.Log.error(err.message, 'Background._onStartup'); }); app.Utils.setBadgeText(); } /** * Event: Fired when a browser action icon is clicked. * @see https://goo.gl/abVwKu * @private * @memberOf Background */ function _onIconClicked() { // get the clipboard contents const text = app.CB.getTextFromClipboard(); // Persist let addOK = false; app.ClipItem.add(text, Date.now(), false, false, app.Device.myName(), true).then((clipItem) =&gt; { addOK = true; return app.Msg.sendClipItem(clipItem); }).catch((err) =&gt; { if (addOK) { app.Msg.sendFailed(err); } else { const msg = err.message; if (msg !== app.ClipItem.ERROR_EMPTY_TEXT) { Chrome.Log.error(msg, 'Background._onIconClicked'); } if (app.Notify.onError()) { app.Notify.create(app.Notify.TYPE.ERROR_STORE_CLIP, msg, new Chrome.Storage.LastError()); } } }); } /** * Event: Fired when a tab is updated. * @see https://developer.chrome.com/extensions/tabs#event-onUpdated * @param {int} tabId - id of tab * @private * @memberOf Background */ function _onTabUpdated(tabId) { app.Permissions.injectContentScript(tabId); } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - storage item that changed * @private * @memberOf Background */ function _onStorageChanged(event) { if ((event.key === 'allowPush') || (event.key === 'signedIn')) { app.Utils.setBadgeText(); if ((event.key === 'allowPush') &amp;&amp; app.Utils.allowPush()) { // reset no device error count Chrome.Storage.set('noDevicesCt', 0); } } } /** * Event: document and resources loaded * @private * @memberOf Background */ function _onLoad() { // Listen for extension install or update chrome.runtime.onInstalled.addListener(_onInstalled); // Listen for Chrome starting chrome.runtime.onStartup.addListener(_onStartup); // Listen for click on the icon chrome.browserAction.onClicked.addListener(_onIconClicked); // Listen for tab updates chrome.tabs.onUpdated.addListener(_onTabUpdated); // Listen for changes to localStorage addEventListener('storage', _onStorageChanged, false); } /** * Initialize firebase and Service Worker if signed in * @returns {Promise&lt;void&gt;} void * @private * @memberOf Background */ function _initializeFirebase() { if (!app.Utils.isSignedIn()) { return Promise.resolve(); } return app.SW.initialize().then(() =&gt; { return app.SW.cantReceive(); }).then((cantReceive) =&gt; { if (app.Utils.allowReceive() &amp;&amp; cantReceive) { // can't receive messages anymore even though we want to. return app.User.forceSignOut(true, cantReceive); } return Promise.resolve(); }); } // Listen for document and resources loaded addEventListener('load', _onLoad); })(); × Search results Close "},"scripts_auth.js.html":{"id":"scripts_auth.js.html","title":"Source: scripts/auth.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/auth.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Google authorization utilities * @see https://developer.chrome.com/apps/identity * @namespace */ Chrome.Auth = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); return { /** * Get our OAuth2.0 token * @param {boolean} interactive - if true may block * @returns {Promise&lt;string&gt;} An access token * @memberOf Chrome.Auth */ getToken: function(interactive = false) { return chromep.identity.getAuthToken({ 'interactive': interactive, }).then((token) =&gt; { return Promise.resolve(token); }); }, /** * Remove our cached auth token * @param {string|null} [curToken=null] token to remove * @returns {Promise.&lt;string&gt;} the old token */ removeCachedToken: function(curToken = null) { let oldToken = null; if (curToken === null) { return this.getToken(false).then((token) =&gt; { oldToken = token; return chromep.identity.removeCachedAuthToken({'token': token}); }).then(() =&gt; { return Promise.resolve(oldToken); }); } else { oldToken = curToken; return chromep.identity.removeCachedAuthToken({ 'token': curToken, }).then(() =&gt; { return Promise.resolve(oldToken); }); } }, }; })(); × Search results Close "},"scripts_analytics.js.html":{"id":"scripts_analytics.js.html","title":"Source: scripts/analytics.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/analytics.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Google Analytics tracking * @namespace */ Chrome.GA = (function() { 'use strict'; /** * Google Analytics Event * @typedef {Object} Chrome.GA.Event * @property {string} eventCategory - category * @property {string} eventAction - action * @property {string} eventLabel - label * @memberOf Chrome.GA */ /** * Event: called when document and resources are loaded&lt;br /&gt; * Initialize Google Analytics * @private * @memberOf Chrome.GA */ function _onLoad() { // Standard Google Universal Analytics code // noinspection OverlyComplexFunctionJS (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; // noinspection CommaExpressionJS i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }, i[r].l = 1 * new Date(); // noinspection CommaExpressionJS a = s.createElement(o), m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga'); } // listen for document and resources loaded window.addEventListener('load', _onLoad); /** * Event types * @type {{}} * @property {Chrome.GA.Event} INSTALLED - extension installed * @property {Chrome.GA.Event} UPDATED - extension updated * @property {Chrome.GA.Event} MENU - menu selected * @property {Chrome.GA.Event} TOGGLE - setting-toggle * @property {Chrome.GA.Event} LINK - setting-link * @property {Chrome.GA.Event} TEXT - setting-text * @property {Chrome.GA.Event} BUTTON - button click * @property {Chrome.GA.Event} ICON - toolbar icon click * @property {Chrome.GA.Event} CHECK - checkbox click * @property {Chrome.GA.Event} KEY_COMMAND - keyboard shortcut * @const * @memberOf Chrome.GA */ const _EVENT = { INSTALLED: { eventCategory: 'extension', eventAction: 'installed', eventLabel: '', }, UPDATED: { eventCategory: 'extension', eventAction: 'updated', eventLabel: '', }, MENU: { eventCategory: 'ui', eventAction: 'menuSelect', eventLabel: '', }, TOGGLE: { eventCategory: 'ui', eventAction: 'toggle', eventLabel: '', }, LINK: { eventCategory: 'ui', eventAction: 'linkSelect', eventLabel: '', }, TEXT: { eventCategory: 'ui', eventAction: 'textChanged', eventLabel: '', }, BUTTON: { eventCategory: 'ui', eventAction: 'buttonClicked', eventLabel: '', }, ICON: { eventCategory: 'ui', eventAction: 'toolbarIconClicked', eventLabel: '', }, CHECK: { eventCategory: 'ui', eventAction: 'checkBoxClicked', eventLabel: '', }, KEY_COMMAND: { eventCategory: 'ui', eventAction: 'keyCommand', eventLabel: '', }, }; return { EVENT: _EVENT, /** * Initialize analytics * @param {string} trackingId - tracking id * @param {string} appName - extension name * @param {string} appId - extension Id * @param {string} appVersion - extension version * @memberOf Chrome.GA */ initialize: function(trackingId, appName, appId, appVersion) { ga('create', trackingId, 'auto'); // see: http://stackoverflow.com/a/22152353/1958200 ga('set', 'checkProtocolTask', function() { }); ga('set', 'appName', appName); ga('set', 'appId', appId); ga('set', 'appVersion', appVersion); ga('require', 'displayfeatures'); }, /** * Send a page * @param {string} page - page path * @memberOf Chrome.GA */ page: function(page) { if (page) { if (!Chrome.Utils.DEBUG) { ga('send', 'pageview', page); } } }, /** * Send an event * @param {Chrome.GA.Event} event - the event type * @param {?string} [label=null] - override label * @param {?string} [action=null] - override action * @memberOf Chrome.GA */ event: function(event, label = null, action = null) { if (event) { const ev = Chrome.JSONUtils.shallowCopy(event); ev.hitType = 'event'; ev.eventLabel = label ? label : ev.eventLabel; ev.eventAction = action ? action : ev.eventAction; if (!Chrome.Utils.DEBUG) { ga('send', ev); } else { // eslint-disable-next-line no-console console.log(ev); } } }, /** * Send an error * @param {?string} [label='unknown'] - override label * @param {?string} [action='unknownMethod'] - override action * @memberOf Chrome.GA */ error: function(label = 'unknown', action = 'unknownMethod') { const ev = { hitType: 'event', eventCategory: 'error', eventAction: action, eventLabel: `Err: ${label}`, }; if (!Chrome.Utils.DEBUG) { ga('send', ev); } else { console.error(ev); } }, /** * Send an exception * @param {Object} exception - the exception * @param {?string} [message=null] - the error message * @param {boolean} [fatal=true] - true if fatal * @memberOf Chrome.GA */ exception: function(exception, message = null, fatal = false) { try { let msg = 'Unknown'; if (message) { msg = message; } else if (exception.message) { msg = exception.message; } if (exception.stack) { msg += `\\n\\n${exception.stack}`; } const ex = { hitType: 'exception', exDescription: msg, exFatal: fatal, }; if (!Chrome.Utils.DEBUG) { ga('send', ex); } else { console.error(ex); } } catch (err) { Chrome.Utils.noop(); } }, }; })(); × Search results Close "},"scripts_http.js.html":{"id":"scripts_http.js.html","title":"Source: scripts/http.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/http.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Fetch with authentication and exponential back-off * @namespace */ Chrome.Http = (function() { 'use strict'; new ExceptionHandler(); /** * Http configuration * @typedef {?{}} Chrome.Http.Config * @property {boolean} [isAuth=false] - if true, authorization required * @property {boolean} [retryToken=false] - if true, retry with new token * @property {boolean} [interactive=false] - user initiated, if true * @property {?string} [token=null] - auth token * @property {boolean} [backoff=true] - if true, do exponential back-off * @property {int} [maxRetries=_MAX_ATTEMPTS] - max retries * @memberOf Chrome.Http */ /** * Http response * @typedef {{}} Chrome.Http.Response * @property {boolean} ok - success flag * @property {Function} json - returned data as JSON * @property {int} status - HTTP response code * @property {string} statusText - HTTP response message * @memberOf Chrome.Http */ /** * Authorization header * @type {string} * @private * @memberOf Chrome.Http */ const _AUTH_HEADER = 'Authorization'; /** * Bearer parameter for authorized call * @type {string} * @private * @memberOf Chrome.Http */ const _BEARER = 'Bearer'; /** * Max retries on 500 errors * @type {int} * @private * @memberOf Chrome.Http */ const _MAX_RETRIES = 4; /** * Delay multiplier for exponential back-off * @const * @private * @memberOf Chrome.Http */ const _DELAY = 1000; /** * Configuration object * @type {Chrome.Http.Config} * @private * @memberOf Chrome.Http */ const _CONFIG = { isAuth: false, retryToken: false, interactive: false, token: null, backoff: true, maxRetries: _MAX_RETRIES, }; /** * Check response and act accordingly * @param {Chrome.Http.Response} response - server response * @param {string} url - server * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _processResponse(response, url, opts, conf, attempt) { if (response.ok) { // request succeeded - woo hoo! return response.json(); } if (attempt &gt;= conf.maxRetries) { // request still failed after maxRetries return Promise.reject(_getError(response)); } const status = response.status; if (conf.backoff &amp;&amp; (status &gt;= 500) &amp;&amp; (status &lt; 600)) { // temporary server error, maybe. Retry with backoff return _retry(url, opts, conf, attempt); } if (conf.isAuth &amp;&amp; conf.token &amp;&amp; conf.retryToken &amp;&amp; (status === 401)) { // could be expired token. Remove cached one and try again return _retryToken(url, opts, conf, attempt); } if (conf.isAuth &amp;&amp; conf.interactive &amp;&amp; conf.token &amp;&amp; conf.retryToken &amp;&amp; (status === 403)) { // user may have revoked access to extension at some point // If interactive, retry so they can authorize again return _retryToken(url, opts, conf, attempt); } // request failed return Promise.reject(_getError(response)); } /** * Get Error message * @param {Chrome.Http.Response} response - server response * @returns {Error} * @private * @memberOf Chrome.Http */ function _getError(response) { let msg = 'Unknown error.'; if (response &amp;&amp; response.status &amp;&amp; (typeof(response.statusText) !== 'undefined')) { let statusMsg = Chrome.Locale.localize('err_status'); if ((typeof(statusMsg) === 'undefined') || (statusMsg === '')) { // in case localize is missing statusMsg = 'Status'; } msg = `${statusMsg}: ${response.status}`; msg += `\\n${response.statusText}`; } return new Error(msg); } /** * Get authorization token * @param {boolean} isAuth - if true, authorization required * @param {boolean} interactive - if true, user initiated * @returns {Promise.&lt;string&gt;} auth token * @private * @memberOf Chrome.Http */ function _getAuthToken(isAuth, interactive) { if (isAuth) { return Chrome.Auth.getToken(interactive).then((token) =&gt; { return Promise.resolve(token); }).catch((err) =&gt; { if (interactive &amp;&amp; (err.message.includes('revoked') || err.message.includes('Authorization page could not be loaded'))) { // try one more time non-interactively // Always returns Authorization page error // when first registering, Not sure why // Other message is if user revoked access to extension return Chrome.Auth.getToken(false); } else { return Promise.reject(err); } }); } else { // non-authorization branch return Promise.resolve(null); } } /** * Retry authorized fetch with exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _retry(url, opts, conf, attempt) { attempt++; // eslint-disable-next-line promise/avoid-new return new Promise((resolve, reject) =&gt; { const delay = (Math.pow(2, attempt) - 1) * _DELAY; setTimeout(() =&gt; { return _fetch(url, opts, conf, attempt).then(resolve, reject); }, delay); }); } /** * Retry fetch after removing cached auth token * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _retryToken(url, opts, conf, attempt) { Chrome.GA.error('Refreshed auth token.', 'Http._retryToken'); return Chrome.Auth.removeCachedToken(conf.token).then(() =&gt; { conf.token = null; conf.retryToken = false; return _fetch(url, opts, conf, attempt); }); } /** * Perform fetch, optionally using authorization and exponential back-off * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @param {int} attempt - the retry attempt we are on * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _fetch(url, opts, conf, attempt) { return _getAuthToken(conf.isAuth, conf.interactive).then((authToken) =&gt; { if (conf.isAuth) { conf.token = authToken; opts.headers.set(_AUTH_HEADER, `${_BEARER} ${conf.token}`); } return fetch(url, opts); }).then((response) =&gt; { return _processResponse(response, url, opts, conf, attempt); }).catch((err) =&gt; { let msg = err.message; if (msg === 'Failed to fetch') { msg = Chrome.Locale.localize('err_network'); if ((typeof(msg) === 'undefined') || (msg === '')) { // in case localize is missing msg = 'Network error'; } } return Promise.reject(new Error(msg)); }); } /** * Do a server request * @param {string} url - server request * @param {Object} opts - fetch options * @param {Chrome.Http.Config} conf - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @private * @memberOf Chrome.Http */ function _doIt(url, opts, conf) { conf = (conf === null) ? _CONFIG : conf; if (conf.isAuth) { opts.headers.set(_AUTH_HEADER, `${_BEARER} unknown`); } let attempt = 0; return _fetch(url, opts, conf, attempt); } return { conf: _CONFIG, /** * Perform GET request * @param {string} url - server request * @param {Chrome.Http.Config} [conf=null] - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @memberOf Chrome.Http */ doGet: function(url, conf = null) { const opts = {method: 'GET', headers: new Headers({})}; return _doIt(url, opts, conf); }, /** * Perform POST request * @param {string} url - server request * @param {Chrome.Http.Config} [conf=null] - configuration * @returns {Promise.&lt;JSON&gt;} response from server * @memberOf Chrome.Http */ doPost: function(url, conf = null) { const opts = {method: 'POST', headers: new Headers({})}; return _doIt(url, opts, conf); }, }; })(window); × Search results Close "},"scripts_json.js.html":{"id":"scripts_json.js.html","title":"Source: scripts/json.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/json.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * JSON utilities * @namespace */ Chrome.JSONUtils = (function() { 'use strict'; new ExceptionHandler(); return { /** * Parse JSON, with exception handling * @param {!string} jsonString - string to parse * @returns {?JSON} JSON Object, null on error * @memberOf Chrome.JSONUtils */ parse: function(jsonString) { let ret = null; try { ret = JSON.parse(jsonString); } catch (err) { Chrome.GA.exception(`Caught: JSONUtils.parse: ${err.message}`, err.stack, false); } return ret; }, /** * Return shallow copy of Object * @param {!Object} object - object to copy * @returns {?JSON} JSON Object, null on error * @memberOf Chrome.JSONUtils */ shallowCopy: function(object) { let ret = null; const jsonString = JSON.stringify(object); if (typeof(jsonString) !== 'undefined') { ret = Chrome.JSONUtils.parse(jsonString); } return ret; }, }; })(); × Search results Close "},"scripts_locales.js.html":{"id":"scripts_locales.js.html","title":"Source: scripts/locales.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/locales.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Locale methods * @see https://developer.chrome.com/extensions/i18n * @namespace */ Chrome.Locale = (function() { 'use strict'; new ExceptionHandler(); return { /** * Get the i18n string * @param {string} messageName - key in messages.json * @returns {string} internationalized string * @memberOf Chrome.Locale */ localize: function(messageName) { return chrome.i18n.getMessage(messageName); }, /** * Get the current locale * @returns {string} current locale e.g. en_US * @memberOf Chrome.Locale */ getLocale: function() { return chrome.i18n.getMessage('@@ui_locale'); }, }; })(); × Search results Close "},"localize-behavior_localize-behavior.js.html":{"id":"localize-behavior_localize-behavior.js.html","title":"Source: localize-behavior/localize-behavior.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: localize-behavior/localize-behavior.js 'use strict'; window.Chrome = window.Chrome || {}; /** * Behavior for internationalizing strings * @polymerBehavior Chrome.LocalizeBehavior */ Chrome.LocalizeBehavior = { properties: { /** * Get a string */ localize: { type: Function, value: function() { return function() { const messageName = arguments[0]; return Chrome.Locale.localize(messageName); }; }, }, }, }; × Search results Close "},"scripts_log.js.html":{"id":"scripts_log.js.html","title":"Source: scripts/log.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/log.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Log a message. Will also store the LastError to local storage as 'lastError' * @namespace */ Chrome.Log = (function() { 'use strict'; return { /** * Log an error * @param {?string} [message='unknown'] - override label * @param {?string} [method='unknownMethod'] - override action * @param {?string} [title=null] - a title for the error * @memberOf Chrome.Log */ error: function(message = 'unknown', method = 'unknownMethod', title = null) { const theTitle = title ? title : 'An error occurred'; Chrome.Storage.setLastError( new Chrome.Storage.LastError(message, theTitle)); Chrome.GA.error(message, method); }, /** * Log an exception * @param {Object} exception - the exception * @param {?string} [message=null] - the error message * @param {boolean} [fatal=true] - true if fatal * @param {?string} [title='An exception was caught'] * - a title for the error * @memberOf Chrome.Log */ exception: function(exception, message = null, fatal = false, title='An exception was caught') { try { Chrome.Storage.setLastError( new Chrome.Storage.LastError(message, title)); Chrome.GA.exception(exception, message, fatal); } catch (err) { Chrome.Utils.noop(); } }, }; })(); × Search results Close "},"scripts_msg.js.html":{"id":"scripts_msg.js.html","title":"Source: scripts/msg.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Wrapper for chrome messages * @see https://developer.chrome.com/extensions/messaging * @namespace */ Chrome.Msg = (function() { 'use strict'; new ExceptionHandler(); /** * A Chrome message * @typedef {{}} Chrome.Msg.Message * @property {string} message - Unique name * @property {Error} error - an error * @property {string|Object} item - a message specific item * @property {boolean} updated - item is new or updated * @property {string} key - key name * @property {?Object} value - value of key * @memberOf Chrome.Msg */ /** * Chrome Messages * @type {{}} * @property {Chrome.Msg.Message} HIGHLIGHT - highlight a tab * @property {Chrome.Msg.Message} RESTORE_DEFAULTS - restore default settings * @property {Chrome.Msg.Message} STORAGE_EXCEEDED - local storage save failed * @property {Chrome.Msg.Message} STORE - save value to storage * @const * @private * @memberOf Chrome.Msg */ const _MSG = { HIGHLIGHT: { message: 'highlightTab', }, RESTORE_DEFAULTS: { message: 'restoreDefaults', }, STORAGE_EXCEEDED: { message: 'storageExceeded', }, STORE: { message: 'store', key: '', value: '', }, }; return { HIGHLIGHT: _MSG.HIGHLIGHT, RESTORE_DEFAULTS: _MSG.RESTORE_DEFAULTS, STORAGE_EXCEEDED: _MSG.STORAGE_EXCEEDED, STORE: _MSG.STORE, /** * Send a chrome message * @param {Chrome.Msg.Message} type - type of message * @returns {Promise&lt;JSON&gt;} response JSON * @memberOf Chrome.Msg */ send: function(type) { const chromep = new ChromePromise(); return chromep.runtime.sendMessage(type, null).then((response) =&gt; { return Promise.resolve(response); }).catch((err) =&gt; { if (err.message &amp;&amp; !err.message.includes('port closed') &amp;&amp; !err.message.includes('Receiving end does not exist')) { const msg = `type: ${type.message}, ${err.message}`; Chrome.GA.error(msg, 'Msg.send'); } return Promise.reject(err); }); }, /** * Add a listener for chrome messages * @param {Function} listener - function to receive messages * @memberOf Chrome.Msg */ listen: function(listener) { chrome.runtime.onMessage.addListener(listener); }, }; })(); × Search results Close "},"scripts_storage.js.html":{"id":"scripts_storage.js.html","title":"Source: scripts/storage.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/storage.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Manage items in localStorage * @namespace */ Chrome.Storage = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); return { /** * Get a JSON parsed value from localStorage * @param {!string} key - key to get value for * @param {?Object} [def=null] - return value if key not found * @returns {?Object} JSON object, null if key does not exist * @memberOf Chrome.Storage */ get: function(key, def = null) { let value = def; let item = localStorage.getItem(key); if (item !== null) { value = Chrome.JSONUtils.parse(item); } return value; }, /** * Get integer value from localStorage * @param {!string} key - key to get value for * @param {?int} [def=null] - optional value to return, if NaN * @returns {int} value as integer, NaN on error * @memberOf Chrome.Storage */ getInt: function(key, def = null) { let item = localStorage.getItem(key); let value = parseInt(item, 10); if (Number.isNaN(value)) { value = (def === null) ? value : def; if (def === null) { Chrome.GA.error(`NaN value for: ${key} equals ${item}`, 'Storage.getInt'); } } return value; }, /** * Get boolean value from localStorage * @param {!string} key - key to get value for * @param {?boolean} [def=null] - return value if key not found * @returns {?boolean} value as boolean, null if key does not exist * @memberOf Chrome.Storage */ getBool: function(key, def = null) { return Chrome.Storage.get(key, def); }, /** * JSON stringify and save a value to localStorage * @param {!string} key - key to set value for * @param {?Object} [value=null] - new value, if null remove item * @memberOf Chrome.Storage */ set: function(key, value = null) { if (value === null) { localStorage.removeItem(key); } else { const val = JSON.stringify(value); localStorage.setItem(key, val); } }, /** * Save a value to localStorage only if there is enough room * @param {!string} key - localStorage Key * @param {Object} value - value to save * @param {string} [keyBool] - key to a boolean value * that is true if the primary key has non-empty value * @returns {boolean} true if value was set successfully * @memberOf Chrome.Storage */ safeSet: function(key, value, keyBool) { let ret = true; const oldValue = Chrome.Storage.get(key); try { Chrome.Storage.set(key, value); } catch (e) { ret = false; if (oldValue) { // revert to old value Chrome.Storage.set(key, oldValue); } if (keyBool) { // revert to old value if (oldValue &amp;&amp; oldValue.length) { Chrome.Storage.set(keyBool, true); } else { Chrome.Storage.set(keyBool, false); } } // notify listeners Chrome.Msg.send(Chrome.Msg.STORAGE_EXCEEDED).catch(() =&gt; { }); } return ret; }, /** * An error that can be persisted * Usage: const err = new LastError(message, title) * @param {?string} [message=''] - the message * @param {?string} [title='An error occurred'] - the title * @property {string} name - Error name * @property {string} stack - stack trace * @memberOf Chrome.Storage */ LastError: function(message = '', title = 'An error occurred') { this.name = 'LastError'; this.message = message; this.title = title; this.stack = (new Error).stack; Chrome.Storage.LastError.prototype = Object.create(Error.prototype); Chrome.Storage.LastError.prototype.constructor = Chrome.Storage.LastError; }, /** * Get the LastError from chrome.storage.local * @returns {Promise&lt;Chrome.Msg.LastError&gt;} last error * @memberOf Chrome.Storage */ getLastError: function() { return chromep.storage.local.get('lastError').then((values) =&gt; { if (values.lastError) { return Promise.resolve(values.lastError); } return new Chrome.Storage.LastError(); }); }, /** * Save the LastError to chrome.storage.local * @see https://developer.chrome.com/apps/storage * @param {Chrome.Storage.LastError} error - the LastError * @returns {Promise&lt;void&gt;} void * @memberOf Chrome.Storage */ setLastError: function(error) { // Save it using the Chrome storage API. return chromep.storage.local.set({'lastError': error}); }, /** * Set the LastError to an empty message in chrome.storage.local * @returns {Promise&lt;void&gt;} void * @memberOf Chrome.Storage */ clearLastError: function() { return Chrome.Storage.setLastError(new Chrome.Storage.LastError()); }, }; })(); × Search results Close "},"scripts_time.js.html":{"id":"scripts_time.js.html","title":"Source: scripts/time.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/time.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ { 'use strict'; new ExceptionHandler(); window.Chrome = window.Chrome || {}; /** * Time Class * @property {int} _hr - 24 hour time * @property {int} _min - minutes * @alias Chrome.Time */ Chrome.Time = class Time { /** * Create a new Time * @param {?string} [timeString=null] - in '00:00' format, if null * use current Date * @constructor */ constructor(timeString = null) { this._parse(timeString); } /** * Minutes in day * @returns {int} value * @static */ static get MIN_IN_DAY() { return 60 * 24; } /** * Milliseconds in day * @returns {int} value * @static */ static get MSEC_IN_DAY() { return Chrome.Time.MIN_IN_DAY * 60 * 1000; } /** * Determine if user wants 24 hr time * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {boolean} true for 24 hour time * @private * @static */ static _is24Hr(frmt = null) { let ret = false; let format = Chrome.Storage.getInt('showTime', 0); if (frmt !== null) { format = frmt; } const localeTime = Chrome.Locale.localize('time_format'); if (format === 2) { // time display 24hr ret = true; } else if ((format === 0) &amp;&amp; (localeTime === '24')) { // time display off, locale time 24 ret = true; } return ret; } /** * Convert string to current time * @param {!string} timeString - in '00:00' format * @returns {int} time in milliSeconds from epoch * @static */ static getTime(timeString) { const date = new Date(); const time = new Time(timeString); date.setHours(time._hr); date.setMinutes(time._min); date.setSeconds(0); date.setMilliseconds(0); return date.getTime(); } /** * Calculate time delta from now on a 24hr basis * @param {string} timeString - in '00:00' format * @returns {int} time delta in minutes * @static */ static getTimeDelta(timeString) { const curTime = Date.now(); const time = Chrome.Time.getTime(timeString); let delayMin = (time - curTime) / 1000 / 60; if (delayMin &lt; 0) { delayMin = Chrome.Time.MIN_IN_DAY + delayMin; } return delayMin; } /** * Determine if current time is between start and stop, inclusive * @param {string} start - in '00:00' format * @param {string} stop - in '00:00' format * @returns {boolean} true if in the given range * @static */ static isInRange(start, stop) { const curTime = Date.now(); const startTime = Chrome.Time.getTime(start); const stopTime = Chrome.Time.getTime(stop); let ret = false; if (start === stop) { ret = true; } else if (stopTime &gt; startTime) { if ((curTime &gt;= startTime) &amp;&amp; (curTime &lt;= stopTime)) { ret = true; } } else { if ((curTime &gt;= startTime) || (curTime &lt;= stopTime)) { ret = true; } } return ret; } /** * Get time as string suitable for display, including AM/PM if 12hr * @param {!string} timeString - in '00:00' format * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {!string} display string * @static */ static getStringFull(timeString, frmt = null) { const time = new Time(timeString); return time.toString(frmt); } /** * Get current time suitable for display w/o AM/PM if 12hr * @returns {!string} display string * @static */ static getStringShort() { const time = new Time(); let timeString = time.toString(); // strip off all non-digits but : timeString = timeString.replace(/[^\\d:]/g, ''); // strip off everything after 'xx:xx' timeString = timeString.replace(/(.*?:.*?):.*/g, '$1'); return timeString; } /** * Parse time string * @param {string} timeString - in '00:00' format * @private */ _parse(timeString) { if (timeString === null) { const date = new Date(); this._hr = date.getHours(); this._min = date.getMinutes(); } else { this._hr = parseInt(timeString.substr(0, 2), 10); this._min = parseInt(timeString.substr(3, 2), 10); } } /** * Get string representation of Time * @param {?int} [frmt=null] - optional format, overrides storage value * @returns {string} As string */ toString(frmt = null) { const date = new Date(); date.setHours(this._hr, this._min); date.setSeconds(0); date.setMilliseconds(0); // fallback in case toLocaleTimeString fails - it does sometimes let ret = date.toTimeString(); const languages = []; if (typeof(navigator.language) !== 'undefined') { languages.push(navigator.language); } languages.push('en-US'); const opts = { hour: 'numeric', minute: '2-digit', hour12: !Time._is24Hr(frmt), }; try { ret = date.toLocaleTimeString(languages, opts); } catch (err) { Chrome.Utils.noop(); } return ret; } }; } × Search results Close "},"scripts_utils.js.html":{"id":"scripts_utils.js.html","title":"Source: scripts/utils.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/utils.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ window.Chrome = window.Chrome || {}; /** * Utility methods * @namespace */ Chrome.Utils = (function() { 'use strict'; new ExceptionHandler(); const chromep = new ChromePromise(); /** * Set to true if development build * @type {boolean} * @private * @memberOf Chrome.Utils */ const _DEBUG = false; return { /** * True if development build * @type {boolean} * @memberOf Chrome.Utils */ DEBUG: _DEBUG, /** Get the extension's name * @returns {string} Extension name * @memberOf Chrome.Utils */ getExtensionName: function() { return `chrome-extension://${chrome.runtime.id}`; }, /** * Get the Extension version * @returns {string} Extension version * @memberOf Chrome.Utils */ getVersion: function() { const manifest = chrome.runtime.getManifest(); return manifest.version; }, /** * Get the Chrome version * @see http://stackoverflow.com/a/4900484/4468645 * @returns {int} Chrome major version * @memberOf Chrome.Utils */ getChromeVersion: function() { const raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./); return raw ? parseInt(raw[2], 10) : false; }, /** * Get the full Chrome version * @see https://goo.gl/2ITMNO * @returns {string} Chrome version * @memberOf Chrome.Utils */ getFullChromeVersion: function() { const raw = navigator.userAgent; return raw ? raw : 'Unknown'; }, /** * Get the OS as a human readable string * @returns {Promise.&lt;string&gt;} OS name * @memberOf Chrome.Utils */ getPlatformOS: function() { return chromep.runtime.getPlatformInfo().then((info) =&gt; { let output = 'Unknown'; const os = info.os; switch (os) { case 'win': output = 'MS Windows'; break; case 'mac': output = 'Mac'; break; case 'android': output = 'Android'; break; case 'cros': output = 'Chrome OS'; break; case 'linux': output = 'Linux'; break; case 'openbsd': output = 'OpenBSD'; break; default: break; } return Promise.resolve(output); }); }, /** * Determine if we are MS windows * @returns {Promise.&lt;boolean&gt;} true if MS Windows * @memberOf Chrome.Utils */ isWindows: function() { return chromep.runtime.getPlatformInfo().then((info) =&gt; { return Promise.resolve((info.os === 'win')); }); }, /** * Determine if we are Chrome OS * @returns {Promise.&lt;boolean&gt;} true if ChromeOS * @memberOf Chrome.Utils */ isChromeOS: function() { return chromep.runtime.getPlatformInfo().then((info) =&gt; { return Promise.resolve((info.os === 'cros')); }); }, /** * Determine if we are a Mac * @returns {Promise.&lt;boolean&gt;} true if Mac * @memberOf Chrome.Utils */ isMac: function() { return chromep.runtime.getPlatformInfo().then((info) =&gt; { return Promise.resolve((info.os === 'mac')); }); }, /** * No operation * @memberOf Chrome.Utils */ noop: function() {}, /** * Determine if a String is null or whitespace only * @param {?string} str - string to check * @returns {boolean} true is str is whitespace or null * @memberOf Chrome.Utils */ isWhiteSpace: function(str) { return (!str || str.length === 0 || /^\\s*$/.test(str)); }, /** * Get a random string of the given length * @param {int} [len=8] - length of generated string * @returns {string} a random string * @memberOf Chrome.Utils */ getRandomString: function(len = 8) { const POSS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz0123456789'; let text = ''; for (let i = 0; i &lt; len; i++) { text += POSS.charAt(Math.floor(Math.random() * POSS.length)); } return text; }, /** * Returns a random integer between min and max inclusive * @param {int} min - min value * @param {int} max - max value * @returns {int} random int * @memberOf Chrome.Utils */ getRandomInt: function(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }, /** * Randomly sort an Array in place * Fisher-Yates shuffle algorithm. * @param {Array} array - Array to sort * @memberOf Chrome.Utils */ shuffleArray: function(array) { const len = array ? array.length : 0; for (let i = len - 1; i &gt; 0; i--) { const j = Math.floor(Math.random() * (i + 1)); const temp = array[i]; array[i] = array[j]; array[j] = temp; } }, }; })(); × Search results Close "},"clip_item.js.html":{"id":"clip_item.js.html","title":"Source: clip_item.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: clip_item.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function(window) { 'use strict'; new ExceptionHandler(); /** * Create a new {@link ClipItem} * @constructor * @alias ClipItem * @param {string} text - The text of the clip * @param {int} date - Time in milliSecs from epoch * @param {boolean} fav - true if this has been marked as a favorite * @param {boolean} remote - true if this came from a device other than ours * @param {string} device - A String representing the source device * @param {labelsId[]} [labelsId=[]] - Array of {@Label} PK's * @param {Label[]} [labels=[]] - Array of {@Label} objects * @property {int} _id - database PK */ const ClipItem = function(text, date, fav, remote, device, labelsId = [], labels = []) { this.text = text; this.date = date; this.fav = fav; this.remote = remote; this.device = device; this.labelsId = labelsId; this.labels = labels; }; /** * Error indicating that {@link ClipItem} text is null or all whitespace * @const * @type {string} */ ClipItem.ERROR_EMPTY_TEXT = 'Text is only whitespace'; /** * Error indicating that the database is full * @const * @type {string} */ ClipItem.ERROR_DB_FULL = 'Database is full. Please delete unused items.'; /** * Error indicating there were no non favorites to delete * @const * @type {string} */ ClipItem.ERROR_REMOVE_FAILED = 'Failed to delete item(s).'; /** * Error indicating Label add failed * @const * @type {string} */ ClipItem.ERROR_ADD_LABEL = 'Failed to add Label.'; /** * Error indicating Label remove failed * @const * @type {string} */ ClipItem.ERROR_REMOVE_LABEL = 'Failed to remove Label.'; /** * Error indicating Label id doesn't exist * @const * @type {string} */ ClipItem._ERROR_NO_LABEL = 'Label not found.'; /** * Error indicating ClipItem doesn't exist * @const * @type {string} */ ClipItem._ERROR_NO_CLIP = 'Clip item not found.'; /** * Set our {@link Label} objects * @param {string[]} labelNames - names of labels * @returns {Promise&lt;int&gt;} our database PK */ ClipItem.prototype.setLabels = function(labelNames) { labelNames = labelNames || []; return app.Label.loadAll().then((labels) =&gt; { labels = labels || []; this._clearLabels(); labels.forEach((label) =&gt; { if (labelNames.includes(label.name)) { this._addLabel(label); } }); return this.save(); }); }; /** * Set our {@link Label} objects * @param {int[]} labelIds - PK of labels * @returns {Promise&lt;int&gt;} our database PK */ ClipItem.prototype.setLabelsById = function(labelIds) { labelIds = labelIds || []; return app.Label.loadAll().then((labels) =&gt; { labels = labels || []; this._clearLabels(); labels.forEach((label) =&gt; { if (labelIds.includes(label._id)) { this._addLabel(label); } }); return this.save(); }); }; /** * Get our label names * @returns {string[]} */ ClipItem.prototype.getLabelNames = function() { const names = []; this.labels.forEach((label) =&gt; { names.push(label.name); }); return names; }; /** * Do we contain a {@link Label} with the given name * @param {?string} name * @returns {boolean} */ ClipItem.prototype.hasLabel = function(name) { if (Chrome.Utils.isWhiteSpace(name)) { return false; } const index = this.labels.findIndex((label) =&gt; { return label.name === name; }); return (index !== -1); }; /** * Add a label * @param {Label} label */ ClipItem.prototype.addLabel = function(label) { label.getId().then((id) =&gt; { if (id) { this._addLabel(label); return this.save(); } return Promise.reject(new Error(ClipItem._ERROR_NO_LABEL)); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipItem.addLabel', ClipItem.ERROR_ADD_LABEL); }); }; /** * Remove a label * @param {Label} label */ ClipItem.prototype.removeLabel = function(label) { label.getId().then((id) =&gt; { if (id) { if (this._removeLabel(label)) { return this.save(); } } return Promise.reject(new Error(ClipItem._ERROR_NO_LABEL)); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipItem.removeLabel', ClipItem.ERROR_REMOVE_LABEL); }); }; /** * Save to the database * @returns {Promise&lt;void&gt;} */ ClipItem.prototype.save = function() { return this._safeSave(); }; /** * Update the database * @param {Object} changes - properties to change * @returns {Promise&lt;int&gt;} number of properties changed */ ClipItem.prototype.update = function(changes) { return app.DB.clips().update(this._id, changes); }; /** * Delete from database * @returns {Promise&lt;void&gt;} */ ClipItem.prototype.delete = function() { return this._getId().then((id) =&gt; { if (id) { return ClipItem.remove([id]); } else { return Promise.resolve(); } }); }; /** * Clear labels - don't save */ ClipItem.prototype._clearLabels = function() { this.labels = []; this.labelsId = []; }; /** * Add a {@label} - don't save * @param {Label} label */ ClipItem.prototype._addLabel = function(label) { const newLabel = new app.Label(label.name); newLabel._id = label._id; this.labels.push(newLabel); this.labelsId.push(newLabel._id); }; /** * Remove a {@link Label} - don't save * @param {int} id - Label PK * @returns {boolean} true if removed */ ClipItem.prototype._removeLabel = function(id) { const index = this.labels.findIndex((lbl) =&gt; { return lbl._id === id; }); if (index !== -1) { const idx = this.labelsId.indexOf(id); if (idx !== -1) { this.labelsId.splice(idx, 1); } else { Chrome.GA.error('Did not find labelsId', 'ClipItem._removeLabel'); } this.labels.splice(index, 1); return true; } return false; }; /** * Add if new or update if existing * @returns {Promise&lt;int&gt;} database PK */ ClipItem.prototype._addOrUpdate = function() { let updated = false; return this._getId().then((id) =&gt; { if (id) { updated = true; this._id = id; return app.DB.clips().update(id, this); } else { return app.DB.clips().add(this); } }).then((id) =&gt; { if (!updated) { this._id = id; } return Promise.resolve(this._id); }); }; /** * Save to the database or delete oldest non favorite if there is no room * @returns {Promise&lt;int&gt;} database PK if saved, nothing otherwise */ ClipItem.prototype._saveOrDeleteOldest = function() { return this._addOrUpdate().catch((err) =&gt; { if (err.name === 'QuotaExceededError') { // failed to save, delete oldest non-fav item return ClipItem._deleteOldest(); } else { // some other error return Promise.reject(err); } }).catch((err) =&gt; { if (err.message === ClipItem.ERROR_REMOVE_FAILED) { // nothing to delete, give up err.message = ClipItem.ERROR_DB_FULL; } return Promise.reject(err); }); }; /** * Save to database, deleting old items if needed * @returns {Promise&lt;void&gt;} */ ClipItem.prototype._safeSave = function() { if (Chrome.Utils.isWhiteSpace(this.text)) { return Promise.reject(new Error(ClipItem.ERROR_EMPTY_TEXT)); } const MAX_DELETES = 100; /** * Repeat function call up to count equals 0 * @param {int} count - track number of calls * @returns {Promise&lt;void&gt;} */ const repeatFunc = ((count) =&gt; { if (count === 0) { return Promise.reject(new Error(ClipItem.ERROR_DB_FULL)); } return this._saveOrDeleteOldest().then(function(key) { if (key) { return Promise.resolve(); } return repeatFunc(count - 1); }).catch((err) =&gt; { console.error(err); return Promise.reject(err); }); }); // perform the save return app.DB.get().transaction('rw', app.DB.clips(), () =&gt; { return repeatFunc(MAX_DELETES); }).then(() =&gt; { return Promise.resolve(); }); }; /** * Get our PK * @returns {Promise&lt;int|null&gt;} database PK or null if text not found */ ClipItem.prototype._getId = function() { return ClipItem.get(this.text).then((clipItem) =&gt; { if (clipItem !== undefined) { return Promise.resolve(clipItem._id); } return Promise.resolve(null); }); }; /** * Get a {@link ClipItem} data from the database * @param {string} text - The text of the clip * @returns {Promise&lt;ClipItem|undefined&gt;} A new {@link ClipItem}, * undefined if not found */ ClipItem.get = function(text) { return app.DB.clips().where('text').equals(text).first(); }; // /** // * Does a {@link ClipItem} with the given text exist in the database // * @param {string} text // * @returns {Promise&lt;boolean&gt;} // * @private // */ // ClipItem.exists = function(text) { // return ClipItem.get(text).then((clipItem) =&gt; { // let ret = true; // if (clipItem === undefined) { // ret = false; // } // return Promise.resolve(ret); // }); // }; /** * Add new {@link ClipItem} to storage * @param {string} text - The text of the clip * @param {int} date - Time in milliSecs from epoch * @param {boolean} fav - true if this has been marked as a favorite * @param {boolean} remote - true if this came from a device other than ours * @param {string} device - A String representing the source device * @param {boolean} [keepState=false] - if true keep labels and fav if true * @returns {Promise&lt;ClipItem&gt;} A new {@link ClipItem} */ ClipItem.add = function(text, date, fav, remote, device, keepState = false) { const clipItem = new ClipItem(text, date, fav, remote, device); if (keepState) { // make sure fav stays true and labels stay return ClipItem.get(text).then((clip) =&gt; { if (clip !== undefined) { if (clip.fav) { clipItem.fav = true; } clipItem.labelsId = clip.labelsId; clipItem.labels = clip.labels; } return clipItem.save(); }).then(() =&gt; { return Promise.resolve(clipItem); }); } else { return clipItem.save().then(() =&gt; { return Promise.resolve(clipItem); }); } }; /** * Add the given {@link ClipItem} objects * @param {ClipItem[]} clipItems * @returns {Promise&lt;void&gt;} */ ClipItem.bulkPut = function(clipItems) { const array = Array.isArray(clipItems) ? clipItems : [clipItems]; return app.DB.get().transaction('rw', app.DB.clips(), () =&gt; { return app.DB.clips().bulkPut(array).catch((err) =&gt; { // some may have failed if the same clipItem text was added again // we'll go ahead and commit the successes Chrome.Log.error(err.message, 'ClipItem.bulkPut', 'Not all deletes were undone'); return Promise.resolve(); }); }); }; /** * Remove the given keys from the database * @param {int|int[]} keys - array of PK's to delete * @returns {Promise&lt;void&gt;} */ ClipItem.remove = function(keys) { const keyArray = Array.isArray(keys) ? keys : [keys]; return app.DB.clips().bulkDelete(keyArray); }; /** * Is the database table empty * @returns {Promise&lt;boolean&gt;} true if no {@link ClipItem} objects */ ClipItem.isTableEmpty = function() { return app.DB.clips().count().then((count) =&gt; { return Promise.resolve(!count); }); }; /** * Get all the {@link ClipItem} objects from storage, sorted from newest to * oldest * @param {?string} [labelName=''] - optional {@link Label} name * to filter on * @returns {Promise&lt;ClipItem[]&gt;} */ ClipItem.loadAll = function(labelName = '') { if (labelName) { const label = new app.Label(labelName); return label.getId().then((id) =&gt; { if (id) { // filter by label return app.DB.clips().where('labelsId').equals(id).reverse(). sortBy('date'); } else { return app.DB.clips().reverse().sortBy('date'); } }); } else { return app.DB.clips().reverse().sortBy('date'); } }; /** * Remove the given {@link Label} PK from all {@link ClipItem} objects * @param {int} labelId - Label PK to delete */ ClipItem.removeLabel = function(labelId) { app.DB.get().transaction('rw', app.DB.clips(), () =&gt; { ClipItem.loadAll().then((clipItems) =&gt; { const changedClipItems = []; clipItems.forEach((clipItem) =&gt; { if (clipItem._removeLabel(labelId)) { changedClipItems.push(clipItem); } }); const promises = []; changedClipItems.forEach((clipItem) =&gt; { promises.push(clipItem.save()); }); return Promise.all(promises); }).catch((err) =&gt; { return Promise.reject(err); }); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipItem.removeLabel', 'Failed to remove label from Clip Items.'); }); }; /** * Update the given {@link Label} name in all {@link ClipItem} objects * @param {string} newName * @param {string} oldName */ ClipItem.updateLabel = function(newName, oldName) { app.DB.get().transaction('rw', app.DB.clips(), () =&gt; { ClipItem.loadAll().then((clipItems) =&gt; { const changedClipItems = []; clipItems.forEach((clipItem) =&gt; { const index = clipItem.labels.findIndex((label) =&gt; { return label.name === oldName; }); if (index !== -1) { clipItem.labels[index].name = newName; changedClipItems.push(clipItem); } }); const promises = []; changedClipItems.forEach((clipItem) =&gt; { promises.push(clipItem.save()); }); return Promise.all(promises); }).catch((err) =&gt; { return Promise.reject(err); }); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipItem.removeLabel', 'Failed to remove label from Clip Items.'); }); }; /** * Delete items older than the storageDuration setting * @returns {Promise&lt;boolean&gt;} true if items were deleted */ ClipItem.deleteOld = function() { const durIndex = Chrome.Storage.getInt('storageDuration', 2); const durations = [ app.Utils.MILLIS_IN_DAY, app.Utils.MILLIS_IN_DAY * 7, app.Utils.MILLIS_IN_DAY * 30, app.Utils.MILLIS_IN_DAY * 365, ]; if (durIndex === 4) { // store forever return Promise.resolve(false); } else { const olderThanTime = Date.now() - durations[durIndex]; return ClipItem._deleteOlderThan(olderThanTime); } }; /** * Delete non-favorite {@link ClipItem} objects older than the given time * @param {int} time - time in millis since epoch * @returns {Promise&lt;boolean&gt;} true if items were deleted * @private */ ClipItem._deleteOlderThan = function(time) { return app.DB.clips().where('date').below(time).filter((clipItem) =&gt; { return !clipItem.fav; }).delete().then((deleteCount) =&gt; { return Promise.resolve(!!deleteCount); }); }; /** * Delete the oldest non favorite * @returns {Promise&lt;void&gt;} */ ClipItem._deleteOldest = function() { let clipItem = null; return ClipItem.loadAll().then((clipItems) =&gt; { let found = false; if (!clipItems) { return Promise.reject(new Error(ClipItem.ERROR_REMOVE_FAILED)); } clipItems.sort((a, b) =&gt; { return a.date - b.date; }); for (let i = 0; i &lt; clipItems.length; i++) { clipItem = clipItems[i]; if (!clipItem.fav) { found = true; break; } } if (found) { return ClipItem.remove(clipItem.text); } else { return Promise.reject(new Error(ClipItem.ERROR_REMOVE_FAILED)); } }).then(() =&gt; { return Promise.resolve(); }); }; window.app = window.app || {}; window.app.ClipItem = ClipItem; })(window); × Search results Close "},"clip-list.js.html":{"id":"clip-list.js.html","title":"Source: clip-list.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: clip-list.js 'use strict'; new ExceptionHandler(); /** * Polymer element to display a list of {@link ClipItem} objects * @namespace ClipList */ Polymer({ is: 'clip-list', properties: { /** * Fired when the selected clip changes * @event selected-clip-change * @memberOf ClipList */ /** * Fired when the label button of a row is tapped * @event row-label-tap * @memberOf ClipList */ /** * Array of {@link ClipItem} objects filtered by {@link labelFilter} * @memberOf ClipList */ clips: { type: Array, value: [], }, /** * Array of selected {@link ClipItem} objects * @memberOf ClipList */ selClips: { type: Array, value: [], }, /** * True if we are showing favorite items at top of list * @memberOf ClipList */ isPinFavs: { type: Boolean, value: false, notify: true, observer: '_pinFavsChanged', }, /** * True if we are only showing favorite items * @memberOf ClipList */ isFavFilter: { type: Boolean, value: false, notify: true, }, /** * {@link Label} name for filtering our items * @type string * @memberOf ClipList */ labelFilter: { type: String, value: null, notify: true, }, /** * True if we are performing an operation on multiple clips * @memberOf ClipList */ isBulkOp: { type: Boolean, value: false, notify: true, observer: '_bulkOpChanged', }, }, /** * Element is ready * @memberOf ClipList */ ready: function() { this.addEventListener('focus', this._onFocused.bind(this), true); }, /** * Event: iron-list got focus * @param {Event} event * @param {ClipItem} event.model.clip * @private * @memberOf ClipList */ _onFocused: function(event) { // !?Important prevent iron-list from handling event.stopPropagation(); }, /** * Load the {@link ClipItem} objects * @param {boolean} [isSelectFirst=true] - if true select first item * @returns {Promise&lt;void&gt;} * @memberOf ClipList */ loadClipItems: function(isSelectFirst = true) { this._deleteAllClipItems(); this.deselectAll(); return app.ClipItem.loadAll(this.labelFilter).then((clipItems) =&gt; { // populate list if (this.isFavFilter) { // favorites only const favClipItems = clipItems.filter((clipItem) =&gt; { return clipItem.fav; }); this.push('clips', ...favClipItems); } else { this.push('clips', ...clipItems); } this._sortClipItems(); if (isSelectFirst) { this.selectFirst(); } return Promise.resolve(); }); }, /** * Add a {@link ClipItem} to the list * @param {string} text - ClipItem text * @private * @memberOf ClipList */ addClipItem: function(text) { app.ClipItem.get(text).then((clipItem) =&gt; { if (this._getClipPos(clipItem.text) === -1) { if (!this.labelFilter || clipItem.hasLabel(this.labelFilter)) { // add to list if not filtering or has our labelFilter if (this.isBulkOp) { this.clips.unshift(clipItem); } else { this.unshift('clips', clipItem); this._sortClipItems(); } } } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipList._addClipItem', 'Failed to add clip item'); }); }, /** * Update a {@link ClipItem} in the list * @param {string} text - ClipItem text * @param {Object} mods - key/value pairs of changes * @private * @memberOf ClipList */ updateClipItem: function(text, mods) { const pos = this._getClipPos(text); if (pos === -1) { return; } const clipItem = this.clips[pos]; let needsSort = false; for (const key of Object.keys(mods)) { // check if props that affect sort changed if (key === 'fav') { if (this.isPinFavs &amp;&amp; (mods[key] !== clipItem.fav)) { needsSort = true; } } this.set(`clips.${pos}.${key}`, mods[key]); } if (!needsSort &amp;&amp; mods.hasOwnProperty('date')) { needsSort = true; } if (this.currentClip &amp;&amp; mods.hasOwnProperty('labels') &amp;&amp; (clipItem.text === this.currentClip.text)) { // update current clip if labels changed this.fire('selected-clip-change'); } if (needsSort) { this._sortClipItems(); } else { this.updateDates(); } }, /** * Delete a {@link ClipItem} from the list * @param {string} text - ClipItem text * @private * @memberOf ClipList */ deleteClipItem: function(text) { const pos = this._getClipPos(text); if (pos !== -1) { if (this.isBulkOp) { this.clips.splice(pos, 1); } else { this.splice('clips', pos, 1); this.updateDates(); } } }, /** * Update the relative dates * @memberOf ClipList */ updateDates: function() { if (this.isBulkOp || !this._hasClipItems()) { return; } for (let i = 0; i &lt; this.clips.length; i++) { const date = this.clips[i].date; this.set(`clips.${i}.date`, date - 1); this.set(`clips.${i}.date`, date); } }, /** * Get clip from text * @param {string} clipText - text to find * @returns {?ClipItem} null if not found * @memberOf ClipList */ getClip: function(clipText) { let ret = null; if (this._hasClipItems()) { ret = this.clips.find((clipItem) =&gt; { return (clipText === clipItem.text); }); } return ret; }, /** * Get the number of selected {@link ClipItem} objects * @returns {int} * @private * @memberOf ClipList */ getSelectedCount: function() { let ret = 0; if (this._hasSelections()) { ret = this.selClips.length; } return ret; }, /** * Get the selected {@link ClipItem} objects * @returns {ClipItem[]} * @private * @memberOf ClipList */ getSelected: function() { let ret = []; if (this._hasSelections()) { ret = this.selClips; } return ret; }, /** * Get last selected {@link ClipItem} * @returns {?ClipItem} null if none selected * @private * @memberOf ClipList */ getLastSelected: function() { let clipItem = null; if (this._hasSelections()) { clipItem = this.selClips[this.selClips.length - 1]; } return clipItem; }, /** * Select all {@link ClipItem} * @memberOf ClipList */ selectAll: function() { if (this._hasClipItems()) { const list = this.$.ironList; list.clearSelection(); this.push('selClips', ...this.clips); list.scrollToIndex(0); this.fire('selected-clip-change'); } }, /** * Deselect all {@link ClipItem} * @memberOf ClipList */ deselectAll: function() { if (this._hasSelections()) { this.$.ironList.clearSelection(); } this.fire('selected-clip-change'); }, /** * Select the given array of {@link ClipItem} objects * @param {ClipItem[]} clipItems * @memberOf ClipList */ selectClipItems: function(clipItems) { clipItems = clipItems || []; const list = this.$.ironList; clipItems.forEach((clipItem) =&gt; { list.selectItem(clipItem); }); if (this._hasSelections()) { list.scrollToItem(this.selClips[0]); } }, /** * Select first item in list, if it is not already * @param {boolean} [ifNoSelections=false] - if true, * only do if no selections * @returns {boolean} true if selected * @memberOf ClipList */ selectFirst: function(ifNoSelections = false) { if (!this._hasClipItems() || (ifNoSelections &amp;&amp; this._hasSelections())) { return false; } this.$.ironList.scrollToIndex(0); return this._select(this.clips[0]); }, /** * Select {@link ClipItem} with the given text if not already * @param {string} text * @returns {boolean} true if selected * @memberOf ClipList */ selectByText: function(text) { let ret = false; let clipItem = this.getClip(text); if (clipItem &amp;&amp; !this._isSelected(clipItem)) { this.$.ironList.selectItem(clipItem); if (!this.isBulkOp) { this.fire('selected-clip-change'); } ret = true; } return ret; }, /** * Scroll to the {@link ClipItem} with the given text * @param {string} text * @memberOf ClipList */ scrollToText: function(text) { let clipItem = this.getClip(text); if (clipItem) { this.$.ironList.scrollToItem(clipItem); } }, /** * Event: Tap on clip row - handle selections like a tree select * @param {Event} event * @param {ClipItem} event.model.clip * @private * @memberOf ClipList */ _onClipRowTapped: function(event) { const isShift = event.detail.sourceEvent.shiftKey; const isCtrl = event.detail.sourceEvent.ctrlKey; const endPos = event.model.index; const curClipItem = this.clips[endPos]; let selected = event.model.selected; Chrome.GA.event(app.GA.EVENT.CLICK, 'clipItemRow'); if (isShift) { // select range of rows let startPos = -1; // override shitty iron-list scrolling const list = this.$.ironList; const firstIndex = list.firstVisibleIndex; list.scrollToIndex(0); if (selected) { // deselect any contiguous selections after for (let i = endPos + 1; i &lt; this.clips.length; i++) { const clipItem = this.clips[i]; if (this._isSelected(clipItem)) { list.deselectItem(clipItem); } else { break; } } list.scrollToIndex(firstIndex); this.fire('selected-clip-change'); return; } else if (!this._hasSelections()) { // select from first to current startPos = 0; } else { for (let i = endPos - 1; i &gt;= 0; i--) { // select from after newer selection to current const clipItem = this.clips[i]; if (this._isSelected(clipItem)) { startPos = i; break; } } if (startPos === -1) { // try the other direction for (let i = endPos + 1; i &lt; this.clips.length; i++) { // select from before older selection to current const clipItem = this.clips[i]; if (this._isSelected(clipItem)) { startPos = i; break; } } } } if (startPos !== -1) { // found range, select it const items = []; if (startPos &lt; endPos) { for (let i = startPos + 1; i &lt;= endPos; i++) { items.push(this.clips[i]); } } else if (startPos &gt; endPos) { for (let i = startPos - 1; i &gt;= endPos; i--) { items.push(this.clips[i]); } } this.push('selClips', ...items); } list.scrollToIndex(firstIndex); this.fire('selected-clip-change'); } else if (isCtrl) { // toggle selection if (selected) { this._deselect(curClipItem); } else { this._select(curClipItem); } } else { // single select with toggle const len = this.selClips.length; this.deselectAll(); if (!selected || (len &gt; 1)) { // item not selected or multiple selections before tap this._select(curClipItem); } } }, /** * Event: Label icon of clip row tapped * @param {Event} event * @param {{}} event.model * @private * @memberOf ClipList */ _onRowLabelTapped: function(event) { Chrome.GA.event(app.GA.EVENT.IMAGE_BUTTON, 'rowLabelTapped'); this.deselectAll(); this._select(event.model.clip); this.fire('row-label-tap'); }, /** * Observer: The pinFavs setting changed * @param {boolean} newValue * @param {boolean|undefined} oldValue * @private * @memberOf ClipList */ _pinFavsChanged: function(newValue, oldValue) { if (typeof(oldValue) !== 'undefined') { this.deselectAll(); this._sortClipItems(); this.selectFirst(); } }, /** * Do we have any {@link ClipItem} objects in the list * @returns {boolean} true if we have at least one clip * @private * @memberOf ClipList */ _hasClipItems: function() { return !!(this.clips &amp;&amp; this.clips.length); }, /** * Get position of row with given text * @param {string} clipText - text to find * @returns {int} position in array, -1 if not found * @private * @memberOf ClipList */ _getClipPos: function(clipText) { let ret = -1; if (this._hasClipItems()) { ret = this.clips.findIndex((clipItem) =&gt; { return (clipText === clipItem.text); }); } return ret; }, /** * Delete all {@link ClipItem} objects * @private * @memberOf ClipList */ _deleteAllClipItems: function() { if (this._hasClipItems()) { this.splice('clips', 0, this.clips.length); } }, /** * Sort the {@link ClipItem} list * @private * @memberOf ClipList */ _sortClipItems: function() { if (this.isBulkOp) { return; } /** * Sort by date * @param {ClipItem} a * @param {ClipItem} b * @returns {number} */ function byDate(a, b) { return b.date - a.date; } // override shitty iron-list scrolling const list = this.$.ironList; const firstIndex = list.firstVisibleIndex; list.scrollToIndex(0); // copy of current selections const selClips = this.selClips.slice(); if (this.isPinFavs) { // sort favs and non-favs separately and keep favs on top const favClips = this.clips.filter((clip) =&gt; { return clip.fav; }); favClips.sort(byDate); const nonFavClips = this.clips.filter((clip) =&gt; { return !clip.fav; }); nonFavClips.sort(byDate); this._deleteAllClipItems(); // populate list this.push('clips', ...favClips); this.push('clips', ...nonFavClips); } else { // sort by date const clips = this.clips.slice(); clips.sort(byDate); this._deleteAllClipItems(); this.push('clips', ...clips); } this._updateSelections(selClips, firstIndex); }, /** * Update the selected items * @param {ClipItem[]} selClips - ClipItems to select * @param {int} [scrollIndex = 0] * @private * @memberOf ClipList */ _updateSelections: function(selClips, scrollIndex = 0) { selClips = selClips || []; const list = this.$.ironList; list.clearSelection(); this.push('selClips', ...selClips); list.scrollToIndex(scrollIndex); this.fire('selected-clip-change'); }, /** * Do we have selected items * @returns {boolean} * @private * @memberOf ClipList */ _hasSelections: function() { return !!(this.selClips &amp;&amp; this.selClips.length); }, /** * Is a {@link ClipItem} selected * @param {ClipItem} clipItem * @returns {boolean} * @private * @memberOf ClipList */ _isSelected: function(clipItem) { const idx = this.selClips.findIndex((clip) =&gt; { return (clip.text === clipItem.text); }); return (idx !== -1); }, /** * Select {@link ClipItem} if not already * @param {ClipItem} clipItem * @returns {boolean} true if selected * @private * @memberOf ClipList */ _select: function(clipItem) { let ret = false; if (clipItem &amp;&amp; !this._isSelected(clipItem)) { this.$.ironList.selectItem(clipItem); if (!this.isBulkOp) { this.fire('selected-clip-change'); } ret = true; } return ret; }, /** * Deselect {@link ClipItem} if not already * @param {ClipItem} clipItem * @returns {boolean} true if deselected * @private * @memberOf ClipList */ _deselect: function(clipItem) { let ret = false; if (clipItem &amp;&amp; this._isSelected(clipItem)) { this.$.ironList.deselectItem(clipItem); if (!this.isBulkOp) { this.fire('selected-clip-change'); } ret = true; } return ret; }, /** * Observer: The bulkOp setting changed * @param {boolean} newValue * @param {boolean|undefined} oldValue * @private * @memberOf ClipList */ _bulkOpChanged: function(newValue, oldValue) { if (typeof(oldValue) !== 'undefined') { if (!newValue &amp;&amp; oldValue) { // toggling from true to false if (this._hasClipItems()) { this._sortClipItems(); this.updateDates(); } else { // no clips this.set('clips', []); this._updateSelections([], 0); } } } }, }); × Search results Close "},"pages_main-page.js.html":{"id":"pages_main-page.js.html","title":"Source: pages/main-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/main-page.js (function() { 'use strict'; new ExceptionHandler(); const _ERR_LOAD = 'Failed to load Clips'; let self; // noinspection JSUnusedLocalSymbols /** * Polymer element to display and manage {@link ClipItem} objects * @namespace MainPage */ Polymer({ is: 'main-page', properties: { /** * {@link ClipItem} currently being viewed * @memberOf MainPage */ currentClip: { type: Object, value: null, notify: true, }, /** * Are we editing {@link currentClip} * @memberOf MainPage */ isEditMode: { type: Boolean, value: false, notify: true, }, /** * True if we are only showing favorite items * @type boolean * @memberOf MainPage */ isFavFilter: { type: Boolean, value: false, notify: true, }, /** * True if we are showing favorite items at top of list * @type boolean * @memberOf MainPage */ isPinFavs: { type: Boolean, value: false, notify: true, }, /** * {@link Label} name for filtering our items * @type string * @memberOf MainPage */ labelFilter: { type: String, value: null, notify: true, observer: '_labelFilterChanged', }, /** * True if we have selected items * @memberOf ClipList */ hasSelections: { type: Boolean, notify: true, }, /** * True if we can send the clipboard contents * @memberOf MainPage */ canSend: { type: Boolean, value: false, notify: true, }, /** * Array of {@link ClipItem} objects that have been recently deleted * @memberOf MainPage */ undoClips: { type: Array, value: [], notify: true, }, /** * Message of undo toast * @memberOf MainPage */ undoText: { type: String, value: '', notify: true, }, /** * Array of all selected {@link Label} names in the dialog * @memberOf MainPage */ selDialogLabels: { type: Array, value: [], notify: true, }, /** * True if label changes in dialog should apply to all selectedClips * @memberOf MainPage */ isMultiLabelsEdit: { type: Boolean, value: false, notify: true, }, /** * True if we are performing an operation on multiple clips * @memberOf MainPage */ isBulkOp: { type: Boolean, value: false, notify: true, }, }, observers: [ '_selDialogLabelsAddedOrRemoved(selDialogLabels.splices)', ], /** * Element is ready * @memberOf MainPage */ ready: function() { self = this; this.set('canSend', app.Utils.canSend()); this._loadClipItems(true).then(() =&gt; { // !Important this.$.clipList.deselectAll(); this.$.clipList.selectFirst(); // don't do in attached. need clips to be loaded before listening Chrome.Msg.listen(this._onChromeMessage.bind(this)); // listen for copy and cut events on document document.addEventListener('cut', this._onCopy.bind(this), true); document.addEventListener('copy', this._onCopy.bind(this), true); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'MainPage.ready', _ERR_LOAD); }); }, /** * We have animated in and are now the current page * @memberOf MainPage */ onCurrentPage: function() { this.set('isBulkOp', false); this.set('canSend', app.Utils.canSend()); this.$.clipList.selectFirst(true); this.$.clipList.updateDates(); }, /** * We are not going to be current anymore * @memberOf MainPage */ onLeavePage: function() { this.set('isBulkOp', false); this._closeUndoToast(); this.$.clipList.deselectAll(); }, /** * Set {@link Label} name for filtering * @param {string} [labelName = ''] * @memberOf MainPage */ setLabelFilter: function(labelName = '') { if (this.labelFilter === labelName) { this.$.clipList.updateDates(); } else { this.set('labelFilter', labelName); } }, // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf MainPage */ _onChromeMessage: function(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.CLIP_ITEM_CREATED.message) { ret = true; // async this.$.clipList.addClipItem(request.item); } else if (request.message === app.ChromeMsg.CLIP_ITEM_UPDATED.message) { const item = request.item; this.$.clipList.updateClipItem(item.text, item.mods); } else if (request.message === app.ChromeMsg.CLIP_ITEM_DELETED.message) { this.$.clipList.deleteClipItem(request.item); } else if (request.message === app.ChromeMsg.NO_REMOTE_DEVICES.message) { this.set('canSend', app.Utils.canSend()); } return ret; }, /** * Event: Select labels menu icon tapped * @private * @memberOf MainPage */ _onSelectLabelsTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.ICON, 'selectLabels'); this._showLabelsDialog(true); }, /** * Event: Select all menu icon tapped * @private * @memberOf MainPage */ _onSelectAllTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.ICON, 'selectAllClipItems'); this.$.clipList.deselectAll(); this.$.clipList.selectAll(); }, /** * Event: Deselect all menu icon tapped * @private * @memberOf MainPage */ _onDeselectAllTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.ICON, 'deselectAllClipItems'); this.$.clipList.deselectAll(); }, /** * Event: Delete menu icon tapped * @private * @memberOf MainPage */ _onDeleteSelectedTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.ICON, 'deleteSelectedClipItems'); // save items for undo const keys = []; this.splice('undoClips', 0, this.undoClips.length); const clipItems = this.$.clipList.getSelected(); clipItems.forEach((clipItem) =&gt; { keys.push(clipItem._id); this.push('undoClips', clipItem); }); if (keys.length) { // skip updates until bulk operation is complete this.set('isBulkOp', true); this.$.clipList.deselectAll(); app.ClipItem.remove(keys).then(() =&gt; { this.set('isBulkOp', false); const len = this.undoClips.length; let toastText = (len === 1) ? 'Deleted 1 item.' : `Deleted ${len} items.`; this.set('undoText', toastText); this.$.undoToast.show(); return Promise.resolve(); }).catch((err) =&gt; { this.set('isBulkOp', false); Chrome.Log.error(err.message, 'MainPage._onDeleteSelectedRows', 'Failed to delete clips.'); }); } }, /** * Event: Send clipboard contents icon tapped * @private * @memberOf MainPage */ _onSendTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.ICON, 'sendClipboardContents'); Chrome.Msg.send(app.ChromeMsg.COPIED_TO_CLIPBOARD).catch(() =&gt; {}); }, /** * Event: Pin menu icon tapped * @private * @memberOf MainPage */ _onPinTapped: function() { this.set('isPinFavs', !this.isPinFavs); Chrome.GA.event(Chrome.GA.EVENT.ICON, `pinFavorites: ${this.isPinFavs}`); }, /** * Event: Favorite filter menu icon tapped * @private * @memberOf MainPage */ _onFavFilterTapped: function() { this.set('isFavFilter', !this.isFavFilter); Chrome.GA.event(Chrome.GA.EVENT.ICON, `filterByFavorites: ${this.isFavFilter}`); this._loadClipItems(true).catch((err) =&gt; { Chrome.Log.error(err.message, 'MainPage._onFavFilterTapped', _ERR_LOAD); }); }, /** * Event: Undo Toast close button tapped * @private * @memberOf MainPage */ _onCloseToastTapped: function() { Chrome.GA.event(app.GA.EVENT.IMAGE_BUTTON, 'closeUndoToast'); this._closeUndoToast(); }, /** * Event: Undo Toast button tapped&lt;br /&gt; * Restore the deleted Items * @private * @memberOf MainPage */ _onUndoDeleteTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.BUTTON, 'UNDO'); this.set('isBulkOp', true); app.ClipItem.bulkPut(this.undoClips).then(() =&gt; { this.set('isBulkOp', false); // reset selections const newClipItems = []; this.undoClips.forEach((clipItem) =&gt; { // need to use new item reference - hashing issue in iron-list? const newClipItem = this.$.clipList.getClip(clipItem.text); if (newClipItem) { newClipItems.push(newClipItem); } }); this.$.clipList.selectClipItems(newClipItems); this._setCurrentClip(); this._closeUndoToast(); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'MainPage._onUndoDeleteTapped', 'Failed to undo delete.'); this.set('isBulkOp', false); this._closeUndoToast(); }); }, /** * Event: The selected {@link ClipItem} changed * @private * @memberOf MainPage */ _onSelectedClipChanged: function() { this._setCurrentClip(); this.set('hasSelections', !!this.$.clipList.getSelectedCount()); }, /** * Event: Label of {@link ClipItem} row tapped * @param {Event} event * @private * @memberOf MainPage */ _onRowLabelTapped: function(event) { this._showLabelsDialog(false); }, /** * Event: Labels of {@link ClipViewer} tapped * @param {Event} event * @private * @memberOf MainPage */ _onViewerLabelsTapped: function(event) { this._showLabelsDialog(false); }, /** * Event: {@link ClipViewer} wants to change the text * @param {Event} event * @param {Event} event.detail - new text * @private * @memberOf MainPage */ _onViewerTextChanged: function(event) { const newText = event.detail.text; if (!Chrome.Utils.isWhiteSpace(newText)) { let clipItem = this.$.clipList.getClip(newText); if (clipItem) { // text changed to an existing clip, update it instead clipItem.update({ date: Date.now(), remote: false, }).then(() =&gt; { // delete the one we were editing return this.currentClip.delete(); }).then(() =&gt; { this.$.clipList.deselectAll(); this.$.clipList.selectByText(newText); this.$.clipList.scrollToText(newText); // send message to copy to clipboard const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.COPY_TO_CLIPBOARD); msg.item = clipItem; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); return Promise.resolve(); }).catch((err) =&gt; { this._showMessageToast('Failed to update clip.', err); }); } else { // update current clip this.currentClip.update({ date: Date.now(), text: newText, remote: false, }).then(() =&gt; { this.$.clipList.scrollToText(newText); // send message to copy to clipboard const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.COPY_TO_CLIPBOARD); msg.item = this.currentClip; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); return Promise.resolve(); }).catch((err) =&gt; { this._showMessageToast('Failed to update clip.', err); }); } } else { // delete it this.currentClip.delete().then(() =&gt; { this.$.clipList.selectFirst(true); return Promise.resolve(); }).catch((err) =&gt; { this._showMessageToast('Failed to delete clip.', err); }); } }, /** * Event: {@link ClipViewer} wants to add a new {@link ClipItem} * @param {Event} event * @param {Event} event.detail - text for clip * @private * @memberOf MainPage */ _onViewerClipAdd: function(event) { const text = event.detail.text; const date = Date.now(); const device = app.Device.myName(); app.ClipItem.add(text, date, false, false, device, true).then((clip) =&gt; { // send message to copy to clipboard const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.COPY_TO_CLIPBOARD); msg.item = clip; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); this.$.clipList.deselectAll(); this.$.clipList.selectByText(text); this.$.clipList.scrollToText(text); return Promise.resolve(); }).catch((err) =&gt; { this._showMessageToast('Failed to add clip.', err); }); }, /** * Event: Text was copied to clipboard * @private * @memberOf MainPage */ _onCopy: function() { if (!this.isEditMode) { // skip when editing the current clip Chrome.Msg.send(app.ChromeMsg.COPIED_TO_CLIPBOARD).catch(() =&gt; {}); } }, /** * Event: Initialize pinFavs if it is not in localStorage * @private * @memberOf MainPage */ _initPinFavs: function() { this.set('isPinFavs', 'false'); }, /** * Observer: The label filter changed * @param {string} newValue * @param {string|undefined} oldValue * @private * @memberOf MainPage */ _labelFilterChanged: function(newValue, oldValue) { if (typeof(oldValue) !== 'undefined') { this.$.clipList.deselectAll(); this._loadClipItems().catch((err) =&gt; { Chrome.Log.error(err.message, 'MainPage.setLabelFilter', _ERR_LOAD); }); } }, /** * Observer: selDialogLabels Array mutations * @param {{}} changeRecord * @private * @memberOf MainPage */ _selDialogLabelsAddedOrRemoved: function(changeRecord) { if (changeRecord) { this.set('isBulkOp', true); const promises = []; if (this.isMultiLabelsEdit) { // track each added and removed label change and // apply to each selected clip const addedNames = []; const removedNames = []; const splices = changeRecord.indexSplices; splices.forEach((splice) =&gt; { for (let i = 0; i &lt; splice.addedCount; i++) { let index = splice.index + i; addedNames.push(splice.object[index]); } splice.removed.forEach((name) =&gt; { removedNames.push(name); }); }); const clipItems = this.$.clipList.getSelected(); clipItems.forEach((clipItem) =&gt; { const names = clipItem.getLabelNames(); addedNames.forEach((addedName) =&gt; { if (!clipItem.hasLabel(addedName)) { names.push(addedName); } }); removedNames.forEach((removedName) =&gt; { if (clipItem.hasLabel(removedName)) { const idx = names.indexOf(removedName); names.splice(idx, 1); } }); promises.push(clipItem.setLabels(names)); }); } else { // apply to current clip const clipItem = this.currentClip; promises.push(clipItem.setLabels(this.selDialogLabels)); } Promise.all(promises).then(() =&gt; { this.set('isBulkOp', false); if (this.labelFilter &amp;&amp; !this.selDialogLabels.includes(this.labelFilter)) { // deleted current label from item(s) this.$.labelsDialog.close(); return this._loadClipItems(); } else { this._setCurrentClip(); return Promise.resolve(); } }).catch((err) =&gt; { this.set('isBulkOp', false); Chrome.Log.error(err.errorMessage, 'MainPage._onSelectedLabelsChanged', 'Failed to set label.'); }); } }, /** * Computed Binding * @param {ClipItem} clipItem * @param {string} labelName * @returns {string} Page title * @private * @memberOf MainPage */ _computeTitle: function(clipItem, labelName) { let title = 'Clips'; if (!Chrome.Utils.isWhiteSpace(labelName)) { title = `${labelName}`; } if (clipItem) { if (clipItem.remote) { title += `: Remote clip - ${clipItem.device}`; } else { title += ': Local clip'; } } return title; }, /** * Computed Binding: Title of Labels Dialog * @param {boolean} multi - true if dialog applies to all selectedClips * @returns {string} Dialog title * @private * @memberOf MainPage */ _computeLabelsDialogTitle: function(multi) { if (multi &amp;&amp; (this.$.clipList.getSelectedCount() &gt; 1)) { return 'Change labels for selected clips'; } else { return 'Set labels for the current clip'; } }, /** * Computed Binding * @param {boolean} isTrue - true if we should pin favs to top * @returns {string} icon style * @private * @memberOf MainPage */ _computePinIcon: function(isTrue) { return isTrue ? 'myicons:pin' : 'myicons:pin-off'; }, /** * Computed Binding * @param {boolean} isTrue - true if pinning favorites * @returns {string} tooltip text of what toggling would be * @private * @memberOf MainPage */ _computePinToolTip: function(isTrue) { return isTrue ? 'Unpin favorites' : 'Pin favorites to top'; }, /** * Computed Binding * @param {boolean} isTrue - true if fav * @returns {string} icon style * @private * @memberOf MainPage */ _computeFavIcon: function(isTrue) { return isTrue ? 'myicons:favorite' : 'myicons:favorite-border'; }, /** * Computed Binding * @param {boolean} isFilter - true if filtering by fav * @returns {string} tooltip text of what toggling would be * @private * @memberOf MainPage */ _computeFavToolTip: function(isFilter) { return isFilter ? 'Show all' : 'Show favorites only'; }, /** * Computed Binding * @param {boolean} isTrue - true if fav * @returns {string} fav filter menu icon color * @private * @memberOf MainPage */ _computeFavMenuColor: function(isTrue) { return isTrue ? 'rgba(255, 0, 0, .8)' : 'var(--menu-icon-color)'; }, /** * Load the {@link ClipItem} objects * @param {boolean} [isSelectFirst=true] - if true select first item * @returns {Promise&lt;void&gt;} * @private * @memberOf MainPage */ _loadClipItems: function(isSelectFirst = true) { this._closeUndoToast(); return this.$.clipList.loadClipItems(isSelectFirst); }, /** * Set clip viewer contents based on last selected * @private * @memberOf MainPage */ _setCurrentClip: function() { let currentItem = this.$.clipList.getLastSelected(); // override dirty checking this.set('currentClip', null); if (currentItem) { this.set('currentClip', currentItem); } }, /** * Show Labels select dialog * @param {boolean} multi - if true apply changes to all selectItems * @private * @memberOf MainPage */ _showLabelsDialog: function(multi) { this.set('isMultiLabelsEdit', multi); const list = this.$.clipList; if (multi &amp;&amp; (list.getSelectedCount() &gt; 1)) { // for multi mode, apply to all selectedClips app.Label.loadAll().then((labels) =&gt; { // get all label names that all selected clips share const clipItems = list.getSelected(); const names = []; labels = labels || []; labels.forEach((label) =&gt; { let hasLabel = true; for (let i = 0; i &lt; clipItems.length; i++) { const clipItem = clipItems[i]; if (!clipItem.hasLabel(label.name)) { hasLabel = false; break; } } if (hasLabel) { names.push(label.name); } }); return Promise.resolve(names); }).then((labelNames) =&gt; { this.set('selDialogLabels', labelNames); this.$.labelsDialog.open(); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'MainPage._showLabelsDialog', 'Failed to load labels'); }); } else { if (this.currentClip) { const names = this.currentClip.getLabelNames(); this.set('selDialogLabels', names); this.$.labelsDialog.open(); } } }, /** * Show an auto hiding message toast * @param {string} text * @param {?Error} [err=null] * @private * @memberOf MainPage */ _showMessageToast: function(text, err = null) { this.$.messageToast.fitInto = this.$.clipViewer; this.$.messageToast.text = text; this.$.messageToast.show(); if (err) { Chrome.Log.error(err.message, 'MainPage._showMessageToast', text); } }, /** * Close the Undo Toast * @private * @memberOf MainPage */ _closeUndoToast: function() { if (this.undoClips &amp;&amp; this.undoClips.length) { this.splice('undoClips', 0, this.undoClips.length); } this.$.undoToast.close(); }, }); /** * Document and resources loaded * @private * @memberOf MainPage */ function _onLoad() { const db = app.DB.get(); if (!db) { Chrome.Log.error('Failed to get database reference', 'MainPage._onLoad', 'Database not found'); return; } db.clipItems.hook('creating', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { self.$.clipList.addClipItem(obj.text); }; }); db.clipItems.hook('updating', function(mods, primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { self.$.clipList.updateClipItem(obj.text, mods); }; }); db.clipItems.hook('deleting', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { self.$.clipList.deleteClipItem(obj.text); }; }); } // listen for document and resources loaded window.addEventListener('load', _onLoad); })(); × Search results Close "},"clip-row.js.html":{"id":"clip-row.js.html","title":"Source: clip-row.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: clip-row.js 'use strict'; new ExceptionHandler(); /** * Polymer element to display a row in the {@link ClipList} * @namespace ClipRow */ Polymer({ is: 'clip-row', properties: { /** * Fired when the label button of a row is tapped * @event label-tap * @memberOf ClipRow */ /** * Our {@link ClipItem} * @memberOf ClipRow */ clip: { type: Object, value: null, notify: true, }, /** * True if we are selected * @memberOf ClipRow */ selected: { type: Boolean, value: false, notify: true, }, }, /** * Event: Copy {@link ClipItem} to clipboard * @param {Event} event * @param {ClipItem} event.model.clip * @private * @memberOf ClipRow */ _onCopyTapped: function(event) { Chrome.GA.event(app.GA.EVENT.IMAGE_BUTTON, 'copyClipItem'); const clipItem = this.clip; clipItem.date = Date.now(); clipItem.remote = false; clipItem.save().then(() =&gt; { // send message to copy to clipboard const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.COPY_TO_CLIPBOARD); msg.item = clipItem; // eslint-disable-next-line promise/no-nesting Chrome.Msg.send(msg).catch(() =&gt; {}); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipRow._onCopyTapped', 'Failed to copy item to clipboard.'); }); // prevent row selection event.stopPropagation(); }, /** * Event: Toggle favorite state of row * @param {Event} event * @param {ClipItem} event.model.clip * @private * @memberOf ClipRow */ _onFavTapped: function(event) { Chrome.GA.event(app.GA.EVENT.IMAGE_BUTTON, 'toggleFavorite'); const clipItem = this.clip; if (clipItem) { clipItem.update({fav: !clipItem.fav}).catch((err) =&gt; { Chrome.Log.error(err.message, 'ClipRow._onFavTapped'); }); } // prevent row selection event.stopPropagation(); }, /** * Event: Label icon of clip row tapped * @param {Event} event * @param {{}} event.model * @private * @memberOf ClipRow */ _onLabelTapped: function(event) { Chrome.GA.event(app.GA.EVENT.IMAGE_BUTTON, 'rowLabelTapped'); // prevent row deselection event.stopPropagation(); this.fire('label-tap'); }, /** * Computed Binding: Clip item classList * @param {boolean} selected - is clip selected * @returns {string} Clip item classList * @private * @memberOf ClipRow */ _computeClipClass: function(selected) { let classList = 'clip-item'; if (selected) { classList += ' selected'; } return classList; }, /** * Computed Binding: relative date * @param {int} date - from epoch in millis * @returns {string} Date as relative from now * @private * @memberOf ClipRow */ _computeDate: function(date) { return app.Utils.getRelativeTime(date); }, /** * Computed Binding: fav icon * @param {boolean} isTrue - true if fav * @returns {string} icon style * @private * @memberOf ClipRow */ _computeFavIcon: function(isTrue) { return isTrue ? 'myicons:favorite' : 'myicons:favorite-border'; }, /** * Computed Binding: color of fav icon * @param {boolean} isTrue - true if fav * @returns {string} Favorite icon color * @private * @memberOf ClipRow */ _computeFavColor: function(isTrue) { return isTrue ? 'rgba(255, 0, 0, .8)' : 'var(--primary-text-color)'; }, }); × Search results Close "},"clip-viewer.js.html":{"id":"clip-viewer.js.html","title":"Source: clip-viewer.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: clip-viewer.js 'use strict'; new ExceptionHandler(); /** * Polymer element to display a {@link ClipItem} * @namespace ClipViewer */ Polymer({ is: 'clip-viewer', properties: { /** * Fires when labels section is tapped * @event labels-tapped * @memberOf ClipViewer */ /** * Fires when text is changed * @event text-changed * @memberOf ClipViewer */ /** * Fires when a new clip should be added * @event clip-add * @memberOf ClipViewer */ /** * {@link ClipItem} to view * @memberOf ClipViewer */ clipItem: { type: Object, value: null, notify: true, observer: '_clipItemChanged', }, /** * Array of {@link Label} objects for the {@link ClipItem} * @memberOf ClipViewer */ labels: { type: Array, value: [], notify: true, }, /** * Are we editing the text * @memberOf ClipViewer */ isEditMode: { type: Boolean, value: false, notify: true, observer: '_isEditModeChanged', }, /** * Text currently being edited * @memberOf ClipViewer */ editText: { type: String, value: '', notify: true, }, }, /** * Event: Labels section tapped * @private * @memberOf ClipViewer */ _onLabelsTapped: function() { Chrome.GA.event(app.GA.EVENT.CLICK, 'viewerLabelsTapped'); this.fire('labels-tapped'); }, /** * Event: Edit mode fab tapped * @private * @memberOf ClipViewer */ _onEditModeTapped: function() { Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'clipViewerEdit'); if (this.clipItem) { // editing existing this.set('editText', this.clipItem.text); } else { // adding new this.set('editText', ''); } this.set('isEditMode', true); }, /** * Event: Cancel edit mode fab tapped * @private * @memberOf ClipViewer */ _onCancelEditModeTapped: function() { Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'clipViewerCancelEdit'); this.set('isEditMode', false); this.set('editText', ''); }, /** * Event: Save changes fab tapped * @private * @memberOf ClipViewer */ _onSaveChangesTapped: function() { if (!this.clipItem &amp;&amp; !Chrome.Utils.isWhiteSpace(this.editText)) { // new clip this.fire('clip-add', {text: this.editText}); Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'clipViewerAddClip'); } else if (this.editText !== this.clipItem.text) { // modified clip Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'clipViewerSaveChanges'); this.fire('text-changed', {text: this.editText}); } else { // no changes Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'clipViewerNoChanges'); } this._clearEditMode(); }, /** * Observer: The label filter changed * @private * @memberOf ClipViewer */ _isEditModeChanged: function() { if (this.isEditMode) { this.$.textArea.focus(); } }, /** * Observer: The current clip changed * @private * @memberOf ClipViewer */ _clipItemChanged: function() { this._clearEditMode(); // clear text const el = this.$.text; while (el.firstChild) { // delete all children previous linkify created el.removeChild(el.firstChild); } window.getSelection().empty(); // clear labels // not guaranteed to be initialized yet if (this.labels === undefined) { this.labels = []; } this.$.labels.style.display = 'none'; this.splice('labels', 0, this.labels.length); if (!this.clipItem) { return; } // set text el.textContent = this.clipItem.text; // linkify it - creates element children linkifyElement(el); // set labels if (this.clipItem.labels.length) { this.push('labels', ...this.clipItem.labels); this.$.labels.style.display = 'block'; } }, /** * Computed property: Title (tooltip) for editMode fab * @param {ClipItem} clipItem * @returns {string} * @private * @memberOf ClipViewer */ _computeAddEditTitle: function(clipItem) { return clipItem ? 'Edit clip' : 'Add new clip'; }, /** * Computed property: Icon for editMode fab * @param {ClipItem} clipItem * @returns {string} * @private * @memberOf ClipViewer */ _computeAddEditIcon: function(clipItem) { return clipItem ? 'myicons:mode-edit' : 'myicons:add'; }, /** * Computed property: Label for editMode fab * @param {ClipItem} clipItem * @returns {string} * @private * @memberOf ClipViewer */ _computeTextAreaLabel: function(clipItem) { return clipItem ? 'Editing clip' : 'Creating new clip'; }, /** * Reset to view mode * @private * @memberOf ClipViewer */ _clearEditMode() { if ((this.isEditMode === undefined) || (this.editText === undefined)) { return; } this.set('isEditMode', false); this.set('editText', ''); }, }); × Search results Close "},"on_copy_cut_content_script.js.html":{"id":"on_copy_cut_content_script.js.html","title":"Source: on_copy_cut_content_script.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: on_copy_cut_content_script.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ /** * Content script to monitor clipboard copy and cuts * @namespace ContentScript */ (function() { 'use strict'; if (window.onMyCopy) { window.removeEventListener('copy', window.onMyCopy); window.removeEventListener('cut', window.onMyCopy); } /** * On copy or cut event, send a message to our extension * @memberOf ContentScript */ window.onMyCopy = function onMyCopy() { try { chrome.runtime.sendMessage(chrome.runtime.id, { message: 'copiedToClipboard', }, () =&gt; {}); } catch (ex) { // noinspection UnnecessaryReturnStatementJS return; } }; window.addEventListener('copy', window.onMyCopy); window.addEventListener('cut', window.onMyCopy); })(); × Search results Close "},"device.js.html":{"id":"device.js.html","title":"Source: device.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: device.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function(window) { 'use strict'; new ExceptionHandler(); /** * Creates a new Device instance. * @constructor * @alias Device * @param {string} model - The model name of a device * @param {string} sn - The serial number (or other descriptor) of a device * @param {string} os - The operating system of a device * @param {string} nickname - The nickname of a device * @param {int} lastSeen - A date in millis from the epoch */ const Device = function(model, sn, os, nickname, lastSeen) { this.model = model; this.sn = sn; this.os = os; this.nickname = nickname; if (lastSeen) { this.lastSeen = lastSeen; } else { this.lastSeen = Date.now(); } }; /** * Model key * @const * @default */ Device.MODEL = 'dM'; /** * Serial Number key * @const * @default */ Device.SN = 'dSN'; /** * Operating system key * @const * @default */ Device.OS = 'dOS'; /** * Nickname key * @const * @default */ Device.NICKNAME = 'dN'; /** * Get a String that uniquely (hopefully) determines this {@link Device} * @returns {string} unique name */ Device.prototype.getUniqueName = function() { return `${this.model} - ${this.sn} - ${this.os}`; }; /** * Get name suitable for display * @returns {string} descriptive name of {@link Device} */ Device.prototype.getName = function() { let name = this.nickname; if (Chrome.Utils.isWhiteSpace(name)) { name = this.getUniqueName(); } return name; }; /** * Determine if this is our {@link Device} * @returns {boolean} true if this is our {@link Device} */ Device.prototype.isMe = function() { return (this.getUniqueName() === Device.myUniqueName()); }; /** * Get unique name of our {@link Device} * @returns {string} unique name */ Device.myUniqueName = function() { return `${Device.myModel()} - ${Device.mySN()} - ${Device.myOS()}`; }; /** * Get display name of our {@link Device} * @returns {string} display name */ Device.myName = function() { let name = Device.myNickname(); if (Chrome.Utils.isWhiteSpace(name)) { name = Device.myUniqueName(); } return name; }; /** * Get model name of our {@link Device} * @returns {string} model name */ Device.myModel = function() { return 'Chrome'; }; /** * Get serial number of our {@link Device} * @returns {string} serial number */ Device.mySN = function() { return Chrome.Storage.get('deviceSN'); }; /** * Get operating system of our {@link Device} * @returns {string} operating system */ Device.myOS = function() { return Chrome.Storage.get('os'); }; /** * Get os version of our {@link Device} * @returns {string} operating system version */ Device.myVersion = function() { return Chrome.Utils.getChromeVersion(); }; /** * Get nickname of our {@link Device} * @returns {string} nickname */ Device.myNickname = function() { return Chrome.Storage.get('deviceNickname'); }; window.app = window.app || {}; window.app.Device = Device; })(window); × Search results Close "},"pages_devices-page.js.html":{"id":"pages_devices-page.js.html","title":"Source: pages/devices-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/devices-page.js (function(window) { 'use strict'; new ExceptionHandler(); const _MSG_NO_DEVICES = 'No remote devices are registered.\\n\\n' + 'Please disable \\'Push to devices\\' in the ' + 'Settings or register other devices.\\nThank you.'; const _MSG_NO_PUSH = 'Unable to look for remote devices\\n\\n' + '\\'Push to devices\\' is disabled.\\n' + 'You can enable it in the Settings.'; const _MSG_NO_RECEIVE = 'Unable to look for remote devices\\n\\n' + '\\'Receive from devices\\' is disabled.\\n' + 'You can enable it in the Settings.'; window.app = window.app || {}; /** * Polymer element to manage our {@link Device} objects * @namespace DevicesPage */ app.DevicesPageFactory = Polymer({ is: 'devices-page', properties: { /** * The Array of {@link Device} objects * @memberOf DevicesPage */ devices: { type: Array, value: [], notify: true, }, /** * A message about why Device list is not available * @memberOf DevicesPage */ infoMessage: { type: String, value: '', notify: true, }, }, /** * Element is ready * @memberOf DevicesPage */ ready: function() { // listen for chrome messages Chrome.Msg.listen(this._onChromeMessage.bind(this)); }, /** * We hare now the current page * @memberOf DevicesPage */ onCurrentPage: function() { if (!app.Utils.allowPush()) { this.set('infoMessage', _MSG_NO_PUSH); } else if (!app.Utils.allowReceive()) { this.set('infoMessage', _MSG_NO_RECEIVE); } else { this.set('infoMessage', ''); this._ping(); this._loadDevices(); } }, /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @returns {boolean} true if asynchronous * @private * @memberOf DevicesPage */ _onChromeMessage: function(request) { let ret = false; if (request.message === app.ChromeMsg.DEVICES_CHANGED.message) { this._loadDevices(); } else if (request.message === app.ChromeMsg.NO_REMOTE_DEVICES.message) { this.set('infoMessage', _MSG_NO_DEVICES); } return ret; }, /** * Event: Delete Device button tapped * @param {Event} event * @param {{}} event.model * @private * @memberOf DevicesPage */ _onDeleteTapped: function(event) { const device = event.model.device; const msg = Chrome.JSONUtils.shallowCopy(app.ChromeMsg.REMOVE_DEVICE); msg.item = device.getUniqueName(); Chrome.Msg.send(msg).catch(() =&gt; {}); }, /** * Event: Refresh Fab tapped * @private * @memberOf DevicesPage */ _onFabTapped: function() { Chrome.GA.event(app.GA.EVENT.FAB_BUTTON, 'refreshDevicesTapped'); if (app.Utils.allowPush()) { this._ping(); } else { this._showNoPushDialog(); } }, /** * Computed property: Relative date string * @param {int} date * @returns {string} * @private * @memberOf DevicesPage */ _computeDate: function(date) { return app.Utils.getRelativeTime(date); }, /** * Computed property: Do we have an info message * @param {string} infoMessage * @returns {boolean} * @private * @memberOf DevicesPage */ _computeHasInfoMessage: function(infoMessage) { return !Chrome.Utils.isWhiteSpace(infoMessage); }, /** * Load the devices * @private * @memberOf DevicesPage */ _loadDevices: function() { // clear list this.splice('devices', 0, this.devices.length); // populate list const devices = Chrome.Storage.get('devices'); if (devices) { for (let key in devices) { if (devices.hasOwnProperty(key)) { const v = devices[key]; const device = new app.Device(v.model, v.sn, v.os, v.nickname, v.lastSeen); this.push('devices', device); } } } }, /** * Sort filter for the Devices - by last seen date * @param {Device} a - first comparator * @param {Device} b - second comparator * @returns {int} * @private * @memberOf DevicesPage */ _sortByDate: function(a, b) { return b.lastSeen - a.lastSeen; }, /** * Ping our devices * @private * @memberOf DevicesPage */ _ping: function() { Chrome.Msg.send(app.ChromeMsg.PING).catch(() =&gt; {}); }, }); })(window); × Search results Close "},"pages_error-page.js.html":{"id":"pages_error-page.js.html","title":"Source: pages/error-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/error-page.js window.app = window.app || {}; (function() { 'use strict'; new ExceptionHandler(); /** * Polymer element to display a {@link Chrome.Storage.LastError} object * @namespace ErrorPage */ app.ErrorPageFactory = Polymer({ is: 'error-page', properties: { /** * A {@link Chrome.Storage.LastError} * @memberOf ErrorPage */ lastError: { type: Object, value: function() { return new Chrome.Storage.LastError(); }, notify: true, }, }, /** * Element is ready * @memberOf ErrorPage */ ready: function() { Chrome.Storage.getLastError().then((lastError) =&gt; { this.set('lastError', lastError); return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'ErrorPage.ready'); }); chrome.storage.onChanged.addListener((changes) =&gt; { // listen for changes to lastError for (const key in changes) { if (changes.hasOwnProperty(key)) { if (key === 'lastError') { const change = changes[key]; this.set('lastError', change.newValue); break; } } } }); }, /** * Event: Send Email to support address * @private * @memberOf ErrorPage */ _onEmailTapped: function() { let body = app.Utils.getEmailBody(); body = body + `${this.lastError.title}\\n\\n${this.lastError.message}\\n\\n` + `${this.lastError.stack}`; body = body + '\\n\\nPlease provide any additional info. ' + 'on what led to the error.\\n\\n'; const url = app.Utils.getEmailUrl('Last Error', body); Chrome.GA.event(Chrome.GA.EVENT.ICON, 'LastError email'); chrome.tabs.create({url: url}); }, /** * Event: Clear the error * @private * @memberOf ErrorPage */ _onRemoveTapped: function() { Chrome.Storage.clearLastError(); Chrome.GA.event(Chrome.GA.EVENT.ICON, 'LastError delete'); }, /** * Computed Binding * @param {Chrome.Storage.LastError} lastError * @returns {string} stack trace * @private * @memberOf ErrorPage */ _computeStack: function(lastError) { let ret = ''; if (lastError.message) { ret += lastError.stack; } return ret; }, /** * Computed Binding * @param {Chrome.Storage.LastError} lastError * @returns {string} page title * @private * @memberOf ErrorPage */ _computeTitle: function(lastError) { let ret = 'Last error viewer'; if (lastError.message) { ret += ` - ${lastError.title}`; } return ret; }, }); })(window); × Search results Close "},"scripts_exception_handler.js.html":{"id":"scripts_exception_handler.js.html","title":"Source: scripts/exception_handler.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: scripts/exception_handler.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://github.com/opus1269/chrome-extension-utils/blob/master/LICENSE.md */ // noinspection ThisExpressionReferencesGlobalObjectJS (function(window, factory) { window.ExceptionHandler = factory(window); }(this, function(window) { 'use strict'; return ExceptionHandler; /** * Log Exceptions with analytics. Include: new ExceptionHandler()&lt;br /&gt; * at top of every js file * @constructor * @alias ExceptionHandler */ function ExceptionHandler() { if (typeof window.onerror === 'object') { // global error handler window.onerror = function(message, url, line, col, errObject) { if (Chrome &amp;&amp; Chrome.Log &amp;&amp; errObject) { Chrome.Log.exception(errObject, null, true); } }; } } })); × Search results Close "},"pages_help-page.js.html":{"id":"pages_help-page.js.html","title":"Source: pages/help-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/help-page.js (function(window) { 'use strict'; new ExceptionHandler(); window.app = window.app || {}; /** * Polymer element to display Help and Feedback links * @namespace HelpPage */ app.HelpPageFactory = Polymer({ is: 'help-page', properties: { /** * Path to github project * @memberOf HelpPage */ githubPath: { type: String, value: function() { return app.Utils.getGithubPath(); }, readOnly: true, }, /** * Path to github project's pages * @memberOf HelpPage */ githubPagesPath: { type: String, value: function() { return app.Utils.getGithubPagesPath(); }, readOnly: true, }, }, /** * computed binding: Get the extension version * @returns {string} version * @private * @memberOf HelpPage */ _computeVersion: function() { const text = Chrome.Utils.getVersion(); return encodeURIComponent(text); }, /** * computed binding: Get a mailto url * @param {string} subject - email subject * @returns {string} url * @private * @memberOf HelpPage */ _computeMailToUrl: function(subject) { return app.Utils.getEmailUrl(subject, app.Utils.getEmailBody()); }, }); })(window); × Search results Close "},"label.js.html":{"id":"label.js.html","title":"Source: label.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: label.js /* * Copyright (c) 2015-2017, Michael A. Updike All rights reserved. * Licensed under the BSD-3-Clause * https://opensource.org/licenses/BSD-3-Clause * https://github.com/opus1269/photo-screen-saver/blob/master/LICENSE.md */ (function(window) { 'use strict'; new ExceptionHandler(); /** * A Label for a {@link ClipItem} * @constructor * @alias Label * @param {string} name - label name * @property {int} _id - database PK */ const Label = function(name) { this.name = name; }; /** * Get the PK for our name * @returns {Promise&lt;int|null&gt;} database PK or null if name not found */ Label.prototype.getId = function() { return app.DB.labels().where('name').equals(this.name).first((label) =&gt; { if (label !== undefined) { return Promise.resolve(label._id); } return Promise.resolve(null); }); }; /** * Update our name * @param {string} name * @returns {Promise&lt;boolean&gt;} true if database updated */ Label.prototype.setName = function(name) { this.name = name; const db = app.DB.get(); return db.transaction('rw', app.DB.labels(), app.DB.clips(), () =&gt; { return app.DB.labels().update(this._id, this); }); }; /** * Save to database * @returns {Promise&lt;int&gt;} database PK */ Label.prototype.save = function() { const db = app.DB.get(); return db.transaction('rw', app.DB.labels(), app.DB.clips(), () =&gt; { return app.DB.labels().put(this); }); }; /** * Delete from database * @returns {Promise&lt;void&gt;} void */ Label.prototype.delete = function() { const db = app.DB.get(); return db.transaction('rw', app.DB.labels(), app.DB.clips(), () =&gt; { return app.DB.labels().delete(this._id); }); }; /** * Error indicating that {@link Label} name is null or all whitespace * @const * @type {string} */ Label.ERROR_EMPTY_TEXT = 'Text is only whitespace'; /** * Error indicating that {@link Label} is already in database * @const * @type {string} */ Label.ERROR_EXISTS = 'Label exists.'; /** * Add a new {@link Label} to database * @param {string} name - The text of the label * @returns {Promise&lt;Label&gt;} A new {@link Label} */ Label.add = function(name) { const db = app.DB.get(); return db.transaction('rw', app.DB.labels(), app.DB.clips(), () =&gt; { if (Chrome.Utils.isWhiteSpace(name)) { return Promise.reject(new Error(Label.ERROR_EMPTY_TEXT)); } const label = new Label(name); return label.getId().then((id) =&gt; { if (id) { return Promise.reject(new Error(Label.ERROR_EXISTS)); } return label.save(); }).then(() =&gt; { return Promise.resolve(label); }); }); }; /** * Return true is there are no stored {@link Label} objects * @returns {Promise&lt;boolean&gt;} true if no {@link Label} objects */ Label.isTableEmpty = function() { return app.DB.labels().count().then((count) =&gt; { return Promise.resolve(!count); }); }; /** * Return all the {@link Label} objects from storage * @returns {Promise&lt;Array&gt;} Array of {@link Label} objects */ Label.loadAll = function() { return app.DB.labels().orderBy('name').toArray(); }; window.app = window.app || {}; window.app.Label = Label; })(window); × Search results Close "},"labels-dialog.js.html":{"id":"labels-dialog.js.html","title":"Source: labels-dialog.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: labels-dialog.js 'use strict'; new ExceptionHandler(); /** * Polymer dialog to select from a list of labels * @namespace LabelsDialog */ Polymer({ is: 'labels-dialog', properties: { /** * Dialog title * @memberOf LabelsDialog */ dialogTitle: { type: String, value: 'Select labels', notify: true, }, /** * Array of all {@link Label} objects * @memberOf LabelsDialog */ labels: { type: Array, value: [], notify: true, }, /** * Array of selected {@link Label} names * @memberOf LabelsDialog */ selectedLabels: { type: Array, value: [], notify: true, }, }, /** * Show the dialog * @private * @memberOf LabelsDialog */ open: function() { app.Label.loadAll().then((labels) =&gt; { labels = labels || []; this.splice('labels', 0, this.labels.length); if (labels.length) { this.push('labels', ...labels); } this.$.dialog.open(); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'LabelsDialog._open', 'Failed to load labels'); }); }, /** * Hide the dialog * @private * @memberOf LabelsDialog */ close: function() { this.$.dialog.close(); }, }); × Search results Close "},"pages_labels-page.js.html":{"id":"pages_labels-page.js.html","title":"Source: pages/labels-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/labels-page.js (function(window) { 'use strict'; new ExceptionHandler(); window.app = window.app || {}; /** * Polymer element to manage our {@link Label} objects * @namespace LabelsPage */ app.LabelsPageFactory = Polymer({ is: 'labels-page', /** * A list item * @typedef {{}} LabelsPage.Item * @property {Label} label * @property {string} newName * @memberOf LabelsPage */ properties: { /** * The text in the Add textInput * @memberOf LabelsPage */ addText: { type: String, value: '', notify: true, observer: '_addTextChanged', }, /** * The Array of list objects * @typedef {LabelsPage.Item[]} LabelsPage.Items * @memberOf LabelsPage */ items: { type: Array, value: [], notify: true, }, }, observers: [ '_itemsChanged(items.*)', ], /** * We have animated in and are now the current page * @memberOf LabelsPage */ onCurrentPage: function() { this.set('addText', ''); this._loadLabels(); }, /** * Event: Add text button tapped * @private * @memberOf LabelsPage */ _onAddTapped: function() { this._addLabel(); }, /** * Event: Add text key up * @param {Event} event - key-up event * @private * @memberOf LabelsPage */ _onAddKeyUp: function(event) { if (event.keyCode === 13) { // 'enter' was pressed this._addLabel(); } }, /** * Event: Delete button tapped for a label * @param {Event} event * @param {{}} event.model * @private * @memberOf LabelsPage */ _onDeleteTapped: function(event) { Chrome.GA.event(Chrome.GA.EVENT.BUTTON, 'LabelsPage.delete'); const item = event.model.item; item.label.delete().then(() =&gt; { const idx = this.items.findIndex((itm) =&gt; { return itm.label.name === item.label.name; }); if (idx !== -1) { this.splice('items', idx, 1); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'LabelsPage._onDeleteTapped', 'Failed to delete label'); }); }, /** * Event: Label input lost focus * @param {Event} event * @param {{}} event.model * @private * @memberOf LabelsPage */ _onListItemBlur: function(event) { this._updateListLabel(event.model.item); }, /** * Event: Label input key up * @param {Event} event * @param {{}} event.model * @private * @memberOf LabelsPage */ _onListItemKeyUp: function(event) { if (event.keyCode === 13) { // 'enter' was pressed this._updateListLabel(event.model.item); } }, /** * Load the Labels from the database * @private * @memberOf LabelsPage */ _loadLabels: function() { // clear list this.splice('items', 0, this.items.length); // populate list app.Label.loadAll().then((labels) =&gt; { labels.forEach((label) =&gt; { this.push('items', { label: label, newName: label.name, }); }); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'LabelPage._loadLabels'); }); }, /** * Sort filter for the Labels - alphabetical * @param {LabelsPage.Item} a - first comparator * @param {LabelsPage.Item} b - second comparator * @returns {int} * @private * @memberOf LabelsPage */ _sortByName: function(a, b) { const aName = a.label.name.toLowerCase(); const bName = b.label.name.toLowerCase(); if (aName &lt; bName) { return -1; } else if (aName &gt; bName) { return 1; } else { return 0; } }, /** * Add a new label * @private * @memberOf LabelsPage */ _addLabel() { Chrome.GA.event(Chrome.GA.EVENT.BUTTON, 'LabelsPage._addLabel'); let name = this.addText; name = name || ''; name = name.trim(); app.Label.add(name).then((label) =&gt; { this.push('items', { label: label, newName: label.name, }); this.set('addText', ''); return Promise.resolve(); }).catch((err) =&gt; { if ((err.message !== app.Label.ERROR_EMPTY_TEXT) &amp;&amp; (err.message !== app.Label.ERROR_EXISTS)) { Chrome.Log.error(err.message, 'LabelsPage._onAddKeyUp', 'Failed to create label'); } }); }, /** * Update an exiting label * @param {LabelsPage.Item} item * @private * @memberOf LabelsPage */ _updateListLabel(item) { Chrome.GA.event(Chrome.GA.EVENT.BUTTON, 'LabelsPage._updateListLabel'); let name = item.newName.trim(); name = name || ''; const idx = this.items.findIndex((el) =&gt; { return el.label.name === item.label.name; }); if (name.length) { if (idx !== -1) { this.set(`items.${idx}.label.name`, name); this.set(`items.${idx}.newName`, name); } item.label.setName(name).catch((err) =&gt; { Chrome.Log.error(err.message, 'LabelsPage._updateListLabel', 'Failed to update label name'); }); } else { if (idx !== -1) { this.set(`labels.${idx}.newName`, item.label.name); } } }, /** * Observer: {@link LabelsPage.addText} changed * @private * @memberOf LabelsPage */ _addTextChanged() { if (Chrome.Utils.isWhiteSpace(this.addText)) { this.$.addButton.setAttribute('disabled', 'true'); } else { this.$.addButton.removeAttribute('disabled'); } }, /** * Observer: {@link LabelsPage.items} changed * @param {{}} changeRecord - details of change * @private * @memberOf LabelsPage */ _itemsChanged(changeRecord) { if (changeRecord) { let path = changeRecord.path; let base = changeRecord.base; let itemPath; // handle paths like 'users.#4.newName' const newNameIdx = path.indexOf('.newName'); const labelNameIdx = path.indexOf('.label.name'); if (newNameIdx !== -1) { itemPath = path.substring(0, newNameIdx); } else if (labelNameIdx) { itemPath = path.substring(0, labelNameIdx); } if (itemPath) { const item = this.get(itemPath); const index = base.indexOf(item); const newName = base[index].newName; const label = base[index].label; const el = document.getElementById(`delete${index}`); if (el &amp;&amp; (newName !== label.name)) { el.setAttribute('disabled', 'true'); } else if (el) { el.removeAttribute('disabled'); } } } }, }); })(window); × Search results Close "},"main_main.js.html":{"id":"main_main.js.html","title":"Source: main/main.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: main/main.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * Script for the main.html page * @namespace Main */ new ExceptionHandler(); const chromep = new ChromePromise(); /** * Path to the extension in the Web Store * @type {string} * @const * @memberOf Main */ const EXT_URI = `https://chrome.google.com/webstore/detail/${chrome.runtime.id}/`; /** * Path to the android app in the Play Store * @type {string} * @const * @memberOf Main */ const ANDROID_URI = 'https://play.google.com/store/apps/details' + '?id=com.weebly.opus1269.clipman'; /** * Path to my screen saver extension * @type {string} * @const * @memberOf Main */ const SCREEN_SAVER_URI = 'https://chrome.google.com/webstore/detail/photo-screen-saver/' + 'kohpcmlfdjfdggcjmjhhbcbankgmppgc'; /** * Auto-binding template * @type {Object} * @const * @memberOf Main */ const t = document.querySelector('#t'); /** * Manage an html page that is inserted on demand&lt;br&gt; * May also be a url link to external site * @typedef {{}} Main.page * @property {string} label - label for Nav menu * @property {string} route - element name route to page * @property {string} icon - icon for Nav Menu * @property {?Object|Function} obj - something to be done when selected * @property {boolean} ready - true if html is inserted * @property {?Function} factory - function to build page * @property {?string} insertion - id of insertion point * @property {?Element} el - Polymer element * @property {boolean} divider - true for divider before item * @memberOf Main */ /** * Array of {@link Main.page} objects * @type {Main.page[]} * @const * @memberOf Main */ t.pagesOne = [ { label: 'Clips', route: 'page-main', icon: 'myicons:content-paste', ready: true, divider: false, obj: null, insertion: null, el: null, }, { label: 'Manage account', route: 'page-signin', icon: 'myicons:account-circle', ready: false, divider: false, obj: app.SignInPageFactory, insertion: 'signInInsertion', el: null, }, { label: 'Manage devices', route: 'page-devices', icon: 'myicons:phonelink', ready: false, divider: false, obj: app.DevicesPageFactory, insertion: 'devicesInsertion', el: null, }, { label: 'Manage labels', route: 'page-labels', icon: 'myicons:label', ready: false, divider: false, obj: app.LabelsPageFactory, insertion: 'labelsInsertion', el: null, }, ]; /** * Array of {@link Main.page} objects * @type {Main.page[]} * @const * @memberOf Main */ t.pagesTwo = [ { label: 'Settings', route: 'page-settings', icon: 'myicons:settings', ready: false, divider: true, obj: app.SettingsPageFactory, insertion: 'settingsInsertion', el: null, }, { label: 'Manage optional permissions', route: 'page-permissions', icon: 'myicons:perm-data-setting', ready: true, divider: false, obj: _showPermissionsDialog, insertion: null, el: null, }, { label: 'View last error', route: 'page-error', icon: 'myicons:error', ready: false, divider: false, obj: app.ErrorPageFactory, insertion: 'errorInsertion', el: null, }, { label: 'Help &amp; feedback', route: 'page-help', icon: 'myicons:help', ready: false, divider: true, obj: app.HelpPageFactory, insertion: 'helpInsertion', el: null, }, { label: 'Get android app', route: 'page-android', icon: 'myicons:android', ready: true, divider: false, el: null, obj: ANDROID_URI, insertion: null, }, { label: 'Rate extension', route: 'page-rate', icon: 'myicons:grade', ready: true, divider: false, obj: `${EXT_URI}reviews`, insertion: null, el: null, }, { label: 'Try Photo Screen Saver', route: 'page-screensaver', icon: 'myicons:extension', ready: true, divider: true, obj: SCREEN_SAVER_URI, insertion: null, el: null, }, ]; /** * Array of {@link Main.page} objects for the {@link Label} objects * @type {Main.page[]} * @memberOf Main */ t.pagesLabels = []; /** * Error dialog title * @type {string} * @memberOf Main */ t.dialogTitle = ''; /** * Error dialog text * @type {string} * @memberOf Main */ t.dialogText = ''; /** * Current route * @type {string} * @memberOf Main */ t.route = 'page-main'; /** * Content Script permission * @type {string} * @memberOf Main */ t.permissions = Chrome.Storage.get('permissions'); /** * User photo * @type {string} * @memberOf Main */ t.avatar = Chrome.Storage.get('photoURL'); /** * Array concatenation of {@link Main.page} objects * @type {Main.page[]} * @alias Main.pages * @memberOf Main */ let pages = []; /** * Previous route * @type {string} * @memberOf Main */ let prevRoute = ''; /** * Route to use on tab highlight, blank keep current * @type {string} * @memberOf Main */ let onHighlightRoute = ''; /** * Event: Template Bound, bindings have resolved and content has been * stamped to the page * @memberOf Main */ function _onDomChange() { // concatenate all the pages for the main menu _buildPages().then(() =&gt; { // initialize menu states _setDevicesMenuState(); _setErrorMenuState(); // select menu t.$.mainMenu.select(t.route); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Main._buildPages'); }); // listen for Chrome messages Chrome.Msg.listen(_onChromeMessage); // listen for changes to localStorage addEventListener('storage', _onStorageChanged, false); // listen for changes to chrome.storage chrome.storage.onChanged.addListener(_onChromeStorageChanged); // listen for messages from the service worker navigator.serviceWorker.addEventListener('message', _onSWMessage); // listen for changes to highlighted tabs chrome.tabs.onHighlighted.addListener(_onHighlighted); // check for optional permissions _checkOptionalPermissions(); } /** * Event: Document and resources loaded * @memberOf Main */ function _onLoad() { // track usage Chrome.GA.page('/main.html'); const db = app.DB.get(); db.labels.hook('creating', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { const name = obj.name; if (_getPagesLabelsIdx(name) === -1) { const newPage = { label: name, route: `page-main-labeled#${name}`, icon: 'myicons:label', ready: true, divider: false, obj: null, insertion: null, el: null, }; pages.push(newPage); t.push('pagesLabels', newPage); } }; }); db.labels.hook('updating', function(mods, primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { if (mods.hasOwnProperty('name')) { // 'name' property is being updated if (typeof mods.name === 'string') { // change not delete const name = obj.name; const newName = mods.name; const idx = _getPagesLabelsIdx(name); t.set(`pagesLabels.${idx}.label`, newName); } } }; }); db.labels.hook('deleting', function(primKey, obj) { // eslint-disable-next-line no-invalid-this this.onsuccess = function() { const name = obj.name; let idx = pages.findIndex((page) =&gt; { return page.label === name; }); pages.splice(idx, 1); idx = t.pagesLabels.findIndex((page) =&gt; { return page.label === name; }); t.splice('pagesLabels', idx, 1); }; }); } /** * Event: navigation menu selected * @param {Event} event * @memberOf Main */ t._onNavMenuItemTapped = function(event) { // Close drawer after menu item is selected _closeDrawer(); prevRoute = t.route; const idx = _getPageIdx(event.currentTarget.id); const page = pages[idx]; Chrome.GA.event(Chrome.GA.EVENT.MENU, page.route); if (!page.obj) { // some pages are just pages if (page.route === 'page-main') { t.$.mainPage.setLabelFilter(); t.route = page.route; } else if (page.route.includes('page-main-labeled#')) { // a filtered page-main t.$.mainPage.setLabelFilter(page.label); t.route = 'page-main'; } else { t.route = page.route; } _scrollPageToTop(); } else if (typeof page.obj === 'string') { // some pages are url links t.$.mainMenu.select(prevRoute); chrome.tabs.create({url: page.obj}); } else { // some pages have functions to view them _showPage(page); } }; /** * Event: display error dialog * @param {Event} event * @memberOf Main */ t._onShowErrorDialog = function(event) { t.dialogTitle = event.detail.title; t.dialogText = event.detail.text; t.$.errorDialog.open(); }; /** * Event: Selected {@link Main.page} changed * @param {Event} event * @memberOf Main */ t._onPageChanged = function(event) { if (event.srcElement !== t.$.animatedPages) { return; } // leaving page switch (prevRoute) { case 'page-main': t.$.mainPage.onLeavePage(); break; default: break; } // entering page const idx = _getPageIdx(t.route); const page = pages[idx]; switch (t.route) { case 'page-main': t.$.mainPage.onCurrentPage(); break; case 'page-signin': case 'page-devices': case 'page-labels': page.el.onCurrentPage(); break; default: break; } }; /** * Event: Clicked on accept permissions dialog button * @memberOf Main */ t._onAcceptPermissionsClicked = function() { app.Permissions.request().then((granted) =&gt; { t.permissions = Chrome.Storage.get('permissions'); if (granted) { app.Permissions.injectContentScripts(); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Main._onAcceptPermissionsClicked'); }); }; /** * Event: Clicked on deny permissions dialog button * @memberOf Main */ t._onDenyPermissionsClicked = function() { app.Permissions.remove().then(() =&gt; { t.permissions = Chrome.Storage.get('permissions'); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'Main._onDenyPermissionsClicked'); }); }; /** * Event: Sort the label pages alphabetically * @param {Main.page} pageA * @param {Main.page} pageB * @returns {int} 0 if same, -1 if lower, 1 if higher * @memberOf Main */ t._onSortLabelPages = function(pageA, pageB) { const a = pageA.label.toLowerCase(); const b = pageB.label.toLowerCase(); if (a &lt; b) { return -1; } if (a &gt; b) { return 1; } return 0; }; /** * Computed Binding: Determine content script permission status string * @param {string} permissions - current setting * @returns {string} * @memberOf Main */ t._computePermissionsStatus = function(permissions) { return `Current Status: ${permissions}`; }; /** * Computed Binding: Determine if avatar should be visible * @param {string} avatar - photo url * @returns {string} display type * @memberOf Main */ t._computeAvatarDisplay = function(avatar) { let ret = 'inline'; if (Chrome.Utils.isWhiteSpace(avatar)) { ret = 'none'; } return ret; }; /** * Event: Fired when a message is posted from out service worker * @param {Event} event * @memberOf Main */ function _onSWMessage(event) { if (event.data.message === 'route') { // highlight ourselves if needed, and set the current route onHighlightRoute = event.data.route; chromep.tabs.getCurrent().then((tab) =&gt; { if (!tab.highlighted) { chromep.tabs.update(tab.id, {'highlighted': true}); } else { // already highlighted, set route _setHighlightRoute(); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Main._onSWMessage'); }); } } // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @memberOf Main */ function _onChromeMessage(request, sender, response) { if (request.message === Chrome.Msg.HIGHLIGHT.message) { onHighlightRoute = request.item; // highlight ourselves and let the sender know we are here chromep.tabs.getCurrent().then((tab) =&gt; { if (!tab.highlighted) { chromep.tabs.update(tab.id, {'highlighted': true}); } else { // already highlighted, set route _setHighlightRoute(); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(`${request.message}: ${err.message}`, 'chromep.tabs.getCurrent'); }); response(JSON.stringify({message: 'OK'})); } else if (request.message === app.ChromeMsg.MSG_FAILED.message) { t.dialogTitle = 'Failed to send push notification'; t.dialogText = request.error; t.$.errorDialog.open(); } } /** * Event: Fired when item in localStorage changes * @see https://developer.mozilla.org/en-US/docs/Web/Events/storage * @param {Event} event - storage event * @param {string} event.key - value that changed * @memberOf Main */ function _onStorageChanged(event) { if (event.key === 'signedIn') { _setDevicesMenuState(); } else if (event.key === 'photoURL') { t.avatar = Chrome.Storage.get('photoURL'); } } /** * Event: Fired when changes occur in Chrome.storage * @see https://developer.chrome.com/apps/storage * @param {Array} changes - storage changes * @memberOf Main */ function _onChromeStorageChanged(changes) { for (const change in changes) { if (changes.hasOwnProperty(change)) { if (change === 'lastError') { _setErrorMenuState(); break; } } } } /** * Event: Fired when the highlighted or selected tabs in a window changes. * @see https://developer.chrome.com/extensions/tabs#event-onHighlighted * @param {Object} highlightInfo - info * @memberOf Main */ function _onHighlighted(highlightInfo) { const tabIds = highlightInfo.tabIds; chromep.tabs.getCurrent().then((tab) =&gt; { for (let i = 0; i &lt; tabIds.length; i++) { const tabId = tabIds[i]; if (tabId === tab.id) { // our tab _setHighlightRoute(); break; } } return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Main._onHighlighted'); }); } /** * Set the route from onHighlightRoute * @memberOf Main */ function _setHighlightRoute() { if (Chrome.Utils.isWhiteSpace(onHighlightRoute)) { // don't change route // if sign-in page is current, give it a chance to recheck its permissions if (t.route === 'page-signin') { const idx = _getPageIdx(t.route); const page = pages[idx]; page.el.onCurrentPage(); } return; } prevRoute = t.route; const idx = _getPageIdx(onHighlightRoute); const page = pages[idx]; if (onHighlightRoute === 'page-main') { t.$.mainPage.setLabelFilter(); } else { _showPage(page); } t.route = onHighlightRoute; t.$.mainMenu.select(onHighlightRoute); _scrollPageToTop(); onHighlightRoute = ''; } /** * Get the index into the {@link Main.pages} array * @param {string} route - {@link Main.page} route * @returns {int} index into array, -1 if not found * @memberOf Main */ function _getPageIdx(route) { return pages.findIndex((page) =&gt; { return page.route === route; }); } /** * Get the index into the label pages array * @param {string} label - {@link Main.page} route * @returns {int} index into array, -1 if not found * @memberOf Main */ function _getPagesLabelsIdx(label) { return t.pagesLabels.findIndex((page) =&gt; { return page.label === label; }); } /** * Show a {@link Main.page} * @param {Main.page} page * @memberOf Main */ function _showPage(page) { if (page.insertion) { if (!page.ready) { // insert the page the first time page.ready = true; // eslint-disable-next-line new-cap page.el = new page.obj(); const insertEl = document.getElementById(page.insertion); Polymer.dom(insertEl).appendChild(page.el); } t.route = page.route; _scrollPageToTop(); } else { page.obj(); } } /** * Display dialog to prompt for accepting optional permissions * if it has not been set yet * @memberOf Main */ function _checkOptionalPermissions() { if (Chrome.Storage.get('permissions') === app.Permissions.NOT_SET) { _showPermissionsDialog(); } } /** * Show the permissions dialog * @memberOf Main */ function _showPermissionsDialog() { t.$.permissionsDialog.open(); } /** * Scroll Main Panel to top * @memberOf Main */ function _scrollPageToTop() { t.$.mainPanel.scroller.scrollTop = 0; } /** * Close drawer if drawerPanel is narrow * @memberOf Main */ function _closeDrawer() { const drawerPanel = document.querySelector('#paperDrawerPanel'); if (drawerPanel.narrow) { drawerPanel.closeDrawer(); } } /** * Build the menu items * @returns {Promise&lt;void&gt;} * @memberOf Main */ function _buildPages() { pages = t.pagesOne; return _getLabelPages().then((labelPages) =&gt; { labelPages = labelPages || []; t.set('pagesLabels', labelPages); pages = pages.concat(t.pagesLabels); pages = pages.concat(t.pagesTwo); return Promise.resolve(); }); } /** * Build the menu items for {@link Label} objects * @returns {Promise&lt;Main.page[]&gt;} * @memberOf Main */ function _getLabelPages() { return app.Label.loadAll().then((labels) =&gt; { labels = labels || []; const pages = []; labels.forEach((label) =&gt; { pages.push({ label: label.name, route: `page-main-labeled#${label.name}`, icon: 'myicons:label', ready: true, divider: false, obj: null, insertion: null, el: null, }); }); return Promise.resolve(pages); }); } /** * Set enabled state of Devices menu item * @memberOf Main */ function _setDevicesMenuState() { // disable devices-page if not signed in const idx = _getPageIdx('page-devices'); const el = document.getElementById(pages[idx].route); if (el &amp;&amp; app.Utils.isSignedIn()) { el.removeAttribute('disabled'); } else if (el) { el.setAttribute('disabled', 'true'); } } /** * Set enabled state of Error Viewer menu item * @memberOf Main */ function _setErrorMenuState() { // disable error-page if no lastError Chrome.Storage.getLastError().then((lastError) =&gt; { const idx = _getPageIdx('page-error'); const el = document.getElementById(pages[idx].route); if (el &amp;&amp; !Chrome.Utils.isWhiteSpace(lastError.message)) { el.removeAttribute('disabled'); } else if (el) { el.setAttribute('disabled', 'true'); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.GA.error(err.message, 'Main._setErrorMenuState'); }); } // listen for dom-change t.addEventListener('dom-change', _onDomChange); // listen for documents and resources loaded window.addEventListener('load', _onLoad); })(window); × Search results Close "},"background_receive_msg.js.html":{"id":"background_receive_msg.js.html","title":"Source: background/receive_msg.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: background/receive_msg.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * Handle incoming push messages * @namespace ReceiveMsg */ new ExceptionHandler(); /** * Delay time for fcm message processing * @type {int} * @default * @const * @private * @memberOf ReceiveMsg */ const MESSAGE_WAIT_MILLIS = 500; /** * Get new {@link Device} from {@link app.Msg.GaeMsg} * @param {app.Msg.GaeMsg} data - push data * @returns {Device} a {@link Device} * @private * @memberOf ReceiveMsg */ function _getDevice(data) { return new app.Device(data.dM, data.dSN, data.dOS, data.dN, Date.now()); } /** * Process received push notifications * @param {app.Msg.GaeMsg} data - push message * @private * @memberOf ReceiveMsg */ function _process(data) { const device = _getDevice(data); if (!app.Utils.isSignedIn() || device.isMe()) { // don't handle our messages or if we are signed out return; } Chrome.GA.event(app.GA.EVENT.RECEIVED); try { data.m = decodeURIComponent(data.m); } catch (ex) { const msg = `Caught: ReceiveMsg._process ${ex.message} ${data.m}`; Chrome.Log.exception(ex, msg); } if (data.act === app.Msg.ACTION.MESSAGE) { // received remote ClipItem app.Devices.add(device); const fav = (data.fav === '1'); // persist app.ClipItem.add(data.m, Date.now(), fav, true, device.getName(), true).then(() =&gt; { // save to clipboard app.CB.copyToClipboard(data.m); return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'ReceiveMsg._process'); }); } else if (data.act === app.Msg.ACTION.PING) { // we were pinged app.Devices.add(device); // respond to ping app.Msg.sendPingResponse(data.srcRegId).catch((err) =&gt; { app.Msg.sendFailed(err); }); } else if (data.act === app.Msg.ACTION.PING_RESPONSE) { // someone is around app.Devices.add(device); } else if (data.act === app.Msg.ACTION.DEVICE_ADDED) { // someone new is here app.Devices.add(device); } else if (data.act === app.Msg.ACTION.DEVICE_REMOVED) { // someone went away app.Devices.remove(device); } } /** * Event: Fired when a Web request is about to occur. * Capture the Service Worker request and process messages * @see https://goo.gl/4j4RtY * @param {Object} details - details on the request * @returns {Object} cancel the request * @private * @memberOf ReceiveMsg */ function _onWebRequestBefore(details) { let url = details.url; try { url = decodeURI(url); } catch (ex) { const msg = `Caught: ReceiveMsg._onWebRequestBefore ${ex.message}`; Chrome.Log.exception(ex, msg); } const regex = /https:\\/\\/pushy-clipboard\\.github\\.io\\/\\?(.*)/; let text; const matches = url.match(regex); if (matches &amp;&amp; (matches.length &gt; 1)) { text = matches[1]; } if (text) { let dataArray = null; try { dataArray = JSON.parse(text); } catch (ex) { const msg = `Caught: ReceiveMsg._onWebRequestBefore ${ex.message}`; Chrome.Log.exception(ex, msg); } if (dataArray) { for (let i = 0; i &lt; dataArray.length; i++) { (function(index) { setTimeout(function() { // slow down message stream _process(dataArray[index]); }, MESSAGE_WAIT_MILLIS); })(i); } } // cancel fake request return {cancel: true}; } } // Listen for web requests chrome.webRequest.onBeforeRequest.addListener(_onWebRequestBefore, { urls: ['https://pushy-clipboard.github.io/*'], }, ['blocking']); })(); × Search results Close "},"sw.js.html":{"id":"sw.js.html","title":"Source: sw.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: sw.js /* * Copyright (c) 2016-2017, Michael A. Updike All rights reserved. * Licensed under Apache 2.0 * https://opensource.org/licenses/Apache-2.0 * https://goo.gl/wFvBM1 */ (function() { 'use strict'; /** * Service Worker to handle push notifications * @namespace ServiceWorker */ /** * Fake fetch base path * @const * @type {string} * @memberOf ServiceWorker */ const URL_FETCH_BASE = 'https://pushy-clipboard.github.io/?'; /** * Google search base path * @const * @type {string} * @memberOf ServiceWorker */ const URL_SEARCH_BASE = 'https://www.google.com/search?q='; /** * Path to extension's main page * @const * @type {string} * @memberOf ServiceWorker */ const URL_EXT = 'chrome-extension://jemdfhaheennfkehopbpkephjlednffd/html/main.html'; /** @memberOf ServiceWorker */ const TAG_MESSAGE = 'tag-message'; /** @memberOf ServiceWorker */ const TAG_DEVICE = 'tag-device'; /** @memberOf ServiceWorker */ const ACTION_MESSAGE = 'm'; /** @memberOf ServiceWorker */ const ACTION_DEVICE_REMOVED = 'remove_our_device'; /** @memberOf ServiceWorker */ const IC_REMOTE_COPY = '../images/ic_remote_copy.png'; /** @memberOf ServiceWorker */ const IC_ADD_DEVICE = '../images/ic_add_device.png'; /** @memberOf ServiceWorker */ const IC_REMOVE_DEVICE = '../images/ic_remove_device.png'; /** @memberOf ServiceWorker */ const IC_SEARCH = '../images/search-web.png'; /** @memberOf ServiceWorker */ const FAKE_FETCH_DONE = 'Fake fetch done'; /** * Temporary variable to help get all messages at Chrome start-up * Normally, can't use globals in service worker, but this is * only used when Chrome first starts up. Pretty sure it won't be * stopped during this time * could use indexedDB if we really have to * @memberOf ServiceWorker */ let msgArr = []; /** * Service Worker Events * @typedef {Event} SWEvent * @property {Function} waitUntil(Promise) - wait till promise returns * @property {Object} notification - notification * @property {Object} action - notification action * @memberOf ServiceWorker */ /** * Get the name of the Device who sent the message * @param {app.Msg.GaeMsg} data - message object * @returns {string} device name * @memberOf ServiceWorker */ function getDeviceName(data) { let name; if (data.dN) { name = data.dN; } else { name = `${data.dM} - ${data.dSN} - ${data.dOS}`; } return name; } /** * Get the tag for the notification * @param {app.Msg.GaeMsg} data - message object * @returns {string} notification tag * @memberOf ServiceWorker */ function getTag(data) { let tag = TAG_DEVICE; if (data.act === ACTION_MESSAGE) { tag = TAG_MESSAGE; } return tag; } /** * Get the icon for the notification * @param {app.Msg.GaeMsg} data - message object * @returns {string} path to icon * @memberOf ServiceWorker */ function getIcon(data) { let path = IC_ADD_DEVICE; if (data.act === ACTION_MESSAGE) { path = IC_REMOTE_COPY; } else if (data.act === ACTION_DEVICE_REMOVED) { path = IC_REMOVE_DEVICE; } return path; } /** * Post a message about the page route to display * @param {Object} client - our client window * @param {string} icon - notification icon * @returns {Promise&lt;void&gt;} void * @memberOf ServiceWorker */ function postRouteMessage(client, icon) { return client.postMessage({ message: 'route', route: getPageRoute(icon), }); } /** * Get the page route from the icon * @param {string} icon - notification icon * @returns {string} path to icon * @memberOf ServiceWorker */ function getPageRoute(icon) { let page = 'page-devices'; if (icon.includes('ic_remote_copy.png')) { page = 'page-main'; } return page; } /** * Send any data attached to a notification to the extension * @param {app.Msg.GaeMsg[]} dataArray * - possible array of {@link app.Msg.GaeMsg} objects * @returns {Promise&lt;void&gt;} always resolves * @memberOf ServiceWorker */ function sendNotificationData(dataArray) { if (dataArray instanceof Array) { return doFakeFetch(dataArray).catch(() =&gt; {}); } else { return Promise.resolve(); } } /** * Send fake GET request so extension can intercept it and get the payload * @see https://bugs.chromium.org/p/chromium/issues/detail?id=452942 * @param {app.Msg.GaeMsg[]} dataArray Array of {@link app.Msg.GaeMsg} objects * @returns {Promise&lt;void&gt;} fails if extension successfully canceled request * @memberOf ServiceWorker */ function doFakeFetch(dataArray) { msgArr = []; let URL_FETCH = URL_FETCH_BASE + JSON.stringify(dataArray); URL_FETCH = encodeURI(URL_FETCH); return fetch(URL_FETCH, {method: 'GET'}).catch(() =&gt; { return Promise.reject(new Error(FAKE_FETCH_DONE)); }); } /** * Event: Received push message * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onPushReceived(event) { const payload = event.data.json(); const data = payload.data; let body; try { body = decodeURIComponent(data.m); } catch (ex) { // noinspection BadExpressionStatementJS () =&gt; {}; } const tag = getTag(data); const noteOpt = { requireInteraction: (tag === TAG_MESSAGE), body: body, icon: getIcon(data), tag: tag, timestamp: Date.now(), data: null, }; if ((tag === TAG_MESSAGE)) { // add web search action for regular messages noteOpt.actions = [ { action: 'search', title: 'Search web', icon: IC_SEARCH, }]; } let title = `From: ${getDeviceName(data)}`; const promiseChain = self.registration.getNotifications({tag: tag}).then((notifications) =&gt; { if ((notifications.length &gt; 0)) { // append to existing displayed notification noteOpt.renotify = true; const noteData = notifications[0].data; if (noteData instanceof Array) { // data is in the notification // add current and send all to extension noteData.push(data); // eslint-disable-next-line promise/no-nesting return sendNotificationData(noteData).then(() =&gt; { title = `\\n${noteData.length} new items`; // set data back to item count noteOpt.data = noteData.length; // simulate doFakeFetch cancel error throw new Error(FAKE_FETCH_DONE); }); } else { // count of notifications noteOpt.data = notifications[0].data + 1; title = `${noteOpt.data} new items`; } } else { // new notification noteOpt.data = 1; } // send data to extension return doFakeFetch([data]); }).then(() =&gt; { // Extension did not cancel the fake fetch // add data to the notification instead // this is necessary for Chrome OS at startup at least if (tag === TAG_MESSAGE) { msgArr.push(data); if (msgArr.length &gt; 1) { title += `\\n${msgArr.length} new items`; } // shallow copy noteOpt.data = JSON.parse(JSON.stringify(msgArr)); } return self.registration.showNotification(title, noteOpt); }).catch((err) =&gt; { if (err.message === FAKE_FETCH_DONE) { // This is the normal outcome of the extension canceling // the fake fetch return self.registration.showNotification(title, noteOpt); } console.error('Unexpected error in push event: ', err); return Promise.reject(err); }); event.waitUntil(promiseChain); } /** * Event: Notification clicked. * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onNotificationClick(event) { event.notification.close(); if (event.action === 'search') { // clicked on search action if (clients.openWindow) { const searchUrl = URL_SEARCH_BASE + encodeURIComponent(event.notification.body); clients.openWindow(searchUrl); } return; } let wClients; const promiseChain = clients.matchAll({ includeUncontrolled: true, type: 'window', }).then((windowClients) =&gt; { wClients = windowClients; return sendNotificationData(event.notification.data); }).then(() =&gt; { for (let i = 0; i &lt; wClients.length; i++) { const client = wClients[i]; if ((client.url === URL_EXT) &amp;&amp; 'focus' in client) { // tab exists // Send a message to the client to route to correct page return postRouteMessage(client, event.notification.icon); } } if (clients.openWindow) { // create our main page return clients.openWindow(URL_EXT); } return Promise.resolve(); }).catch(() =&gt; {}); event.waitUntil(promiseChain); } /** * Event: Notification closed - can't open or focus window here. * @param {SWEvent} event - the event * @memberOf ServiceWorker */ function onNotificationClose(event) { event.waitUntil( sendNotificationData(event.notification.data).catch(() =&gt; {})); } // Listen for install events self.addEventListener('install', (event) =&gt; { event.waitUntil(self.skipWaiting()); }); // Listen for activate events self.addEventListener('activate', (event) =&gt; { event.waitUntil(self.clients.claim()); }); // Listen for push events self.addEventListener('push', onPushReceived); // Listen for notificationclick events self.addEventListener('notificationclick', onNotificationClick); // Listen for notificationclose events self.addEventListener('notificationclose', onNotificationClose); })(); × Search results Close "},"setting-background_setting-background.js.html":{"id":"setting-background_setting-background.js.html","title":"Source: setting-background/setting-background.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-background/setting-background.js 'use strict'; new ExceptionHandler(); /** * Polymer element to select an HTML element background style * @namespace SettingBackground */ Polymer({ is: 'setting-background', behaviors: [ Chrome.LocalizeBehavior, ], properties: { /** * Local storage key * @memberOf SettingBackground */ name: { type: String, value: 'store', }, /** * Optional group title * @memberOf SettingBackground */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingBackground */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingBackground */ noseparator: { type: Boolean, value: false, }, /** * Element id of currently selected background style * @type {string} * @memberOf SettingBackground */ selected: { type: String, value: 'b1', notify: true, }, /** * Local storage value of currently selected background style * @memberOf SettingBackground */ value: { type: String, value: 'background:linear-gradient(to bottom, #3a3a3a, #b5bdc8)', notify: true, }, /** * Item description * @memberOf SettingBackground */ mainLabel: { type: String, value: '', }, /** * Item secondary description * @memberOf SettingBackground */ secondaryLabel: { type: String, value: '', }, }, /** * Initialize value if it is not in localstorage * @private * @memberOf SettingBackground */ _init: function() { this.set('value', 'background:linear-gradient(to bottom, #3a3a3a, #b5bdc8)'); }, /** * Event: Show dialog on tap * @private * @memberOf SettingBackground */ _onTap: function() { this.$.dialog.open(); }, /** * Event: Set selected background on tap of OK button * @private * @memberOf SettingBackground */ _onOK: function() { const el = document.getElementById(this.selected); this.set('value', 'background:' + el.style.background); Chrome.GA.event(Chrome.GA.EVENT.BUTTON, `SettingBackground.OK: ${this.selected}`); }, }); × Search results Close "},"setting-dropdown_setting-dropdown.js.html":{"id":"setting-dropdown_setting-dropdown.js.html","title":"Source: setting-dropdown/setting-dropdown.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-dropdown/setting-dropdown.js 'use strict'; new ExceptionHandler(); /** * Polymer element to select an item from a list * @namespace SettingDropdown */ Polymer({ is: 'setting-dropdown', properties: { /** * Local storage key * @memberOf SettingDropdown */ name: { type: String, value: 'store', }, /** * Menu description * @memberOf SettingDropdown */ label: { type: String, value: '', }, /** * Selected menu item index * @memberOf SettingDropdown */ value: { type: Number, value: 0, notify: true, }, /** * Array of Menu item labels * @memberOf SettingDropdown */ items: { type: Array, value: function() { return []; }, }, /** * Optional group title * @memberOf SettingDropdown */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingDropdown */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingDropdown */ noseparator: { type: Boolean, value: false, }, }, /** * Event: menu item tapped * @param {Event} ev - tap event * @private * @memberOf SettingDropdown */ _onItemSelected: function(ev) { const model = this.$.t.modelForElement(ev.target); if (model) { Chrome.GA.event(Chrome.GA.EVENT.MENU, `${this.name}: ${model.index}`); } }, /** * Initialize value if it is not in localstorage * @private * @memberOf SettingDropdown */ _init: function() { this.set('value', '0'); }, }); × Search results Close "},"setting-link_setting-link.js.html":{"id":"setting-link_setting-link.js.html","title":"Source: setting-link/setting-link.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-link/setting-link.js 'use strict'; new ExceptionHandler(); /** * Polymer element to display a url link * @namespace SettingLink */ Polymer({ is: 'setting-link', properties: { /** * Element name * @memberOf SettingLink */ name: { type: String, value: 'unknown', }, /** * Link description * @memberOf SettingLink */ label: { type: String, value: '', }, /** * Link icon * @memberOf SettingLink */ icon: { type: String, value: '', }, /** * Link url * @memberOf SettingLink */ url: { type: String, value: '', }, /** * Optional group title * @memberOf SettingLink */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingLink */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingLink */ noseparator: { type: Boolean, value: false, }, }, /** * Event: Item tapped - show url in new tab * @private * @memberOf SettingLink */ _onLinkTapped: function() { Chrome.GA.event(Chrome.GA.EVENT.LINK, this.name); chrome.tabs.create({url: this.url}); }, }); × Search results Close "},"setting-slider_setting-slider.js.html":{"id":"setting-slider_setting-slider.js.html","title":"Source: setting-slider/setting-slider.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-slider/setting-slider.js 'use strict'; new ExceptionHandler(); /** * Polymer element to select a value with a slider * @namespace SettingSlider */ Polymer({ is: 'setting-slider', properties: { /** * Local storage key * @memberOf SettingSlider */ name: { type: String, value: 'store', }, /** * Slider description * @memberOf SettingSlider */ label: { type: String, value: '', }, /** * Object containing slider value and display unit index * @memberOf SettingSlider */ value: { type: Object, notify: true, value: function() { return {'base': 10, 'display': 10, 'unit': 0}; }, }, /** * Array of unit labels * @memberOf SettingSlider */ units: { type: Array, value: function() { return []; }, }, /** * Optional group title * @memberOf SettingSlider */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingSlider */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingSlider */ noseparator: { type: Boolean, value: false, }, }, /** * Event: User changed slider value * @private * @memberOf SettingSlider */ _onSliderValueChanged: function() { this._setBase(); }, /** * Event: Display unit was changed * @private * @memberOf SettingSlider */ _onUnitChanged: function() { this.$.selector.select(this.units[this.value.unit]); this._setBase(); }, /** * Set the base value * @private * @memberOf SettingSlider */ _setBase: function() { this.set('value.base', this.unit.mult * this.value.display); }, /** * Initialize value if it is not in localstorage * @private * @memberOf SettingSlider */ _initValue: function() { this.value = { base: 10, display: 10, unit: 0, }; }, }); × Search results Close "},"pages_settings-page.js.html":{"id":"pages_settings-page.js.html","title":"Source: pages/settings-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/settings-page.js (function(window) { 'use strict'; new ExceptionHandler(); const ERROR_TITLE = 'Failed to change setting'; window.app = window.app || {}; /** * Polymer element to manage extension settings * @namespace SettingsPage */ app.SettingsPageFactory = Polymer({ is: 'settings-page', /** * Element is ready * @memberOf SettingsPage */ ready: function() { // listen for chrome messages Chrome.Msg.listen(this._onChromeMessage.bind(this)); }, // noinspection JSUnusedLocalSymbols /** * Event: Fired when a message is sent from either an extension process&lt;br&gt; * (by runtime.sendMessage) or a content script (by tabs.sendMessage). * @see https://developer.chrome.com/extensions/runtime#event-onMessage * @param {Chrome.Msg.Message} request - details for the * @param {string} request.error - error message * @param {Object} sender - MessageSender object * @param {function} response - function to call once after processing * @returns {boolean} true if asynchronous * @private * @memberOf SettingsPage */ _onChromeMessage: function(request, sender, response) { let ret = false; if (request.message === app.ChromeMsg.REGISTER_FAILED.message) { this._showDialog(ERROR_TITLE, request.error); } else if (request.message === app.ChromeMsg.UNREGISTER_FAILED.message) { this._showDialog(ERROR_TITLE, request.error); } return ret; }, /** * Display error dialog * @param {string} title - error title * @param {string} text - description of error * @private * @memberOf SettingsPage */ _showDialog: function(title, text) { text = text.replace('\\n', '&lt;br/&gt;'); this.$.dialogTitle.innerHTML = title; this.$.dialogText.innerHTML = text; this.$.errorDialog.open(); }, }); })(window); × Search results Close "},"setting-text_setting-text.js.html":{"id":"setting-text_setting-text.js.html","title":"Source: setting-text/setting-text.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-text/setting-text.js 'use strict'; new ExceptionHandler(); /** * Polymer element for a text entry * @namespace SettingText */ Polymer({ is: 'setting-text', hostAttributes: { role: 'group', tabIndex: -1, }, properties: { /** * Local storage key * @memberOf SettingText */ name: { type: String, value: 'store', }, /** * Text value * @memberOf SettingText */ value: { type: String, value: '', notify: true, }, /** * Placeholder text when empty * @memberOf SettingText */ placeholder: { type: String, value: 'e.g. Text', notify: true, }, /** * Max length of text entry * @memberOf SettingText */ maxLength: { type: Number, value: '16', notify: true, }, /** * Descriptive label * @memberOf SettingText */ mainLabel: { type: String, value: '', }, /** * Secondary descriptive label * @memberOf SettingText */ secondaryLabel: { type: String, value: '', }, /** * Optional group title * @memberOf SettingText */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingText */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingText */ noseparator: { type: Boolean, value: false, }, }, /** * Event: Lost focus - fire setting-text-changed event * @private * @memberOf SettingText */ _onBlur: function() { Chrome.GA.event(Chrome.GA.EVENT.TEXT, this.name); this.fire('setting-text-changed', {value: this.value}); }, /** * Event: keyup - fire setting-text-changed event on 'Enter' * @param {Event} event - key event * @private * @memberOf SettingText */ _onKeyUp: function(event) { // check if 'Enter' was pressed if (event.keyCode === 13) { Chrome.GA.event(Chrome.GA.EVENT.TEXT, this.name); this.fire('setting-text-changed', {value: this.value}); } }, /** * Initialize value if it is not in localstorage * @private * @memberOf SettingText */ _init: function() { this.set('value', ''); }, }); × Search results Close "},"setting-time_setting-time.js.html":{"id":"setting-time_setting-time.js.html","title":"Source: setting-time/setting-time.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-time/setting-time.js 'use strict'; new ExceptionHandler(); /** * Polymer element for selecting a time * @namespace SettingTime */ Polymer({ is: 'setting-time', behaviors: [ Chrome.LocalizeBehavior, ], properties: { /** * Local storage key * @memberOf SettingTime */ name: { type: String, value: 'store', }, /** * Time value '00:00' format * @memberOf SettingTime */ value: { type: String, value: '00:00', observer: '_valueChanged', }, /** * Time display label * @memberOf SettingTime */ timeLabel: { type: String, value: '12:00 AM', }, /** * Display format 12/24 hr * @memberOf SettingTime */ format: { type: Number, value: 1, notify: true, observer: '_formatChanged', }, /** * Descriptive label * @memberOf SettingTime */ mainLabel: { type: String, value: '', }, /** * Secondary descriptive label * @memberOf SettingTime */ secondaryLabel: { type: String, value: '', }, /** * Optional group title * @memberOf SettingTime */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingTime */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingTime */ noseparator: { type: Boolean, value: false, }, }, /** * Event: Show dialog on tap * @private * @memberOf SettingTime */ _onTap: function() { if (!this.disabled) { this.$.dialog.open(); } }, /** * Event: Set time on tap of OK button * @private * @memberOf SettingTime */ _onTimeSelected: function() { const picker = this.$.timePicker; const hour = ('0' + picker.hour).substr(-2); const min = ('0' + picker.minute).substr(-2); const value = `${hour}:${min}`; this.set('value', value); Chrome.GA.event(Chrome.GA.EVENT.BUTTON, `SettingTime.OK: ${this.name}`); }, /** * Observer: Value changed * @param {string} newValue - value we changed to * @private * @memberOf SettingTime */ _valueChanged: function(newValue) { this._setTimeLabel(newValue); }, /** * Observer: Global Time format changed * @private * @memberOf SettingTime */ _formatChanged: function() { this._setTimeLabel(this.get('value')); }, /** * Get the time suitable for display * @param {string} timeString - format '00:00' * @returns {string} formatted time * @private * @memberOf SettingTime */ _formatTime: function(timeString) { let ret = '12:00 AM'; if (timeString) { ret = Chrome.Time.getStringFull(timeString, this.format); } else { Chrome.Log.error('timeString is null', 'setting-time._formatTime'); } return ret; }, /** * Set the time display label * @param {string} value - time in '00:00' format * @private * @memberOf SettingTime */ _setTimeLabel: function(value) { this.set('timeLabel', this._formatTime(value)); }, /** * Initialize value if it is not in localstorage * @private * @memberOf SettingTime */ _init: function() { this.set('value', '00:00'); }, }); × Search results Close "},"setting-toggle_setting-toggle.js.html":{"id":"setting-toggle_setting-toggle.js.html","title":"Source: setting-toggle/setting-toggle.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: setting-toggle/setting-toggle.js 'use strict'; new ExceptionHandler(); /** * Polymer element for a text entry * @namespace SettingToggle */ Polymer({ is: 'setting-toggle', properties: { /** * Local storage key * @memberOf SettingToggle */ name: { type: String, value: 'store', }, /** * Toggle checked state * @memberOf SettingToggle */ checked: { type: Boolean, value: false, notify: true, }, /** * Toggle descriptive label * @memberOf SettingToggle */ mainLabel: { type: String, value: '', }, /** * Toggle secondary descriptive label * @memberOf SettingToggle */ secondaryLabel: { type: String, value: '', }, /** * Optional group title * @memberOf SettingToggle */ sectionTitle: { type: String, value: '', }, /** * Disabled state of element * @memberOf SettingToggle */ disabled: { type: Boolean, value: false, }, /** * Visibility state of optional divider * @memberOf SettingToggle */ noseparator: { type: Boolean, value: false, }, }, /** * Set the checked state of the toggle * @param {boolean} checked - checked state * @memberOf SettingToggle */ setChecked: function(checked) { this.set('checked', checked); Chrome.GA.event(Chrome.GA.EVENT.TOGGLE, `${this.name}: ${this.checked}`); }, /** * Event: checked state changed * @private * @memberOf SettingToggle */ _onChange: function() { Chrome.GA.event(Chrome.GA.EVENT.TOGGLE, `${this.name}: ${this.checked}`); }, /** * Initialize value if it is not in localStorage * @private * @memberOf SettingToggle */ _init: function() { this.set('checked', 'false'); }, }); × Search results Close "},"pages_signin-page.js.html":{"id":"pages_signin-page.js.html","title":"Source: pages/signin-page.js","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Source: pages/signin-page.js (function(window) { 'use strict'; new ExceptionHandler(); const ERROR_NETWORK = 'There is no Internet connection'; const ERROR_SIGN_IN = 'Failed to sign in.'; const ERROR_SIGN_OUT = 'Failed to sign out.'; const ERROR_PERMISSION = 'Notification permission is required to sign-in.'; let ERROR_BLOCKED_MESSAGE = `&lt;p&gt; You either blocked notifications for the extension, the Chrome settings block all notifications, or you dismissed the notification popup too many times.&lt;br /&gt; If you want to sign-in, go to &lt;b&gt;Chrome settings&lt;/b&gt; and click on &lt;b&gt;Advanced&lt;/b&gt;. Click on &lt;b&gt;Content settings&lt;/b&gt; then &lt;b&gt;Notifications&lt;/b&gt;. Make sure &lt;b&gt;Ask before sending (recommended)&lt;/b&gt; is selected. In the &lt;b&gt;Block&lt;/b&gt; area allow &lt;b&gt;Pushy Clipboard&lt;/b&gt;. If it is not there, &lt;b&gt;ADD&lt;/b&gt; this:&lt;br /&gt; chrome-extension://jemdfhaheennfkehopbpkephjlednffd/ site. &lt;/p&gt;`; const ERROR_DEFAULT_MESSAGE = 'Display notification pop-up again?'; const ERROR_UNKNOWN_MESSAGE = 'An error occurred. Please try again later.&lt;br /&gt;'; window.app = window.app || {}; /** * Polymer element to manage user account * @namespace SignInPage */ app.SignInPageFactory = Polymer({ is: 'signin-page', properties: { /** * Signin state * @memberOf SignInPage */ signedIn: { type: Boolean, value: false, notify: true, }, /** * Signin disabled state * @memberOf SignInPage */ isSignInDisabled: { type: Boolean, value: true, notify: true, }, /** * Waiting for signIn/signOut state * @memberOf SignInPage */ isWaiting: { type: Boolean, value: false, notify: true, }, /** * Display dialog OK button state * @memberOf SignInPage */ showConfirmButton: { type: Boolean, value: false, }, }, /** * We have animated in and are now the current page * @memberOf SignInPage */ onCurrentPage: function() { this._checkChromeSignIn(); }, /** * Event: Signin/SignOut button clicked * @private * @memberOf SignInPage */ _onAccountButtonClicked: function() { Chrome.GA.event(Chrome.GA.EVENT.BUTTON, `SignInPage.accountButton: ${!this.signedIn}`); if (!navigator.onLine) { const title = this.signedIn ? ERROR_SIGN_OUT : ERROR_SIGN_IN; Chrome.Log.error(ERROR_NETWORK, 'SignInPage._accountButton', title); this._showDialog(title, ERROR_NETWORK, false); } else { this.set('isWaiting', true); this.signedIn ? this._signOut() : this._signIn(); } }, /** * Event: Dialog OK button click * @private * @memberOf SignInPage */ _onDialogOKClicked: function() { this._checkPermissions(); }, /** * Computed Binding: Page title * @param {boolean} isSignedIn - true if signed in * @returns {string} * @private * @memberOf SignInPage */ _computeTitle: function(isSignedIn) { const signedIn = `Signed in as: ${Chrome.Storage.get('email')}`; const signedOut = 'Account Sign In'; return isSignedIn ? signedIn : signedOut; }, /** * Computed Binding: Account button label * @param {boolean} isSignedIn - true if signed in * @returns {string} * @private * @memberOf SignInPage */ _computeButtonLabel: function(isSignedIn) { return isSignedIn ? 'Sign out' : 'Sign in'; }, /** * Computed Binding: Spinner label * @returns {string} * @private * @memberOf SignInPage */ _computeWaiterLabel: function() { return this.signedIn ? 'Signing Out...' : 'Signing In...'; }, /** * Computed Binding: Description display style * @param {boolean} isWaiting - true if signing in * @param {boolean} isSignedIn - true if signed in * @returns {string} * @private * @memberOf SignInPage */ _computeDescDisplay: function(isWaiting, isSignedIn) { return (isWaiting || isSignedIn) ? 'none' : 'block'; }, /** * Computed Binding: Spinner display style * @param {boolean} isWaiting - true if signing in * @returns {string} * @private * @memberOf SignInPage */ _computeWaiterDisplay: function(isWaiting) { return isWaiting ? 'block' : 'none'; }, /** * Determine if the user is signed into the Browser * @private * @memberOf SignInPage */ _checkChromeSignIn: function() { const chromep = new ChromePromise(); chromep.identity.getProfileUserInfo().then((userInfo) =&gt; { if (!app.Utils.isSignedIn() &amp;&amp; Chrome.Utils.isWhiteSpace(userInfo.id)) { this.set('isSignInDisabled', true); } else { this.set('isSignInDisabled', false); this._checkPermissions(); } return Promise.resolve(); }).catch((err) =&gt; { Chrome.Log.error(err.message, 'SignInPage._checkChromeSignIn'); }); }, /** * Display popup to Allow Notifications if necessary * @private * @memberOf SignInPage */ _checkPermissions: function() { // Note: Don't rely on Notification.permission // if extension requests notifications permission this.set('isSignInDisabled', true); Notification.requestPermission().then((permission) =&gt; { if (permission === 'denied') { // user denied or Chrome setting blocks all if (app.Utils.isSignedIn()) { // force sign out this._forceSignOut(); } this._showDialog(ERROR_PERMISSION, ERROR_BLOCKED_MESSAGE, false); } else if (permission === 'default') { // user closed notification popup if (app.Utils.isSignedIn()) { // force sign out this._forceSignOut(); } this._showDialog(ERROR_PERMISSION, ERROR_DEFAULT_MESSAGE, true); } else { // granted this.set('isSignInDisabled', false); } return Promise.resolve(); }).catch((err) =&gt; { // something went wrong Chrome.Log.error(err.message, 'SignInPage._checkPermissions'); const text = ERROR_UNKNOWN_MESSAGE + err.message; this._showDialog(ERROR_PERMISSION, text, false); }); }, /** * Attempt to sign in with current Browser account * @private * @memberOf SignInPage */ _signIn: function() { Chrome.Msg.send(app.ChromeMsg.SIGN_IN).then((response) =&gt; { if (response.message === 'error') { Chrome.Log.error(response.error, 'SignInPage._signIn'); this._showDialog(ERROR_SIGN_IN, response.error, false); } this.set('isWaiting', false); return Promise.resolve(); }).catch(() =&gt; { this.set('isWaiting', false); }); }, /** * sign out user - will always do it, one way or another * @private * @memberOf SignInPage */ _signOut: function() { Chrome.Msg.send(app.ChromeMsg.SIGN_OUT).then(() =&gt; { this.set('isWaiting', false); return Promise.resolve(); }).catch(() =&gt; { this.set('isWaiting', false); }); }, /** * Force sign out * @private * @memberOf SignInPage */ _forceSignOut: function() { Chrome.Msg.send(app.ChromeMsg.FORCE_SIGN_OUT).catch(() =&gt; {}); }, /** * Show the error dialog * @param {string} title - dialog title * @param {string} text - dialog message * @param {boolean} showConfirmButton - if true, display showConfirmButton * @private * @memberOf SignInPage */ _showDialog: function(title, text, showConfirmButton) { text = text.replace('\\n', '&lt;br/&gt;'); this.$.dialogTitle.innerHTML = title; this.$.dialogText.innerHTML = text; this.set('showConfirmButton', showConfirmButton); this.$.errorDialog.open(); }, /** * Initialize value if it is not in localStorage * @private * @memberOf SignInPage */ _initSignedIn: function() { this.set('signedIn', false); }, }); })(window); × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Global Methods removeCachedToken( [curToken]) → {Promise.&lt;string&gt;} Remove our cached auth token Parameters: Name Type Argument Default Description curToken string | null &lt;optional&gt; null token to remove Source: scripts/auth.js, line 41 Returns: the old token Type Promise.&lt;string&gt; × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Classes Classes Time ClipItem Device ExceptionHandler Label Namespaces Alarm CB ChromeMsg Data DB Devices Fb GA Gae Msg Notify Permissions Reg SW User Utils Background Auth GA Http JSONUtils Locale Log Msg Storage Utils ClipList ClipRow ClipViewer ContentScript DevicesPage ErrorPage HelpPage LabelsDialog LabelsPage Main MainPage ReceiveMsg ServiceWorker SettingBackground SettingDropdown SettingLink SettingSlider SettingsPage SettingText SettingTime SettingToggle SignInPage Events row-label-tap Fired when the label button of a row is tapped Source: clip-list.js, line 19 selected-clip-change Fired when the selected clip changes Source: clip-list.js, line 13 label-tap Fired when the label button of a row is tapped Source: clip-row.js, line 14 clip-add Fires when a new clip should be added Source: clip-viewer.js, line 26 labels-tapped Fires when labels section is tapped Source: clip-viewer.js, line 14 text-changed Fires when text is changed Source: clip-viewer.js, line 20 × Search results Close "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespaces Classes Time ClipItem Device ExceptionHandler Label Namespaces Alarm CB ChromeMsg Data DB Devices Fb GA Gae Msg Notify Permissions Reg SW User Utils Background Auth GA Http JSONUtils Locale Log Msg Storage Utils ClipList ClipRow ClipViewer ContentScript DevicesPage ErrorPage HelpPage LabelsDialog LabelsPage Main MainPage ReceiveMsg ServiceWorker SettingBackground SettingDropdown SettingLink SettingSlider SettingsPage SettingText SettingTime SettingToggle SignInPage Events row-label-tap Fired when the label button of a row is tapped Source: clip-list.js, line 19 selected-clip-change Fired when the selected clip changes Source: clip-list.js, line 13 label-tap Fired when the label button of a row is tapped Source: clip-row.js, line 14 clip-add Fires when a new clip should be added Source: clip-viewer.js, line 26 labels-tapped Fires when labels section is tapped Source: clip-viewer.js, line 14 text-changed Fires when text is changed Source: clip-viewer.js, line 20 × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Github Pages for Pushy ClipboardMonitor, store, and manage all text placed on the clipboard. Mark favorite items for easy access. Share between your devices using push notifications: Any desktop hardware that supports the Chrome Browser using the Pushy Clipboard Chrome Extension Android phones and tablets using the Pushy Clipboard app Free and advertising free. I write software for fun and hope it benefits others. × Search results Close "},"app.Alarm.html":{"id":"app.Alarm.html","title":"Namespace: Alarm","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Alarm Alarm Manage the chrome.alarm Source: background/alarm.js, line 13 Members &lt;private, static, constant&gt; ALARM_STORAGE :string Alarm for cleaning up old ClipItem objects Type: string Default Value: storage Source: background/alarm.js, line 26 Methods &lt;private, static&gt; _onAlarm(alarm) Event: Fired when an alarm has elapsed. Parameters: Name Type Description alarm Object details on alarm Source: background/alarm.js, line 35 See: https://developer.chrome.com/apps/alarms#event-onAlarm &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Source: background/alarm.js, line 60 &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: background/alarm.js, line 49 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;static&gt; deleteOldClipItems() Delete ClipItem objects older than the storageDuration setting Source: background/alarm.js, line 99 &lt;static&gt; updateAlarms() Set the repeating alarms Source: background/alarm.js, line 76 × Search results Close "},"app.CB.html":{"id":"app.CB.html","title":"Namespace: CB","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: CB CB Manage the clipboard Source: background/clipboard.js, line 13 Members &lt;private, static, constant&gt; WAIT_MILLIS :int Delay time for reading from clipboard Type: int Default Value: 250 Source: background/clipboard.js, line 25 Methods &lt;private, static&gt; _addClipItemFromClipboard() Add a new ClipItem from the Clipboard contents Source: background/clipboard.js, line 47 &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: background/clipboard.js, line 92 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _sendLocalClipItem(clipItem) Send local ClipItem push notification if enabled Parameters: Name Type Description clipItem ClipItem ClipItem to send Source: background/clipboard.js, line 33 &lt;static&gt; copyToClipboard(text) Copy the given text to the clipboard Parameters: Name Type Description text string text to copy Source: background/clipboard.js, line 134 &lt;static&gt; getTextFromClipboard() → {string} Get the text from the clipboard Source: background/clipboard.js, line 117 Returns: text from clipboard Type string × Search results Close "},"app.ChromeMsg.html":{"id":"app.ChromeMsg.html","title":"Namespace: ChromeMsg","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ChromeMsg ChromeMsg Chrome messages for the extension Source: chrome_msg.js, line 13 Members &lt;static, constant&gt; _MSG :Object Chrome Messages Type: Object Properties: Name Type Description REMOVE_DEVICE Chrome.Msg.Message a Device was removed from app.Devices DEVICES_CHANGED Chrome.Msg.Message list of app.Devices changed PING Chrome.Msg.Message ping our app.Devices COPY_TO_CLIPBOARD Chrome.Msg.Message copy ClipItem to clipboard COPIED_TO_CLIPBOARD Chrome.Msg.Message ClipItem copied to clipboard SIGN_IN Chrome.Msg.Message app.User sign in SIGN_OUT Chrome.Msg.Message app.User sign out FORCE_SIGN_OUT Chrome.Msg.Message app.User sign out but don't unregister MSG_FAILED Chrome.Msg.Message send app.Msg failed REGISTER_FAILED Chrome.Msg.Message register with server failed UNREGISTER_FAILED Chrome.Msg.Message unregister with server failed CLIP_ITEM_CREATED Chrome.Msg.Message new clip created CLIP_ITEM_DELETED Chrome.Msg.Message clip deleted CLIP_ITEM_UPDATED Chrome.Msg.Message existing clip updated Source: chrome_msg.js, line 45 × Search results Close "},"app.Data.html":{"id":"app.Data.html","title":"Namespace: Data","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Data Data Manage the extension's data sources Source: background/data.js, line 13 Members &lt;private, static, constant&gt; _DEFAULTS :app.Data.Items Default values for localStorage items Type: app.Data.Items Source: background/data.js, line 64 &lt;private, static, constant&gt; _ERROR_INIT :string Labeled ClipItem Type: string Source: background/data.js, line 138 &lt;private, static, constant&gt; _EXAMPLE_LABEL :string Labeled ClipItem Type: string Source: background/data.js, line 129 &lt;private, static, constant&gt; _ITEM_TXT :string Initial ClipItem Type: string Source: background/data.js, line 96 &lt;private, static, constant&gt; _VERSION :int Version of data - update when items are added, removed, changed Type: int Source: background/data.js, line 25 Methods &lt;private, static&gt; _addDefaults() Save the _DEFAULTS if they don't exist Source: background/data.js, line 145 &lt;private, static&gt; _addLabelExample() → {Promise.&lt;void&gt;} Add a ClipItem with a Label Source: background/data.js, line 163 Returns: Type Promise.&lt;void&gt; &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Monitor database Source: background/data.js, line 180 &lt;static&gt; initialize() → {Promise.&lt;void&gt;} Initialize the data saved in localStorage Source: background/data.js, line 225 Returns: Type Promise.&lt;void&gt; &lt;static&gt; update() Update the data saved in localStorage Source: background/data.js, line 248 Type Definitions Items The data items saved to localStorage Type: Object Properties: Name Type Description version int version of data monitorClipboard boolean save clipboard contents allowPush boolean send push notifications autoSend boolean automatically send push notifications allowReceive boolean receive push notifications storageDuration int how long to save clipItems pinFavs boolean Pin favorite clips to top of list notify boolean xxx notifyOnCopy boolean show notification when copy detected notifyOnSend boolean show notification on send push notifyOnError boolean show notification on errors highPriority boolean send high priority messages deviceNickname string nickname of our device devices Object other devices we know about signedIn boolean are we logged in registered boolean are we registered with server needsCleanup boolean does are log in state need cleanup email string our email address uid string our unique id photoURL string path to out photo url permissions string enum: notSet allowed denied noDevicesCt int count of noDevice send errors lastError Chrome.Storage.LastError last error that we saved Source: background/data.js, line 27 × Search results Close "},"app.DB.html":{"id":"app.DB.html","title":"Namespace: DB","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: DB DB Manage the Dexie database Source: db.js, line 14 See: http://dexie.org/ Members &lt;private, static&gt; _db :Object The Dexie database Type: Object Source: db.js, line 35 See: http://dexie.org/ Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Dexie Source: db.js, line 43 &lt;static&gt; clips() → {Object} Get the clipItems table Source: db.js, line 183 Returns: Type Object &lt;static&gt; get() → {Object} Get the database Source: db.js, line 174 Returns: the Dexie db object Type Object &lt;static&gt; labels() → {Object} Get the labels table Source: db.js, line 192 Returns: Type Object × Search results Close "},"app.Devices.html":{"id":"app.Devices.html","title":"Namespace: Devices","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Devices Devices A list of remote Device objects we know about Source: background/devices.js, line 13 Members &lt;private, static&gt; _devices :Map A Map of Device objects keyed by their unique names Type: Map Source: background/devices.js, line 24 Methods &lt;private, static&gt; _load() Get the Device objects from localStorage Source: background/devices.js, line 48 &lt;private, static&gt; _mapToObj(map) → {Object} Convert Map to Object Parameters: Name Type Description map Map Source: background/devices.js, line 33 Returns: as Object Type Object &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the message sender Object MessageSender object response function function to call once after processing Source: background/devices.js, line 97 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Load the Device objects from localStorage Source: background/devices.js, line 81 &lt;private, static&gt; _save() Save the Device objects to localStorage Source: background/devices.js, line 69 &lt;static&gt; add(device) Add a new Device Parameters: Name Type Description device Device Source: background/devices.js, line 131 &lt;static&gt; clear() Remove all Device objects Source: background/devices.js, line 159 &lt;static&gt; entries() → {Iterator.&lt;Device&gt;} Get an Iterator on the Devices Source: background/devices.js, line 122 Returns: Type Iterator.&lt;Device&gt; &lt;static&gt; remove(device) Remove a Device Parameters: Name Type Description device Device Source: background/devices.js, line 141 &lt;static&gt; removeByName(uniqueName) Remove a Device with the given unique name Parameters: Name Type Description uniqueName string Source: background/devices.js, line 150 × Search results Close "},"app.Fb.html":{"id":"app.Fb.html","title":"Namespace: Fb","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Fb Fb Manage interaction with firebase and its Namespaces Source: background/firebase.js, line 14 See: https://firebase.google.com/docs/web/setup Members &lt;private, static&gt; _app Firebase app Source: background/firebase.js, line 38 &lt;private, static&gt; _auth Firebase auth Namespace Source: background/firebase.js, line 52 &lt;private, static&gt; _messaging Firebase messaging Namespace Source: background/firebase.js, line 45 &lt;static, constant&gt; ERROR_NETWORK :string Error message for no internet Type: string Source: background/firebase.js, line 31 &lt;static, constant&gt; ERROR_TOKEN :string Error message for regToken Type: string Source: background/firebase.js, line 24 Methods &lt;private, static&gt; _deleteFirebaseApp() → {firebase.Promise.&lt;void&gt;|Promise.&lt;void&gt;} Delete firebase.app if it exists Source: background/firebase.js, line 91 Returns: void Type firebase.Promise.&lt;void&gt; | Promise.&lt;void&gt; &lt;private, static&gt; _initializeFirebase(swReg) → {Promise.&lt;void&gt;} Initialize firebase and its Namespaces Parameters: Name Type Description swReg ServiceWorkerRegistration use own ServiceWorker Source: background/firebase.js, line 61 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _refreshRegToken() Refresh the regToken when firebase changes it Source: background/firebase.js, line 103 &lt;static&gt; getRegToken() → {Promise.&lt;token&gt;} Get the registration token for fcm Source: background/firebase.js, line 160 Returns: A registration token for fcm Type Promise.&lt;token&gt; &lt;static&gt; initialize(swReg) → {Promise.&lt;void&gt;} Initialize the firebase libraries Parameters: Name Type Description swReg ServiceWorkerRegistration service worker Source: background/firebase.js, line 125 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; signIn(token) → {Promise.&lt;Object&gt;} SignIn to firebase Parameters: Name Type Description token string token Source: background/firebase.js, line 135 Returns: The current firebase user Type Promise.&lt;Object&gt; &lt;static&gt; signOut() → {Promise.&lt;void&gt;} Unregister Service Worker and sign-out of firebase Source: background/firebase.js, line 149 Returns: Error on reject Type Promise.&lt;void&gt; × Search results Close "},"app.GA.html":{"id":"app.GA.html","title":"Namespace: GA","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: GA GA Manage Google Analytics tracking Source: my_analytics.js, line 13 Members &lt;private, static, constant&gt; _TRACKING_ID :string Tracking ID Type: string Default Value: UA-61314754-3 Source: my_analytics.js, line 24 &lt;static, constant&gt; EVENT :Object Event types Type: Object Properties: Name Type Description CLICK Chrome.GA.Event generic click IMAGE_BUTTON Chrome.GA.Event icon clicked (non-menu) FAB_BUTTON Chrome.GA.Event fab clicked SENT Chrome.GA.Event message sent RECEIVED Chrome.GA.Event message received REGISTERED Chrome.GA.Event Device registered UNREGISTERED Chrome.GA.Event Device unregistered TOKEN_REFRESHED Chrome.GA.Event firebase token refreshed DB Chrome.GA.Event any db change CHROME_SIGN_OUT Chrome.GA.Event Chrome signed out of our act. Source: my_analytics.js, line 42 Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Google Analytics Source: my_analytics.js, line 101 × Search results Close "},"app.Gae.html":{"id":"app.Gae.html","title":"Namespace: Gae","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Gae Gae Handle calls to the Google App Engine Endpoints Source: background/gae.js, line 14 See: https://cloud.google.com/appengine/docs/standard/java/endpoints/ Members &lt;static&gt; GAE_ROOT :string Root path to our gae server Type: string Source: background/gae.js, line 49 &lt;private, static, constant&gt; GAE_ROOT_LOCAL Base path of local testing server Default Value: http://localhost:8080/_ah/api Source: background/gae.js, line 37 &lt;private, static, constant&gt; GAE_ROOT_REMOTE Base path of real gae server Default Value: https://clip-man.appspot.com/_ah/api Source: background/gae.js, line 26 Methods &lt;static&gt; doPost(url, retryToken [, interactive]) → {Promise.&lt;void&gt;} Perform POST request to endpoint Parameters: Name Type Argument Default Description url string server Endpoint retryToken boolean if true, retry with new token on error interactive boolean &lt;optional&gt; false true if user initiated Source: background/gae.js, line 60 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.Msg.html":{"id":"app.Msg.html","title":"Namespace: Msg","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Msg Msg Send messages to the GAE server MessagingEndpoint for delivery Source: background/messaging_client.js, line 13 Members &lt;static, constant&gt; _ACTION :Object Message action Type: Object Properties: Name Type Description MESSAGE string PING string PING_RESPONSE string DEVICE_ADDED string DEVICE_REMOVED string Source: background/messaging_client.js, line 59 &lt;private, static, constant&gt; _BODY :Object Message body Type: Object Properties: Name Type Description PING string PING_RESPONSE string DEVICE_ADDED string DEVICE_REMOVED string Source: background/messaging_client.js, line 78 &lt;private, static, constant&gt; _ERR_NO_DEVICES Starting portion of server error indicating no other registered devices Source: background/messaging_client.js, line 99 &lt;private, static, constant&gt; _MAX_MSG_LEN Max message length. Server may reduce it more Source: background/messaging_client.js, line 46 &lt;private, static, constant&gt; _MAX_NO_DEVICES_CT Max number of no device errors before turning off push to devices Source: background/messaging_client.js, line 91 &lt;private, static, constant&gt; _URL_BASE Base path of MessagingEndpoint Source: background/messaging_client.js, line 38 Methods &lt;private, static&gt; _getData(action, body) → {app.Msg.GaeMsg} Get the data packet we will send Parameters: Name Type Description action string message type body string message body Source: background/messaging_client.js, line 119 Returns: Type app.Msg.GaeMsg &lt;static&gt; _getDevice() → {Object} Get portion of Device sent in message Source: background/messaging_client.js, line 131 Returns: Subset of Device info as object literal Type Object &lt;private, static&gt; _sendMessage(data, notify, type) → {Promise.&lt;void&gt;} Send message to server for delivery to our Devices Parameters: Name Type Argument Default Description data app.Msg.GaeMsg data packet notify boolean display notification if true type app.Notify.TYPE &lt;nullable&gt; null notification type Source: background/messaging_client.js, line 149 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendClipItem(clipItem) → {Promise.&lt;void&gt;} Send clipboard contents as represented by a ClipItem Parameters: Name Type Description clipItem ClipItem contents of clipboard Source: background/messaging_client.js, line 184 Returns: Type Promise.&lt;void&gt; &lt;static&gt; sendDeviceAdded() → {Promise.&lt;void&gt;} Send message for adding our Device Source: background/messaging_client.js, line 233 Returns: Type Promise.&lt;void&gt; &lt;static&gt; sendDeviceRemoved() → {Promise.&lt;void&gt;} Send message for removing our Device Source: background/messaging_client.js, line 243 Returns: Type Promise.&lt;void&gt; &lt;static&gt; sendFailed(err) Display notification that send message failed Parameters: Name Type Description err Error Source: background/messaging_client.js, line 288 &lt;static&gt; sendPing() → {Promise.&lt;void&gt;} Ping our app.Devices Source: background/messaging_client.js, line 253 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendPingResponse(srcRegId) → {Promise.&lt;void&gt;} Respond to a ping from a Device Parameters: Name Type Description srcRegId string source of ping Source: background/messaging_client.js, line 277 Returns: Type Promise.&lt;void&gt; Type Definitions GaeMsg Data packet sent to server Type: Object Properties: Name Type Description act string type of message m string content of message dM string Device model dSN string Device serial number dOS string Device operating system dN string Device nickname fav string '1' if favorite item (optional) srcRegId string source of ping (optional) Source: background/messaging_client.js, line 18 × Search results Close "},"app.Notify.html":{"id":"app.Notify.html","title":"Namespace: Notify","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Notify Notify Handle display of notifications Source: background/notify.js, line 14 See: https://developer.chrome.com/apps/notifications Members &lt;static, constant&gt; ERROR_NO_NOTIFICATIONS :string System Notifications not granted error message Type: string Source: background/notify.js, line 260 &lt;static, constant&gt; TYPE :Object Notification types Type: Object Properties: Name Type Description CLIPBOARD_CHANGED app.Notify.TYPE detected clipboard change MESSAGE_SENT app.Notify.TYPE message sent to remote devices DEVICE_ADDED app.Notify.TYPE added our device DEVICE_REMOVED app.Notify.TYPE removed our device SEND_ERROR app.Notify.TYPE error sending message ERROR_STORE_CLIP app.Notify.TYPE error saving to DB Source: background/notify.js, line 54 &lt;static&gt; TYPE notification types Source: background/notify.js, line 252 Methods &lt;private, static&gt; _onButtonClicked(id, btnIdx) Event: Fired when the user clicked on a button of the notification. Parameters: Name Type Description id string notification type btnIdx int index of clicked button Source: background/notify.js, line 225 See: https://developer.chrome.com/apps/notifications#event-onClicked &lt;private, static&gt; _onNotificationClicked(id) Event: Fired when the user clicked in a non-button area of the notification. Parameters: Name Type Description id string notification type Source: background/notify.js, line 200 See: https://developer.chrome.com/apps/notifications#event-onClicked &lt;static&gt; create(type, message [, lastError]) Create and display a notification Parameters: Name Type Argument Default Description type app.Notify.TYPE notification type message string message to display lastError Chrome.Storage.LastError &lt;optional&gt; null lastError Source: background/notify.js, line 269 &lt;static&gt; hasNavigatorPermission() → {Promise.&lt;boolean&gt;} Determine if navigator Notifications permission has been granted Note: this will work from the background script of an extension, unlike the other solutions Source: background/notify.js, line 345 See: https://goo.gl/RzekrB https://w3c.github.io/permissions/ https://www.chromestatus.com/features/6443143280984064 Returns: true if granted Type Promise.&lt;boolean&gt; &lt;static&gt; onCopy() → {boolean} Determine if copy notifications are enabled Source: background/notify.js, line 310 Returns: true if enabled Type boolean &lt;static&gt; onError() → {boolean} Determine if error notifications are enabled Source: background/notify.js, line 330 Returns: true if enabled Type boolean &lt;static&gt; onSend() → {boolean} Determine if send notifications are enabled Source: background/notify.js, line 320 Returns: true if enabled Type boolean Type Definitions TYPE Notification type Type: Object Properties: Name Type Description id string unique notification id title string title message string message icon string path to icon isError boolean if true, error notification pageRoute string page in main.html to route too requireInteraction boolean if true, visible until dismissed hasButtons boolean if true, we have buttons buttons Array button description buttonFunctions Array button click functions Source: background/notify.js, line 26 × Search results Close "},"app.Permissions.html":{"id":"app.Permissions.html","title":"Namespace: Permissions","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Permissions Permissions Handle optional permissions Source: permissions.js, line 13 Members &lt;static, constant&gt; ALLOWED Source: permissions.js, line 28 &lt;static&gt; ALLOWED Source: permissions.js, line 36 &lt;static&gt; DENIED Source: permissions.js, line 38 &lt;static, constant&gt; DENIED Source: permissions.js, line 30 &lt;static, constant&gt; NOT_SET Source: permissions.js, line 26 &lt;static&gt; NOT_SET Source: permissions.js, line 34 &lt;static, constant&gt; ORIGINS Source: permissions.js, line 23 &lt;static, constant&gt; PERMISSIONS Source: permissions.js, line 21 Methods &lt;static&gt; contains() → {Promise.&lt;boolean&gt;} Determine if we have the optional permissions Source: permissions.js, line 90 Returns: true if we have permissions Type Promise.&lt;boolean&gt; &lt;static&gt; injectContentScript(tabId) Inject our script into the given tab Parameters: Name Type Description tabId int tab to inject Source: permissions.js, line 155 &lt;static&gt; injectContentScripts() Inject our script into all tabs that match Source: permissions.js, line 130 &lt;static&gt; isAllowed() → {boolean} Has the user allowed the optional permissions Source: permissions.js, line 54 Returns: true if allowed Type boolean &lt;static&gt; notSet() → {boolean} Has use made choice on permissions Source: permissions.js, line 45 Returns: true if allowed or denied Type boolean &lt;static&gt; remove() → {Promise.&lt;boolean&gt;} Remove the optional permissions Source: permissions.js, line 102 Returns: true if removed Type Promise.&lt;boolean&gt; &lt;static&gt; request() → {Promise.&lt;boolean&gt;} Prompt for the optional permissions Source: permissions.js, line 63 Returns: true if permission granted Type Promise.&lt;boolean&gt; × Search results Close "},"app.Reg.html":{"id":"app.Reg.html","title":"Namespace: Reg","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Reg Reg Handle RegistrationEndpoint tasks on the gae server Source: background/registration_client.js, line 13 Members &lt;private, static, constant&gt; URL_BASE :string Base path of RegistrationEndpoint Type: string Source: background/registration_client.js, line 25 Methods &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: background/registration_client.js, line 35 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;static&gt; register( [interactive]) → {Promise.&lt;void&gt;} Register Device with server Parameters: Name Type Argument Default Description interactive boolean &lt;optional&gt; false true if user initiated Source: background/registration_client.js, line 80 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; unregister( [interactive]) → {Promise.&lt;void&gt;} Unregister Device with server Parameters: Name Type Argument Default Description interactive boolean &lt;optional&gt; false true if user initiated Source: background/registration_client.js, line 105 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.SW.html":{"id":"app.SW.html","title":"Namespace: SW","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SW SW Manage lifecycle of our ServiceWorker Source: background/service_worker.js, line 13 Members &lt;private, static, constant&gt; _PATH Path to our ServiceWorker Source: background/service_worker.js, line 30 &lt;private, static&gt; _reg Our ServiceWorkerRegistration object Source: background/service_worker.js, line 37 &lt;static, constant&gt; ERROR_NOT_SUBSCRIBED :string Not subscribed to push error message Type: string Source: background/service_worker.js, line 77 Methods &lt;private, static&gt; _register() → {Promise.&lt;Object&gt;} Register the Service Worker Note: This can be called if already registered Source: background/service_worker.js, line 46 Returns: service worker Type Promise.&lt;Object&gt; &lt;private, static&gt; _unsubscribePush() → {Promise.&lt;void&gt;} Unsubscribe from push notifications Source: background/service_worker.js, line 61 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; cantReceive() → {Promise.&lt;?string&gt;} Check if the ServiceWorker is not in a state for receiving messages Source: background/service_worker.js, line 148 Returns: reason if it can't, or null Type Promise.&lt;?string&gt; &lt;static&gt; initialize() → {Promise.&lt;void&gt;} Initialize the ServiceWorker and firebase Source: background/service_worker.js, line 84 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; isSubscribed() → {Promise.&lt;boolean&gt;} Are we subscribed to push notifications Source: background/service_worker.js, line 133 Returns: true if subscribed Type Promise.&lt;boolean&gt; &lt;static&gt; unregister() → {Promise.&lt;void&gt;} Unregister the Service Worker Source: background/service_worker.js, line 97 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; update() → {Promise.&lt;void&gt;} Update the Service Worker Source: background/service_worker.js, line 121 Returns: void always resolves Type Promise.&lt;void&gt; × Search results Close "},"app.User.html":{"id":"app.User.html","title":"Namespace: User","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: User User Manage the current user Source: background/user.js, line 13 Methods &lt;private, static&gt; _needsCleanup() → {Promise.&lt;void&gt;} Cleanup if user signed-out of Browser Source: background/user.js, line 76 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: background/user.js, line 151 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onSignInChanged(account, signedIn) Event: Fired when signin state changes for an act. on the user's profile. Parameters: Name Type Description account Object chrome AccountInfo signedIn boolean true if signedIn Source: background/user.js, line 42 See: https://developer.chrome.com/apps/identity#event-onSignInChanged &lt;private, static&gt; _signIn() → {Promise.&lt;void&gt;} Sign in and register our Device Source: background/user.js, line 91 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _signOut() → {Promise.&lt;void&gt;} Unregister Device and sign out of firebase Source: background/user.js, line 115 Returns: always resolves Type Promise.&lt;void&gt; &lt;static&gt; forceSignOut( [notify] [, reason]) → {Promise.&lt;void&gt;} Force signOut without unregistering from App Engine and without needing OAuth Parameters: Name Type Argument Default Description notify boolean &lt;optional&gt; false if true, post error notification reason string &lt;optional&gt; 'Unknown Error' reason for call Source: background/user.js, line 226 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; setInfo() → {Promise.&lt;void&gt;} Persist info on current Browser user (may be no-one) Source: background/user.js, line 210 Returns: void Type Promise.&lt;void&gt; × Search results Close "},"app.Utils.html":{"id":"app.Utils.html","title":"Namespace: Utils","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Utils Utils Misc. utility methods Source: utils.js, line 13 Members &lt;static, constant&gt; MILLIS_IN_DAY :int Number of milliseconds a in day Type: int Source: utils.js, line 37 &lt;static, constant&gt; MIN_IN_DAY :int Number of minutes in a day Type: int Source: utils.js, line 29 Methods &lt;static&gt; allowBackup() → {boolean} Has user allowed backup of data to Google Drive Source: utils.js, line 206 Returns: Type boolean &lt;static&gt; allowPush() → {boolean} Has user enabled pushing to app.Devices Source: utils.js, line 152 Returns: Type boolean &lt;static&gt; allowReceive() → {boolean} Has user enabled receiving from app.Devices Source: utils.js, line 170 Returns: Type boolean &lt;static&gt; canSend() → {boolean} Can we send messages to our devices Source: utils.js, line 215 Returns: Type boolean &lt;static&gt; getEmail() → {string} Get our email address Source: utils.js, line 44 Returns: Type string &lt;static&gt; getEmailBody() → {string} Get body for an email with basic extension info Source: utils.js, line 71 Returns: text Type string &lt;static&gt; getEmailUrl(subject, body) → {string} Get encoded url for an email Parameters: Name Type Description subject string email subject body string email body Source: utils.js, line 84 Returns: Type string &lt;static&gt; getGithubPagesPath() → {string} Get our Github pages base path Source: utils.js, line 62 Returns: Type string &lt;static&gt; getGithubPath() → {string} Get our Github base path Source: utils.js, line 53 Returns: Type string &lt;static&gt; getRelativeTime(time) → {string} Get a date string in time ago format Parameters: Name Type Description time int time since epoch in millis Source: utils.js, line 124 Returns: Type string &lt;static&gt; isAutoSend() → {boolean} Has user enabled autoSend option Source: utils.js, line 161 Returns: Type boolean &lt;static&gt; isMonitorClipboard() → {boolean} Are we saving clipboard contents Source: utils.js, line 143 Returns: Type boolean &lt;static&gt; isPinFavs() → {boolean} Should we show the favorites at the top of the list Source: utils.js, line 134 Returns: Type boolean &lt;static&gt; isRegistered() → {boolean} Are we registered with fcm Source: utils.js, line 188 Returns: true if registered Type boolean &lt;static&gt; isSignedIn() → {boolean} Are we signed in Source: utils.js, line 179 Returns: true if signed in Type boolean &lt;static&gt; notRegistered() → {boolean} Are we not registered with fcm Source: utils.js, line 197 Returns: true if not registered Type boolean &lt;static&gt; setBadgeText() Set the badge displayed on the extension icon Source: utils.js, line 95 &lt;static&gt; showMainTab( [route]) Send message to the main tab to focus it. If not found, create it Parameters: Name Type Argument Default Description route string &lt;optional&gt; &lt;nullable&gt; 'page-main' the page to route to Source: utils.js, line 108 × Search results Close "},"Background.html":{"id":"Background.html","title":"Namespace: Background","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Background Background The background script for the extension. Note: We can't be an Event Page because we use the chrome.webRequest API Source: background/background.js, line 10 Methods &lt;private, static&gt; _initializeFirebase() → {Promise.&lt;void&gt;} Initialize firebase and Service Worker if signed in Source: background/background.js, line 173 Returns: void Type Promise.&lt;void&gt; &lt;private, static&gt; _onIconClicked() Event: Fired when a browser action icon is clicked. Source: background/background.js, line 90 See: https://goo.gl/abVwKu &lt;private, static&gt; _onInstalled(details) Event: Fired when the extension is first installed, when the extension is updated to a new version, and when Chrome is updated to a new version. Parameters: Name Type Description details Object type of event Properties Name Type Description reason string reason for install previousVersion string old version if 'update' reason Source: background/background.js, line 29 See: https://developer.chrome.com/extensions/runtime#event-onInstalled &lt;private, static&gt; _onLoad() Event: document and resources loaded Source: background/background.js, line 150 &lt;private, static&gt; _onStartup() Event: Fired when a profile that has this extension installed first starts up Source: background/background.js, line 74 See: https://developer.chrome.com/extensions/runtime#event-onStartup &lt;private, static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string storage item that changed Source: background/background.js, line 135 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;private, static&gt; _onTabUpdated(tabId) Event: Fired when a tab is updated. Parameters: Name Type Description tabId int id of tab Source: background/background.js, line 123 See: https://developer.chrome.com/extensions/tabs#event-onUpdated × Search results Close "},"Chrome.Auth.html":{"id":"Chrome.Auth.html","title":"Namespace: Auth","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Auth Auth Google authorization utilities Source: scripts/auth.js, line 14 See: https://developer.chrome.com/apps/identity Methods &lt;static&gt; getToken(interactive) → {Promise.&lt;string&gt;} Get our OAuth2.0 token Parameters: Name Type Description interactive boolean if true may block Source: scripts/auth.js, line 28 Returns: An access token Type Promise.&lt;string&gt; × Search results Close "},"Chrome.GA.html":{"id":"Chrome.GA.html","title":"Namespace: GA","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: GA GA Google Analytics tracking Source: scripts/analytics.js, line 13 Members &lt;static, constant&gt; _EVENT :Object Event types Type: Object Properties: Name Type Description INSTALLED Chrome.GA.Event extension installed UPDATED Chrome.GA.Event extension updated MENU Chrome.GA.Event menu selected TOGGLE Chrome.GA.Event setting-toggle LINK Chrome.GA.Event setting-link TEXT Chrome.GA.Event setting-text BUTTON Chrome.GA.Event button click ICON Chrome.GA.Event toolbar icon click CHECK Chrome.GA.Event checkbox click KEY_COMMAND Chrome.GA.Event keyboard shortcut Source: scripts/analytics.js, line 69 Methods &lt;private, static&gt; _onLoad() Event: called when document and resources are loaded Initialize Google Analytics Source: scripts/analytics.js, line 31 &lt;static&gt; error( [label] [, action]) Send an error Parameters: Name Type Argument Default Description label string &lt;optional&gt; &lt;nullable&gt; 'unknown' override label action string &lt;optional&gt; &lt;nullable&gt; 'unknownMethod' override action Source: scripts/analytics.js, line 185 &lt;static&gt; event(event [, label] [, action]) Send an event Parameters: Name Type Argument Default Description event Chrome.GA.Event the event type label string &lt;optional&gt; &lt;nullable&gt; null override label action string &lt;optional&gt; &lt;nullable&gt; null override action Source: scripts/analytics.js, line 164 &lt;static&gt; exception(exception [, message] [, fatal]) Send an exception Parameters: Name Type Argument Default Description exception Object the exception message string &lt;optional&gt; &lt;nullable&gt; null the error message fatal boolean &lt;optional&gt; true true if fatal Source: scripts/analytics.js, line 206 &lt;static&gt; initialize(trackingId, appName, appId, appVersion) Initialize analytics Parameters: Name Type Description trackingId string tracking id appName string extension name appId string extension Id appVersion string extension version Source: scripts/analytics.js, line 133 &lt;static&gt; page(page) Send a page Parameters: Name Type Description page string page path Source: scripts/analytics.js, line 149 Type Definitions Event Google Analytics Event Type: Object Properties: Name Type Description eventCategory string category eventAction string action eventLabel string label Source: scripts/analytics.js, line 16 × Search results Close "},"Chrome.Http.html":{"id":"Chrome.Http.html","title":"Namespace: Http","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Http Http Fetch with authentication and exponential back-off Source: scripts/http.js, line 13 Members &lt;private, static, constant&gt; _AUTH_HEADER :string Authorization header Type: string Source: scripts/http.js, line 46 &lt;private, static, constant&gt; _BEARER :string Bearer parameter for authorized call Type: string Source: scripts/http.js, line 54 &lt;private, static, constant&gt; _CONFIG :Chrome.Http.Config Configuration object Type: Chrome.Http.Config Source: scripts/http.js, line 78 &lt;private, static, constant&gt; _DELAY Delay multiplier for exponential back-off Source: scripts/http.js, line 70 &lt;private, static, constant&gt; _MAX_RETRIES :int Max retries on 500 errors Type: int Source: scripts/http.js, line 62 Methods &lt;private, static&gt; _doIt(url, opts, conf) → {Promise.&lt;JSON&gt;} Do a server request Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration Source: scripts/http.js, line 265 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _fetch(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Perform fetch, optionally using authorization and exponential back-off Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: scripts/http.js, line 234 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _getAuthToken(isAuth, interactive) → {Promise.&lt;string&gt;} Get authorization token Parameters: Name Type Description isAuth boolean if true, authorization required interactive boolean if true, user initiated Source: scripts/http.js, line 162 Returns: auth token Type Promise.&lt;string&gt; &lt;private, static&gt; _getError(response) → {Error} Get Error message Parameters: Name Type Description response Chrome.Http.Response server response Source: scripts/http.js, line 139 Returns: Type Error &lt;private, static&gt; _processResponse(response, url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Check response and act accordingly Parameters: Name Type Description response Chrome.Http.Response server response url string server opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: scripts/http.js, line 98 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retry(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Retry authorized fetch with exponential back-off Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: scripts/http.js, line 194 Returns: response from server Type Promise.&lt;JSON&gt; &lt;private, static&gt; _retryToken(url, opts, conf, attempt) → {Promise.&lt;JSON&gt;} Retry fetch after removing cached auth token Parameters: Name Type Description url string server request opts Object fetch options conf Chrome.Http.Config configuration attempt int the retry attempt we are on Source: scripts/http.js, line 215 Returns: response from server Type Promise.&lt;JSON&gt; &lt;static&gt; doGet(url [, conf]) → {Promise.&lt;JSON&gt;} Perform GET request Parameters: Name Type Argument Default Description url string server request conf Chrome.Http.Config &lt;optional&gt; null configuration Source: scripts/http.js, line 284 Returns: response from server Type Promise.&lt;JSON&gt; &lt;static&gt; doPost(url [, conf]) → {Promise.&lt;JSON&gt;} Perform POST request Parameters: Name Type Argument Default Description url string server request conf Chrome.Http.Config &lt;optional&gt; null configuration Source: scripts/http.js, line 296 Returns: response from server Type Promise.&lt;JSON&gt; Type Definitions Config Http configuration Type: Object Properties: Name Type Argument Default Description isAuth boolean &lt;optional&gt; false if true, authorization required retryToken boolean &lt;optional&gt; false if true, retry with new token interactive boolean &lt;optional&gt; false user initiated, if true token string &lt;optional&gt; &lt;nullable&gt; null auth token backoff boolean &lt;optional&gt; true if true, do exponential back-off maxRetries int &lt;optional&gt; _MAX_ATTEMPTS max retries Source: scripts/http.js, line 18 Response Http response Type: Object Properties: Name Type Description ok boolean success flag json function returned data as JSON status int HTTP response code statusText string HTTP response message Source: scripts/http.js, line 30 × Search results Close "},"Chrome.JSONUtils.html":{"id":"Chrome.JSONUtils.html","title":"Namespace: JSONUtils","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: JSONUtils JSONUtils JSON utilities Source: scripts/json.js, line 13 Methods &lt;static&gt; parse(jsonString) → {JSON} Parse JSON, with exception handling Parameters: Name Type Description jsonString string string to parse Source: scripts/json.js, line 25 Returns: JSON Object, null on error Type JSON &lt;static&gt; shallowCopy(object) → {JSON} Return shallow copy of Object Parameters: Name Type Description object Object object to copy Source: scripts/json.js, line 42 Returns: JSON Object, null on error Type JSON × Search results Close "},"Chrome.Locale.html":{"id":"Chrome.Locale.html","title":"Namespace: Locale","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Locale Locale Locale methods Source: scripts/locales.js, line 14 See: https://developer.chrome.com/extensions/i18n Methods &lt;static&gt; getLocale() → {string} Get the current locale Source: scripts/locales.js, line 35 Returns: current locale e.g. en_US Type string &lt;static&gt; localize(messageName) → {string} Get the i18n string Parameters: Name Type Description messageName string key in messages.json Source: scripts/locales.js, line 26 Returns: internationalized string Type string × Search results Close "},"Chrome.Log.html":{"id":"Chrome.Log.html","title":"Namespace: Log","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Log Log Log a message. Will also store the LastError to local storage as 'lastError' Source: scripts/log.js, line 13 Methods &lt;static&gt; error( [message] [, method] [, title]) Log an error Parameters: Name Type Argument Default Description message string &lt;optional&gt; &lt;nullable&gt; 'unknown' override label method string &lt;optional&gt; &lt;nullable&gt; 'unknownMethod' override action title string &lt;optional&gt; &lt;nullable&gt; null a title for the error Source: scripts/log.js, line 24 &lt;static&gt; exception(exception [, message] [, fatal] [, title]) Log an exception Parameters: Name Type Argument Default Description exception Object the exception message string &lt;optional&gt; &lt;nullable&gt; null the error message fatal boolean &lt;optional&gt; true true if fatal title string &lt;optional&gt; &lt;nullable&gt; 'An exception was caught' a title for the error Source: scripts/log.js, line 41 × Search results Close "},"Chrome.Msg.html":{"id":"Chrome.Msg.html","title":"Namespace: Msg","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Msg Msg Wrapper for chrome messages Source: scripts/msg.js, line 14 See: https://developer.chrome.com/extensions/messaging Members &lt;private, static, constant&gt; _MSG :Object Chrome Messages Type: Object Properties: Name Type Description HIGHLIGHT Chrome.Msg.Message highlight a tab RESTORE_DEFAULTS Chrome.Msg.Message restore default settings STORAGE_EXCEEDED Chrome.Msg.Message local storage save failed STORE Chrome.Msg.Message save value to storage Source: scripts/msg.js, line 42 Methods &lt;static&gt; listen(listener) Add a listener for chrome messages Parameters: Name Type Description listener function function to receive messages Source: scripts/msg.js, line 91 &lt;static&gt; send(type) → {Promise.&lt;JSON&gt;} Send a chrome message Parameters: Name Type Description type Chrome.Msg.Message type of message Source: scripts/msg.js, line 71 Returns: response JSON Type Promise.&lt;JSON&gt; Type Definitions Message A Chrome message Type: Object Properties: Name Type Argument Description message string Unique name error Error an error item string | Object a message specific item updated boolean item is new or updated key string key name value Object &lt;nullable&gt; value of key Source: scripts/msg.js, line 19 × Search results Close "},"Chrome.Storage.html":{"id":"Chrome.Storage.html","title":"Namespace: Storage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Storage Storage Manage items in localStorage Source: scripts/storage.js, line 13 Methods &lt;static&gt; clearLastError() → {Promise.&lt;void&gt;} Set the LastError to an empty message in chrome.storage.local Source: scripts/storage.js, line 168 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; get(key [, def]) → {Object} Get a JSON parsed value from localStorage Parameters: Name Type Argument Default Description key string key to get value for def Object &lt;optional&gt; &lt;nullable&gt; null return value if key not found Source: scripts/storage.js, line 28 Returns: JSON object, null if key does not exist Type Object &lt;static&gt; getBool(key [, def]) → {boolean} Get boolean value from localStorage Parameters: Name Type Argument Default Description key string key to get value for def boolean &lt;optional&gt; &lt;nullable&gt; null return value if key not found Source: scripts/storage.js, line 64 Returns: value as boolean, null if key does not exist Type boolean &lt;static&gt; getInt(key [, def]) → {int} Get integer value from localStorage Parameters: Name Type Argument Default Description key string key to get value for def int &lt;optional&gt; &lt;nullable&gt; null optional value to return, if NaN Source: scripts/storage.js, line 44 Returns: value as integer, NaN on error Type int &lt;static&gt; getLastError() → {Promise.&lt;Chrome.Msg.LastError&gt;} Get the LastError from chrome.storage.local Source: scripts/storage.js, line 142 Returns: last error Type Promise.&lt;Chrome.Msg.LastError&gt; &lt;static&gt; LastError( [message] [, title]) An error that can be persisted Usage: const err = new LastError(message, title) Parameters: Name Type Argument Default Description message string &lt;optional&gt; &lt;nullable&gt; '' the message title string &lt;optional&gt; &lt;nullable&gt; 'An error occurred' the title Properties: Name Type Description name string Error name stack string stack trace Source: scripts/storage.js, line 127 &lt;static&gt; safeSet(key, value [, keyBool]) → {boolean} Save a value to localStorage only if there is enough room Parameters: Name Type Argument Description key string localStorage Key value Object value to save keyBool string &lt;optional&gt; key to a boolean value that is true if the primary key has non-empty value Source: scripts/storage.js, line 92 Returns: true if value was set successfully Type boolean &lt;static&gt; set(key [, value]) JSON stringify and save a value to localStorage Parameters: Name Type Argument Default Description key string key to set value for value Object &lt;optional&gt; &lt;nullable&gt; null new value, if null remove item Source: scripts/storage.js, line 74 &lt;static&gt; setLastError(error) → {Promise.&lt;void&gt;} Save the LastError to chrome.storage.local Parameters: Name Type Description error Chrome.Storage.LastError the LastError Source: scripts/storage.js, line 158 See: https://developer.chrome.com/apps/storage Returns: void Type Promise.&lt;void&gt; × Search results Close "},"Chrome.Time.html":{"id":"Chrome.Time.html","title":"Class: Time","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Class: Time Time Time Class new Time( [timeString]) Create a new Time Parameters: Name Type Argument Default Description timeString string &lt;optional&gt; &lt;nullable&gt; null in '00:00' format, if null use current Date Properties: Name Type Description _hr int 24 hour time _min int minutes Source: scripts/time.js, line 20 Members &lt;static&gt; MIN_IN_DAY Minutes in day Source: scripts/time.js, line 37 &lt;static&gt; MSEC_IN_DAY Milliseconds in day Source: scripts/time.js, line 46 Methods &lt;private, static&gt; _is24Hr( [frmt]) → {boolean} Determine if user wants 24 hr time Parameters: Name Type Argument Default Description frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: scripts/time.js, line 57 Returns: true for 24 hour time Type boolean &lt;static&gt; getStringFull(timeString [, frmt]) → {string} Get time as string suitable for display, including AM/PM if 12hr Parameters: Name Type Argument Default Description timeString string in '00:00' format frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: scripts/time.js, line 141 Returns: display string Type string &lt;static&gt; getStringShort() → {string} Get current time suitable for display w/o AM/PM if 12hr Source: scripts/time.js, line 151 Returns: display string Type string &lt;static&gt; getTime(timeString) → {int} Convert string to current time Parameters: Name Type Description timeString string in '00:00' format Source: scripts/time.js, line 80 Returns: time in milliSeconds from epoch Type int &lt;static&gt; getTimeDelta(timeString) → {int} Calculate time delta from now on a 24hr basis Parameters: Name Type Description timeString string in '00:00' format Source: scripts/time.js, line 96 Returns: time delta in minutes Type int &lt;static&gt; isInRange(start, stop) → {boolean} Determine if current time is between start and stop, inclusive Parameters: Name Type Description start string in '00:00' format stop string in '00:00' format Source: scripts/time.js, line 114 Returns: true if in the given range Type boolean &lt;private&gt; _parse(timeString) Parse time string Parameters: Name Type Description timeString string in '00:00' format Source: scripts/time.js, line 167 toString( [frmt]) → {string} Get string representation of Time Parameters: Name Type Argument Default Description frmt int &lt;optional&gt; &lt;nullable&gt; null optional format, overrides storage value Source: scripts/time.js, line 183 Returns: As string Type string × Search results Close "},"Chrome.Utils.html":{"id":"Chrome.Utils.html","title":"Namespace: Utils","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Utils Utils Utility methods Source: scripts/utils.js, line 13 Members &lt;private, static, constant&gt; _DEBUG :boolean Set to true if development build Type: boolean Source: scripts/utils.js, line 26 &lt;static&gt; DEBUG :boolean True if development build Type: boolean Source: scripts/utils.js, line 34 Methods &lt;static&gt; getChromeVersion() → {int} Get the Chrome version Source: scripts/utils.js, line 60 See: http://stackoverflow.com/a/4900484/4468645 Returns: Chrome major version Type int &lt;static&gt; getExtensionName() → {string} Get the extension's name Source: scripts/utils.js, line 40 Returns: Extension name Type string &lt;static&gt; getFullChromeVersion() → {string} Get the full Chrome version Source: scripts/utils.js, line 71 See: https://goo.gl/2ITMNO Returns: Chrome version Type string &lt;static&gt; getPlatformOS() → {Promise.&lt;string&gt;} Get the OS as a human readable string Source: scripts/utils.js, line 81 Returns: OS name Type Promise.&lt;string&gt; &lt;static&gt; getRandomInt(min, max) → {int} Returns a random integer between min and max inclusive Parameters: Name Type Description min int min value max int max value Source: scripts/utils.js, line 184 Returns: random int Type int &lt;static&gt; getRandomString( [len]) → {string} Get a random string of the given length Parameters: Name Type Argument Default Description len int &lt;optional&gt; 8 length of generated string Source: scripts/utils.js, line 166 Returns: a random string Type string &lt;static&gt; getVersion() → {string} Get the Extension version Source: scripts/utils.js, line 49 Returns: Extension version Type string &lt;static&gt; isChromeOS() → {Promise.&lt;boolean&gt;} Determine if we are Chrome OS Source: scripts/utils.js, line 127 Returns: true if ChromeOS Type Promise.&lt;boolean&gt; &lt;static&gt; isMac() → {Promise.&lt;boolean&gt;} Determine if we are a Mac Source: scripts/utils.js, line 138 Returns: true if Mac Type Promise.&lt;boolean&gt; &lt;static&gt; isWhiteSpace(str) → {boolean} Determine if a String is null or whitespace only Parameters: Name Type Argument Description str string &lt;nullable&gt; string to check Source: scripts/utils.js, line 156 Returns: true is str is whitespace or null Type boolean &lt;static&gt; isWindows() → {Promise.&lt;boolean&gt;} Determine if we are MS windows Source: scripts/utils.js, line 116 Returns: true if MS Windows Type Promise.&lt;boolean&gt; &lt;static&gt; noop() No operation Source: scripts/utils.js, line 148 &lt;static&gt; shuffleArray(array) Randomly sort an Array in place Fisher-Yates shuffle algorithm. Parameters: Name Type Description array Array Array to sort Source: scripts/utils.js, line 194 × Search results Close "},"ClipItem.html":{"id":"ClipItem.html","title":"Class: ClipItem","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Class: ClipItem ClipItem new ClipItem(text, date, fav, remote, device [, labelsId] [, labels]) Create a new ClipItem Parameters: Name Type Argument Default Description text string The text of the clip date int Time in milliSecs from epoch fav boolean true if this has been marked as a favorite remote boolean true if this came from a device other than ours device string A String representing the source device labelsId Array.&lt;labelsId&gt; &lt;optional&gt; [] Array of {@Label} PK's labels Array.&lt;Label&gt; &lt;optional&gt; [] Array of {@Label} objects Properties: Name Type Description _id int database PK Source: clip_item.js, line 25 Members &lt;static, constant&gt; _ERROR_NO_CLIP :string Error indicating ClipItem doesn't exist Type: string Source: clip_item.js, line 83 &lt;static, constant&gt; _ERROR_NO_LABEL :string Error indicating Label id doesn't exist Type: string Source: clip_item.js, line 76 &lt;static, constant&gt; ERROR_ADD_LABEL :string Error indicating Label add failed Type: string Source: clip_item.js, line 62 &lt;static, constant&gt; ERROR_DB_FULL :string Error indicating that the database is full Type: string Source: clip_item.js, line 48 &lt;static, constant&gt; ERROR_EMPTY_TEXT :string Error indicating that ClipItem text is null or all whitespace Type: string Source: clip_item.js, line 41 &lt;static, constant&gt; ERROR_REMOVE_FAILED :string Error indicating there were no non favorites to delete Type: string Source: clip_item.js, line 55 &lt;static, constant&gt; ERROR_REMOVE_LABEL :string Error indicating Label remove failed Type: string Source: clip_item.js, line 69 Methods &lt;private, static&gt; _deleteOlderThan(time) → {Promise.&lt;boolean&gt;} Delete non-favorite ClipItem objects older than the given time Parameters: Name Type Description time int time in millis since epoch Source: clip_item.js, line 563 Returns: true if items were deleted Type Promise.&lt;boolean&gt; &lt;static&gt; _deleteOldest() → {Promise.&lt;void&gt;} Delete the oldest non favorite Source: clip_item.js, line 575 Returns: Type Promise.&lt;void&gt; &lt;static&gt; add(text, date, fav, remote, device [, keepState]) → {Promise.&lt;ClipItem&gt;} Add new ClipItem to storage Parameters: Name Type Argument Default Description text string The text of the clip date int Time in milliSecs from epoch fav boolean true if this has been marked as a favorite remote boolean true if this came from a device other than ours device string A String representing the source device keepState boolean &lt;optional&gt; false if true keep labels and fav if true Source: clip_item.js, line 389 Returns: A new ClipItem Type Promise.&lt;ClipItem&gt; &lt;static&gt; bulkPut(clipItems) → {Promise.&lt;void&gt;} Add the given ClipItem objects Parameters: Name Type Description clipItems Array.&lt;ClipItem&gt; Source: clip_item.js, line 417 Returns: Type Promise.&lt;void&gt; &lt;static&gt; deleteOld() → {Promise.&lt;boolean&gt;} Delete items older than the storageDuration setting Source: clip_item.js, line 539 Returns: true if items were deleted Type Promise.&lt;boolean&gt; &lt;static&gt; get(text) → {Promise.&lt;(ClipItem|undefined)&gt;} Get a ClipItem data from the database Parameters: Name Type Description text string The text of the clip Source: clip_item.js, line 359 Returns: A new ClipItem, undefined if not found Type Promise.&lt;(ClipItem|undefined)&gt; &lt;static&gt; isTableEmpty() → {Promise.&lt;boolean&gt;} Is the database table empty Source: clip_item.js, line 444 Returns: true if no ClipItem objects Type Promise.&lt;boolean&gt; &lt;static&gt; loadAll( [labelName]) → {Promise.&lt;Array.&lt;ClipItem&gt;&gt;} Get all the ClipItem objects from storage, sorted from newest to oldest Parameters: Name Type Argument Default Description labelName string &lt;optional&gt; &lt;nullable&gt; '' optional Label name to filter on Source: clip_item.js, line 457 Returns: Type Promise.&lt;Array.&lt;ClipItem&gt;&gt; &lt;static&gt; remove(keys) → {Promise.&lt;void&gt;} Remove the given keys from the database Parameters: Name Type Description keys int | Array.&lt;int&gt; array of PK's to delete Source: clip_item.js, line 435 Returns: Type Promise.&lt;void&gt; &lt;static&gt; removeLabel(labelId) Remove the given Label PK from all ClipItem objects Parameters: Name Type Description labelId int Label PK to delete Source: clip_item.js, line 478 &lt;static&gt; updateLabel(newName, oldName) Update the given Label name in all ClipItem objects Parameters: Name Type Description newName string oldName string Source: clip_item.js, line 507 _addLabel(label) Add a {@label} - don't save Parameters: Name Type Description label Label Source: clip_item.js, line 229 _addOrUpdate() → {Promise.&lt;int&gt;} Add if new or update if existing Source: clip_item.js, line 262 Returns: database PK Type Promise.&lt;int&gt; _clearLabels() Clear labels - don't save Source: clip_item.js, line 220 _getId() → {Promise.&lt;(int|null)&gt;} Get our PK Source: clip_item.js, line 344 Returns: database PK or null if text not found Type Promise.&lt;(int|null)&gt; _removeLabel(id) → {boolean} Remove a Label - don't save Parameters: Name Type Description id int Label PK Source: clip_item.js, line 241 Returns: true if removed Type boolean _safeSave() → {Promise.&lt;void&gt;} Save to database, deleting old items if needed Source: clip_item.js, line 306 Returns: Type Promise.&lt;void&gt; _saveOrDeleteOldest() → {Promise.&lt;int&gt;} Save to the database or delete oldest non favorite if there is no room Source: clip_item.js, line 284 Returns: database PK if saved, nothing otherwise Type Promise.&lt;int&gt; addLabel(label) Add a label Parameters: Name Type Description label Label Source: clip_item.js, line 155 delete() → {Promise.&lt;void&gt;} Delete from database Source: clip_item.js, line 207 Returns: Type Promise.&lt;void&gt; getLabelNames() → {Array.&lt;string&gt;} Get our label names Source: clip_item.js, line 127 Returns: Type Array.&lt;string&gt; hasLabel(name) → {boolean} Do we contain a Label with the given name Parameters: Name Type Argument Description name string &lt;nullable&gt; Source: clip_item.js, line 140 Returns: Type boolean removeLabel(label) Remove a label Parameters: Name Type Description label Label Source: clip_item.js, line 172 save() → {Promise.&lt;void&gt;} Save to the database Source: clip_item.js, line 190 Returns: Type Promise.&lt;void&gt; setLabels(labelNames) → {Promise.&lt;int&gt;} Set our Label objects Parameters: Name Type Description labelNames Array.&lt;string&gt; names of labels Source: clip_item.js, line 90 Returns: our database PK Type Promise.&lt;int&gt; setLabelsById(labelIds) → {Promise.&lt;int&gt;} Set our Label objects Parameters: Name Type Description labelIds Array.&lt;int&gt; PK of labels Source: clip_item.js, line 109 Returns: our database PK Type Promise.&lt;int&gt; update(changes) → {Promise.&lt;int&gt;} Update the database Parameters: Name Type Description changes Object properties to change Source: clip_item.js, line 199 Returns: number of properties changed Type Promise.&lt;int&gt; × Search results Close "},"ClipList.html":{"id":"ClipList.html","title":"Namespace: ClipList","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ClipList ClipList Polymer element to display a list of ClipItem objects Source: clip-list.js, line 5 Members &lt;static&gt; clips Array of ClipItem objects filtered by labelFilter Source: clip-list.js, line 29 &lt;static&gt; hasSelections True if we have selected items Source: pages/main-page.js, line 77 &lt;static&gt; isBulkOp True if we are performing an operation on multiple clips Source: clip-list.js, line 79 &lt;static&gt; isFavFilter True if we are only showing favorite items Source: clip-list.js, line 58 &lt;static&gt; isPinFavs True if we are showing favorite items at top of list Source: clip-list.js, line 47 &lt;static&gt; labelFilter :string Label name for filtering our items Type: string Source: clip-list.js, line 69 &lt;static&gt; selClips Array of selected ClipItem objects Source: clip-list.js, line 38 Methods &lt;private, static&gt; _bulkOpChanged(newValue, oldValue) Observer: The bulkOp setting changed Parameters: Name Type Description newValue boolean oldValue boolean | undefined Source: clip-list.js, line 684 &lt;private, static&gt; _deleteAllClipItems() Delete all ClipItem objects Source: clip-list.js, line 541 &lt;private, static&gt; _deselect(clipItem) → {boolean} Deselect ClipItem if not already Parameters: Name Type Description clipItem ClipItem Source: clip-list.js, line 665 Returns: true if deselected Type boolean &lt;private, static&gt; _getClipPos(clipText) → {int} Get position of row with given text Parameters: Name Type Description clipText string text to find Source: clip-list.js, line 526 Returns: position in array, -1 if not found Type int &lt;private, static&gt; _hasClipItems() → {boolean} Do we have any ClipItem objects in the list Source: clip-list.js, line 515 Returns: true if we have at least one clip Type boolean &lt;private, static&gt; _hasSelections() → {boolean} Do we have selected items Source: clip-list.js, line 621 Returns: Type boolean &lt;private, static&gt; _isSelected(clipItem) → {boolean} Is a ClipItem selected Parameters: Name Type Description clipItem ClipItem Source: clip-list.js, line 632 Returns: Type boolean &lt;private, static&gt; _onClipRowTapped(event) Event: Tap on clip row - handle selections like a tree select Parameters: Name Type Description event Event Properties Name Type Description model.clip ClipItem Source: clip-list.js, line 391 &lt;private, static&gt; _onFocused(event) Event: iron-list got focus Parameters: Name Type Description event Event Properties Name Type Description model.clip ClipItem Source: clip-list.js, line 102 &lt;private, static&gt; _onRowLabelTapped(event) Event: Label icon of clip row tapped Parameters: Name Type Description event Event Properties Name Type Description model Object Source: clip-list.js, line 487 &lt;private, static&gt; _pinFavsChanged(newValue, oldValue) Observer: The pinFavs setting changed Parameters: Name Type Description newValue boolean oldValue boolean | undefined Source: clip-list.js, line 501 &lt;private, static&gt; _select(clipItem) → {boolean} Select ClipItem if not already Parameters: Name Type Description clipItem ClipItem Source: clip-list.js, line 646 Returns: true if selected Type boolean &lt;private, static&gt; _sortClipItems() Sort the ClipItem list Source: clip-list.js, line 552 &lt;private, static&gt; _updateSelections(selClips [, scrollIndex]) Update the selected items Parameters: Name Type Argument Default Description selClips Array.&lt;ClipItem&gt; ClipItems to select scrollIndex int &lt;optional&gt; 0 Source: clip-list.js, line 606 &lt;private, static&gt; addClipItem(text) Add a ClipItem to the list Parameters: Name Type Description text string ClipItem text Source: clip-list.js, line 141 &lt;private, static&gt; deleteClipItem(text) Delete a ClipItem from the list Parameters: Name Type Description text string ClipItem text Source: clip-list.js, line 209 &lt;static&gt; deselectAll() Deselect all ClipItem Source: clip-list.js, line 312 &lt;static&gt; getClip(clipText) → {ClipItem} Get clip from text Parameters: Name Type Description clipText string text to find Source: clip-list.js, line 242 Returns: null if not found Type ClipItem &lt;private, static&gt; getLastSelected() → {ClipItem} Get last selected ClipItem Source: clip-list.js, line 286 Returns: null if none selected Type ClipItem &lt;private, static&gt; getSelected() → {Array.&lt;ClipItem&gt;} Get the selected ClipItem objects Source: clip-list.js, line 272 Returns: Type Array.&lt;ClipItem&gt; &lt;private, static&gt; getSelectedCount() → {int} Get the number of selected ClipItem objects Source: clip-list.js, line 258 Returns: Type int &lt;static&gt; loadClipItems( [isSelectFirst]) → {Promise.&lt;void&gt;} Load the ClipItem objects Parameters: Name Type Argument Default Description isSelectFirst boolean &lt;optional&gt; true if true select first item Source: clip-list.js, line 113 Returns: Type Promise.&lt;void&gt; &lt;static&gt; ready() Element is ready Source: clip-list.js, line 91 &lt;static&gt; scrollToText(text) Scroll to the ClipItem with the given text Parameters: Name Type Description text string Source: clip-list.js, line 377 &lt;static&gt; selectAll() Select all ClipItem Source: clip-list.js, line 298 &lt;static&gt; selectByText(text) → {boolean} Select ClipItem with the given text if not already Parameters: Name Type Description text string Source: clip-list.js, line 359 Returns: true if selected Type boolean &lt;static&gt; selectClipItems(clipItems) Select the given array of ClipItem objects Parameters: Name Type Description clipItems Array.&lt;ClipItem&gt; Source: clip-list.js, line 324 &lt;static&gt; selectFirst( [ifNoSelections]) → {boolean} Select first item in list, if it is not already Parameters: Name Type Argument Default Description ifNoSelections boolean &lt;optional&gt; false if true, only do if no selections Source: clip-list.js, line 345 Returns: true if selected Type boolean &lt;private, static&gt; updateClipItem(text, mods) Update a ClipItem in the list Parameters: Name Type Description text string ClipItem text mods Object key/value pairs of changes Source: clip-list.js, line 168 &lt;static&gt; updateDates() Update the relative dates Source: clip-list.js, line 225 Events row-label-tap Fired when the label button of a row is tapped Source: clip-list.js, line 19 selected-clip-change Fired when the selected clip changes Source: clip-list.js, line 13 × Search results Close "},"ClipRow.html":{"id":"ClipRow.html","title":"Namespace: ClipRow","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ClipRow ClipRow Polymer element to display a row in the ClipList Source: clip-row.js, line 5 Members &lt;static&gt; clip Our ClipItem Source: clip-row.js, line 24 &lt;static&gt; selected True if we are selected Source: clip-row.js, line 34 Methods &lt;private, static&gt; _computeClipClass(selected) → {string} Computed Binding: Clip item classList Parameters: Name Type Description selected boolean is clip selected Source: clip-row.js, line 113 Returns: Clip item classList Type string &lt;private, static&gt; _computeDate(date) → {string} Computed Binding: relative date Parameters: Name Type Description date int from epoch in millis Source: clip-row.js, line 128 Returns: Date as relative from now Type string &lt;private, static&gt; _computeFavColor(isTrue) → {string} Computed Binding: color of fav icon Parameters: Name Type Description isTrue boolean true if fav Source: clip-row.js, line 150 Returns: Favorite icon color Type string &lt;private, static&gt; _computeFavIcon(isTrue) → {string} Computed Binding: fav icon Parameters: Name Type Description isTrue boolean true if fav Source: clip-row.js, line 139 Returns: icon style Type string &lt;private, static&gt; _onCopyTapped(event) Event: Copy ClipItem to clipboard Parameters: Name Type Description event Event Properties Name Type Description model.clip ClipItem Source: clip-row.js, line 48 &lt;private, static&gt; _onFavTapped(event) Event: Toggle favorite state of row Parameters: Name Type Description event Event Properties Name Type Description model.clip ClipItem Source: clip-row.js, line 77 &lt;private, static&gt; _onLabelTapped(event) Event: Label icon of clip row tapped Parameters: Name Type Description event Event Properties Name Type Description model Object Source: clip-row.js, line 97 Events label-tap Fired when the label button of a row is tapped Source: clip-row.js, line 14 × Search results Close "},"ClipViewer.html":{"id":"ClipViewer.html","title":"Namespace: ClipViewer","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ClipViewer ClipViewer Polymer element to display a ClipItem Source: clip-viewer.js, line 5 Members &lt;static&gt; clipItem ClipItem to view Source: clip-viewer.js, line 36 &lt;static&gt; editText Text currently being edited Source: clip-viewer.js, line 68 &lt;static&gt; isEditMode Are we editing the text Source: clip-viewer.js, line 57 &lt;static&gt; labels Array of Label objects for the ClipItem Source: clip-viewer.js, line 47 Methods &lt;private, static&gt; _clearEditMode() Reset to view mode Source: clip-viewer.js, line 224 &lt;private, static&gt; _clipItemChanged() Observer: The current clip changed Source: clip-viewer.js, line 150 &lt;private, static&gt; _computeAddEditIcon(clipItem) → {string} Computed property: Icon for editMode fab Parameters: Name Type Description clipItem ClipItem Source: clip-viewer.js, line 204 Returns: Type string &lt;private, static&gt; _computeAddEditTitle(clipItem) → {string} Computed property: Title (tooltip) for editMode fab Parameters: Name Type Description clipItem ClipItem Source: clip-viewer.js, line 193 Returns: Type string &lt;private, static&gt; _computeTextAreaLabel(clipItem) → {string} Computed property: Label for editMode fab Parameters: Name Type Description clipItem ClipItem Source: clip-viewer.js, line 215 Returns: Type string &lt;private, static&gt; _isEditModeChanged() Observer: The label filter changed Source: clip-viewer.js, line 139 &lt;private, static&gt; _onCancelEditModeTapped() Event: Cancel edit mode fab tapped Source: clip-viewer.js, line 107 &lt;private, static&gt; _onEditModeTapped() Event: Edit mode fab tapped Source: clip-viewer.js, line 90 &lt;private, static&gt; _onLabelsTapped() Event: Labels section tapped Source: clip-viewer.js, line 80 &lt;private, static&gt; _onSaveChangesTapped() Event: Save changes fab tapped Source: clip-viewer.js, line 118 Events clip-add Fires when a new clip should be added Source: clip-viewer.js, line 26 labels-tapped Fires when labels section is tapped Source: clip-viewer.js, line 14 text-changed Fires when text is changed Source: clip-viewer.js, line 20 × Search results Close "},"ContentScript.html":{"id":"ContentScript.html","title":"Namespace: ContentScript","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ContentScript ContentScript Content script to monitor clipboard copy and cuts Source: on_copy_cut_content_script.js, line 8 Methods &lt;static&gt; window.onMyCopy() On copy or cut event, send a message to our extension Source: on_copy_cut_content_script.js, line 24 × Search results Close "},"Device.html":{"id":"Device.html","title":"Class: Device","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Class: Device Device new Device(model, sn, os, nickname, lastSeen) Creates a new Device instance. Parameters: Name Type Description model string The model name of a device sn string The serial number (or other descriptor) of a device os string The operating system of a device nickname string The nickname of a device lastSeen int A date in millis from the epoch Source: device.js, line 22 Members &lt;static, constant&gt; MODEL Model key Default Value: dM Source: device.js, line 39 &lt;static, constant&gt; NICKNAME Nickname key Default Value: dN Source: device.js, line 60 &lt;static, constant&gt; OS Operating system key Default Value: dOS Source: device.js, line 53 &lt;static, constant&gt; SN Serial Number key Default Value: dSN Source: device.js, line 46 Methods &lt;static&gt; myModel() → {string} Get model name of our Device Source: device.js, line 114 Returns: model name Type string &lt;static&gt; myName() → {string} Get display name of our Device Source: device.js, line 102 Returns: display name Type string &lt;static&gt; myNickname() → {string} Get nickname of our Device Source: device.js, line 146 Returns: nickname Type string &lt;static&gt; myOS() → {string} Get operating system of our Device Source: device.js, line 130 Returns: operating system Type string &lt;static&gt; mySN() → {string} Get serial number of our Device Source: device.js, line 122 Returns: serial number Type string &lt;static&gt; myUniqueName() → {string} Get unique name of our Device Source: device.js, line 94 Returns: unique name Type string &lt;static&gt; myVersion() → {string} Get os version of our Device Source: device.js, line 138 Returns: operating system version Type string getName() → {string} Get name suitable for display Source: device.js, line 74 Returns: descriptive name of Device Type string getUniqueName() → {string} Get a String that uniquely (hopefully) determines this Device Source: device.js, line 66 Returns: unique name Type string isMe() → {boolean} Determine if this is our Device Source: device.js, line 86 Returns: true if this is our Device Type boolean × Search results Close "},"DevicesPage.html":{"id":"DevicesPage.html","title":"Namespace: DevicesPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: DevicesPage DevicesPage Polymer element to manage our Device objects Source: pages/devices-page.js, line 19 Members &lt;static&gt; devices The Array of Device objects Source: pages/devices-page.js, line 31 &lt;static&gt; infoMessage A message about why Device list is not available Source: pages/devices-page.js, line 41 Methods &lt;private, static&gt; _computeDate(date) → {string} Computed property: Relative date string Parameters: Name Type Description date int Source: pages/devices-page.js, line 128 Returns: Type string &lt;private, static&gt; _computeHasInfoMessage(infoMessage) → {boolean} Computed property: Do we have an info message Parameters: Name Type Description infoMessage string Source: pages/devices-page.js, line 139 Returns: Type boolean &lt;private, static&gt; _loadDevices() Load the devices Source: pages/devices-page.js, line 148 &lt;private, static&gt; _onChromeMessage(request) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the Source: pages/devices-page.js, line 82 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onDeleteTapped(event) Event: Delete Device button tapped Parameters: Name Type Description event Event Properties Name Type Description model Object Source: pages/devices-page.js, line 99 &lt;private, static&gt; _onFabTapped() Event: Refresh Fab tapped Source: pages/devices-page.js, line 112 &lt;private, static&gt; _ping() Ping our devices Source: pages/devices-page.js, line 183 &lt;private, static&gt; _sortByDate(a, b) → {int} Sort filter for the Devices - by last seen date Parameters: Name Type Description a Device first comparator b Device second comparator Source: pages/devices-page.js, line 174 Returns: Type int &lt;static&gt; onCurrentPage() We hare now the current page Source: pages/devices-page.js, line 61 &lt;static&gt; ready() Element is ready Source: pages/devices-page.js, line 52 × Search results Close "},"ErrorPage.html":{"id":"ErrorPage.html","title":"Namespace: ErrorPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ErrorPage ErrorPage Polymer element to display a Chrome.Storage.LastError object Source: pages/error-page.js, line 7 Members &lt;static&gt; lastError A Chrome.Storage.LastError Source: pages/error-page.js, line 19 Methods &lt;private, static&gt; _computeStack(lastError) → {string} Computed Binding Parameters: Name Type Description lastError Chrome.Storage.LastError Source: pages/error-page.js, line 87 Returns: stack trace Type string &lt;private, static&gt; _computeTitle(lastError) → {string} Computed Binding Parameters: Name Type Description lastError Chrome.Storage.LastError Source: pages/error-page.js, line 102 Returns: page title Type string &lt;private, static&gt; _onEmailTapped() Event: Send Email to support address Source: pages/error-page.js, line 58 &lt;private, static&gt; _onRemoveTapped() Event: Clear the error Source: pages/error-page.js, line 75 &lt;static&gt; ready() Element is ready Source: pages/error-page.js, line 32 × Search results Close "},"ExceptionHandler.html":{"id":"ExceptionHandler.html","title":"Class: ExceptionHandler","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Class: ExceptionHandler ExceptionHandler new ExceptionHandler() Log Exceptions with analytics. Include: new ExceptionHandler() at top of every js file Source: scripts/exception_handler.js, line 21 × Search results Close "},"HelpPage.html":{"id":"HelpPage.html","title":"Namespace: HelpPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: HelpPage HelpPage Polymer element to display Help and Feedback links Source: pages/help-page.js, line 8 Members &lt;static&gt; githubPagesPath Path to github project's pages Source: pages/help-page.js, line 32 &lt;static&gt; githubPath Path to github project Source: pages/help-page.js, line 20 Methods &lt;private, static&gt; _computeMailToUrl(subject) → {string} computed binding: Get a mailto url Parameters: Name Type Description subject string email subject Source: pages/help-page.js, line 59 Returns: url Type string &lt;private, static&gt; _computeVersion() → {string} computed binding: Get the extension version Source: pages/help-page.js, line 47 Returns: version Type string × Search results Close "},"Label.html":{"id":"Label.html","title":"Class: Label","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Class: Label Label new Label(name) A Label for a ClipItem Parameters: Name Type Description name string label name Properties: Name Type Description _id int database PK Source: label.js, line 19 Members &lt;static, constant&gt; ERROR_EMPTY_TEXT :string Error indicating that Label name is null or all whitespace Type: string Source: label.js, line 76 &lt;static, constant&gt; ERROR_EXISTS :string Error indicating that Label is already in database Type: string Source: label.js, line 83 Methods &lt;static&gt; add(name) → {Promise.&lt;Label&gt;} Add a new Label to database Parameters: Name Type Description name string The text of the label Source: label.js, line 90 Returns: A new Label Type Promise.&lt;Label&gt; &lt;static&gt; isTableEmpty() → {Promise.&lt;boolean&gt;} Return true is there are no stored Label objects Source: label.js, line 112 Returns: true if no Label objects Type Promise.&lt;boolean&gt; &lt;static&gt; loadAll() → {Promise.&lt;Array&gt;} Return all the Label objects from storage Source: label.js, line 122 Returns: Array of Label objects Type Promise.&lt;Array&gt; delete() → {Promise.&lt;void&gt;} Delete from database Source: label.js, line 64 Returns: void Type Promise.&lt;void&gt; getId() → {Promise.&lt;(int|null)&gt;} Get the PK for our name Source: label.js, line 27 Returns: database PK or null if name not found Type Promise.&lt;(int|null)&gt; save() → {Promise.&lt;int&gt;} Save to database Source: label.js, line 53 Returns: database PK Type Promise.&lt;int&gt; setName(name) → {Promise.&lt;boolean&gt;} Update our name Parameters: Name Type Description name string Source: label.js, line 41 Returns: true if database updated Type Promise.&lt;boolean&gt; × Search results Close "},"LabelsDialog.html":{"id":"LabelsDialog.html","title":"Namespace: LabelsDialog","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: LabelsDialog LabelsDialog Polymer dialog to select from a list of labels Source: labels-dialog.js, line 5 Members &lt;static&gt; dialogTitle Dialog title Source: labels-dialog.js, line 17 &lt;static&gt; labels Array of all Label objects Source: labels-dialog.js, line 27 &lt;static&gt; selectedLabels Array of selected Label names Source: labels-dialog.js, line 37 Methods &lt;private, static&gt; close() Hide the dialog Source: labels-dialog.js, line 69 &lt;private, static&gt; open() Show the dialog Source: labels-dialog.js, line 49 × Search results Close "},"LabelsPage.html":{"id":"LabelsPage.html","title":"Namespace: LabelsPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: LabelsPage LabelsPage Polymer element to manage our Label objects Source: pages/labels-page.js, line 8 Members &lt;static&gt; addText The text in the Add textInput Source: pages/labels-page.js, line 28 Methods &lt;private, static&gt; _addLabel() Add a new label Source: pages/labels-page.js, line 178 &lt;private, static&gt; _addTextChanged() Observer: LabelsPage.addText changed Source: pages/labels-page.js, line 233 &lt;private, static&gt; _itemsChanged(changeRecord) Observer: LabelsPage.items changed Parameters: Name Type Description changeRecord Object details of change Source: pages/labels-page.js, line 247 &lt;private, static&gt; _loadLabels() Load the Labels from the database Source: pages/labels-page.js, line 135 &lt;private, static&gt; _onAddKeyUp(event) Event: Add text key up Parameters: Name Type Description event Event key-up event Source: pages/labels-page.js, line 75 &lt;private, static&gt; _onAddTapped() Event: Add text button tapped Source: pages/labels-page.js, line 65 &lt;private, static&gt; _onDeleteTapped(event) Event: Delete button tapped for a label Parameters: Name Type Description event Event Properties Name Type Description model Object Source: pages/labels-page.js, line 89 &lt;private, static&gt; _onListItemBlur(event) Event: Label input lost focus Parameters: Name Type Description event Event Properties Name Type Description model Object Source: pages/labels-page.js, line 113 &lt;private, static&gt; _onListItemKeyUp(event) Event: Label input key up Parameters: Name Type Description event Event Properties Name Type Description model Object Source: pages/labels-page.js, line 124 &lt;private, static&gt; _sortByName(a, b) → {int} Sort filter for the Labels - alphabetical Parameters: Name Type Description a LabelsPage.Item first comparator b LabelsPage.Item second comparator Source: pages/labels-page.js, line 161 Returns: Type int &lt;private, static&gt; _updateListLabel(item) Update an exiting label Parameters: Name Type Description item LabelsPage.Item Source: pages/labels-page.js, line 205 &lt;static&gt; onCurrentPage() We have animated in and are now the current page Source: pages/labels-page.js, line 55 Type Definitions Item A list item Type: Object Properties: Name Type Description label Label newName string Source: pages/labels-page.js, line 15 Items The Array of list objects Type: Array.&lt;LabelsPage.Item&gt; Source: pages/labels-page.js, line 35 × Search results Close "},"Main.html":{"id":"Main.html","title":"Namespace: Main","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: Main Main Script for the main.html page Source: main/main.js, line 10 Members &lt;static, constant&gt; ANDROID_URI :string Path to the android app in the Play Store Type: string Source: main/main.js, line 34 &lt;static, constant&gt; EXT_URI :string Path to the extension in the Web Store Type: string Source: main/main.js, line 25 &lt;static&gt; onHighlightRoute :string Route to use on tab highlight, blank keep current Type: string Source: main/main.js, line 207 &lt;static&gt; pages :Array.&lt;Main.page&gt; Array concatenation of Main.page objects Type: Array.&lt;Main.page&gt; Source: main/main.js, line 193 &lt;static&gt; prevRoute :string Previous route Type: string Source: main/main.js, line 200 &lt;static, constant&gt; SCREEN_SAVER_URI :string Path to my screen saver extension Type: string Source: main/main.js, line 44 &lt;static, constant&gt; t :Object Auto-binding template Type: Object Source: main/main.js, line 54 &lt;static&gt; t.avatar :string User photo Type: string Source: main/main.js, line 185 &lt;static&gt; t.dialogText :string Error dialog text Type: string Source: main/main.js, line 164 &lt;static&gt; t.dialogTitle :string Error dialog title Type: string Source: main/main.js, line 157 &lt;static&gt; t.pagesLabels :Array.&lt;Main.page&gt; Array of Main.page objects for the Label objects Type: Array.&lt;Main.page&gt; Source: main/main.js, line 150 &lt;static, constant&gt; t.pagesOne :Array.&lt;Main.page&gt; Array of Main.page objects Type: Array.&lt;Main.page&gt; Source: main/main.js, line 78 &lt;static, constant&gt; t.pagesTwo :Array.&lt;Main.page&gt; Array of Main.page objects Type: Array.&lt;Main.page&gt; Source: main/main.js, line 107 &lt;static&gt; t.permissions :string Content Script permission Type: string Source: main/main.js, line 178 &lt;static&gt; t.route :string Current route Type: string Source: main/main.js, line 171 Methods &lt;static&gt; _buildPages() → {Promise.&lt;void&gt;} Build the menu items Source: main/main.js, line 695 Returns: Type Promise.&lt;void&gt; &lt;static&gt; _checkOptionalPermissions() Display dialog to prompt for accepting optional permissions if it has not been set yet Source: main/main.js, line 657 &lt;static&gt; _closeDrawer() Close drawer if drawerPanel is narrow Source: main/main.js, line 683 &lt;static&gt; _getLabelPages() → {Promise.&lt;Array.&lt;Main.page&gt;&gt;} Build the menu items for Label objects Source: main/main.js, line 711 Returns: Type Promise.&lt;Array.&lt;Main.page&gt;&gt; &lt;static&gt; _getPageIdx(route) → {int} Get the index into the Main.pages array Parameters: Name Type Description route string Main.page route Source: main/main.js, line 612 Returns: index into array, -1 if not found Type int &lt;static&gt; _getPagesLabelsIdx(label) → {int} Get the index into the label pages array Parameters: Name Type Description label string Main.page route Source: main/main.js, line 624 Returns: index into array, -1 if not found Type int &lt;static&gt; _onChromeMessage(request, sender, response) Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: main/main.js, line 497 See: https://developer.chrome.com/extensions/runtime#event-onMessage &lt;static&gt; _onChromeStorageChanged(changes) Event: Fired when changes occur in Chrome.storage Parameters: Name Type Description changes Array storage changes Source: main/main.js, line 542 See: https://developer.chrome.com/apps/storage &lt;static&gt; _onDomChange() Event: Template Bound, bindings have resolved and content has been stamped to the page Source: main/main.js, line 214 &lt;static&gt; _onHighlighted(highlightInfo) Event: Fired when the highlighted or selected tabs in a window changes. Parameters: Name Type Description highlightInfo Object info Source: main/main.js, line 559 See: https://developer.chrome.com/extensions/tabs#event-onHighlighted &lt;static&gt; _onLoad() Event: Document and resources loaded Source: main/main.js, line 252 &lt;static&gt; _onStorageChanged(event) Event: Fired when item in localStorage changes Parameters: Name Type Description event Event storage event Properties Name Type Description key string value that changed Source: main/main.js, line 528 See: https://developer.mozilla.org/en-US/docs/Web/Events/storage &lt;static&gt; _onSWMessage(event) Event: Fired when a message is posted from out service worker Parameters: Name Type Description event Event Source: main/main.js, line 469 &lt;static&gt; _scrollPageToTop() Scroll Main Panel to top Source: main/main.js, line 675 &lt;static&gt; _setDevicesMenuState() Set enabled state of Devices menu item Source: main/main.js, line 730 &lt;static&gt; _setErrorMenuState() Set enabled state of Error Viewer menu item Source: main/main.js, line 745 &lt;static&gt; _setHighlightRoute() Set the route from onHighlightRoute Source: main/main.js, line 580 &lt;static&gt; _showPage(page) Show a Main.page Parameters: Name Type Description page Main.page Source: main/main.js, line 635 &lt;static&gt; _showPermissionsDialog() Show the permissions dialog Source: main/main.js, line 667 &lt;static&gt; t._computeAvatarDisplay(avatar) → {string} Computed Binding: Determine if avatar should be visible Parameters: Name Type Description avatar string photo url Source: main/main.js, line 456 Returns: display type Type string &lt;static&gt; t._computePermissionsStatus(permissions) → {string} Computed Binding: Determine content script permission status string Parameters: Name Type Description permissions string current setting Source: main/main.js, line 446 Returns: Type string &lt;static&gt; t._onAcceptPermissionsClicked() Event: Clicked on accept permissions dialog button Source: main/main.js, line 396 &lt;static&gt; t._onDenyPermissionsClicked() Event: Clicked on deny permissions dialog button Source: main/main.js, line 412 &lt;static&gt; t._onNavMenuItemTapped(event) Event: navigation menu selected Parameters: Name Type Description event Event Source: main/main.js, line 311 &lt;static&gt; t._onPageChanged(event) Event: Selected Main.page changed Parameters: Name Type Description event Event Source: main/main.js, line 361 &lt;static&gt; t._onShowErrorDialog(event) Event: display error dialog Parameters: Name Type Description event Event Source: main/main.js, line 350 &lt;static&gt; t._onSortLabelPages(pageA, pageB) → {int} Event: Sort the label pages alphabetically Parameters: Name Type Description pageA Main.page pageB Main.page Source: main/main.js, line 428 Returns: 0 if same, -1 if lower, 1 if higher Type int Type Definitions page Manage an html page that is inserted on demand May also be a url link to external site Type: Object Properties: Name Type Argument Description label string label for Nav menu route string element name route to page icon string icon for Nav Menu obj Object | function something to be done when selected ready boolean true if html is inserted factory function &lt;nullable&gt; function to build page insertion string &lt;nullable&gt; id of insertion point el Element &lt;nullable&gt; Polymer element divider boolean true for divider before item Source: main/main.js, line 56 × Search results Close "},"MainPage.html":{"id":"MainPage.html","title":"Namespace: MainPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: MainPage MainPage Polymer element to display and manage ClipItem objects Source: pages/main-page.js, line 11 Members &lt;static&gt; canSend True if we can send the clipboard contents Source: pages/main-page.js, line 86 &lt;static&gt; currentClip ClipItem currently being viewed Source: pages/main-page.js, line 23 &lt;static&gt; isBulkOp True if we are performing an operation on multiple clips Source: pages/main-page.js, line 136 &lt;static&gt; isEditMode Are we editing currentClip Source: pages/main-page.js, line 33 &lt;static&gt; isFavFilter :boolean True if we are only showing favorite items Type: boolean Source: pages/main-page.js, line 44 &lt;static&gt; isMultiLabelsEdit True if label changes in dialog should apply to all selectedClips Source: pages/main-page.js, line 126 &lt;static&gt; isPinFavs :boolean True if we are showing favorite items at top of list Type: boolean Source: pages/main-page.js, line 55 &lt;static&gt; labelFilter :string Label name for filtering our items Type: string Source: pages/main-page.js, line 66 &lt;static&gt; selDialogLabels Array of all selected Label names in the dialog Source: pages/main-page.js, line 116 &lt;static&gt; undoClips Array of ClipItem objects that have been recently deleted Source: pages/main-page.js, line 96 &lt;static&gt; undoText Message of undo toast Source: pages/main-page.js, line 106 Methods &lt;private, static&gt; _closeUndoToast() Close the Undo Toast Source: pages/main-page.js, line 793 &lt;private, static&gt; _computeFavIcon(isTrue) → {string} Computed Binding Parameters: Name Type Description isTrue boolean true if fav Source: pages/main-page.js, line 672 Returns: icon style Type string &lt;private, static&gt; _computeFavMenuColor(isTrue) → {string} Computed Binding Parameters: Name Type Description isTrue boolean true if fav Source: pages/main-page.js, line 694 Returns: fav filter menu icon color Type string &lt;private, static&gt; _computeFavToolTip(isFilter) → {string} Computed Binding Parameters: Name Type Description isFilter boolean true if filtering by fav Source: pages/main-page.js, line 683 Returns: tooltip text of what toggling would be Type string &lt;private, static&gt; _computeLabelsDialogTitle(multi) → {string} Computed Binding: Title of Labels Dialog Parameters: Name Type Description multi boolean true if dialog applies to all selectedClips Source: pages/main-page.js, line 635 Returns: Dialog title Type string &lt;private, static&gt; _computePinIcon(isTrue) → {string} Computed Binding Parameters: Name Type Description isTrue boolean true if we should pin favs to top Source: pages/main-page.js, line 650 Returns: icon style Type string &lt;private, static&gt; _computePinToolTip(isTrue) → {string} Computed Binding Parameters: Name Type Description isTrue boolean true if pinning favorites Source: pages/main-page.js, line 661 Returns: tooltip text of what toggling would be Type string &lt;private, static&gt; _computeTitle(clipItem, labelName) → {string} Computed Binding Parameters: Name Type Description clipItem ClipItem labelName string Source: pages/main-page.js, line 613 Returns: Page title Type string &lt;private, static&gt; _initPinFavs() Event: Initialize pinFavs if it is not in localStorage Source: pages/main-page.js, line 516 &lt;private, static&gt; _labelFilterChanged(newValue, oldValue) Observer: The label filter changed Parameters: Name Type Description newValue string oldValue string | undefined Source: pages/main-page.js, line 527 &lt;private, static&gt; _loadClipItems( [isSelectFirst]) → {Promise.&lt;void&gt;} Load the ClipItem objects Parameters: Name Type Argument Default Description isSelectFirst boolean &lt;optional&gt; true if true select first item Source: pages/main-page.js, line 705 Returns: Type Promise.&lt;void&gt; &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the sender Object MessageSender object response function function to call once after processing Source: pages/main-page.js, line 218 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _onCloseToastTapped() Event: Undo Toast close button tapped Source: pages/main-page.js, line 342 &lt;private, static&gt; _onCopy() Event: Text was copied to clipboard Source: pages/main-page.js, line 504 &lt;private, static&gt; _onDeleteSelectedTapped() Event: Delete menu icon tapped Source: pages/main-page.js, line 270 &lt;private, static&gt; _onDeselectAllTapped() Event: Deselect all menu icon tapped Source: pages/main-page.js, line 260 &lt;private, static&gt; _onFavFilterTapped() Event: Favorite filter menu icon tapped Source: pages/main-page.js, line 327 &lt;private, static&gt; _onLoad() Document and resources loaded Source: pages/main-page.js, line 806 &lt;private, static&gt; _onPinTapped() Event: Pin menu icon tapped Source: pages/main-page.js, line 317 &lt;private, static&gt; _onRowLabelTapped(event) Event: Label of ClipItem row tapped Parameters: Name Type Description event Event Source: pages/main-page.js, line 395 &lt;private, static&gt; _onSelectAllTapped() Event: Select all menu icon tapped Source: pages/main-page.js, line 249 &lt;private, static&gt; _onSelectedClipChanged() Event: The selected ClipItem changed Source: pages/main-page.js, line 384 &lt;private, static&gt; _onSelectLabelsTapped() Event: Select labels menu icon tapped Source: pages/main-page.js, line 239 &lt;private, static&gt; _onSendTapped() Event: Send clipboard contents icon tapped Source: pages/main-page.js, line 307 &lt;private, static&gt; _onUndoDeleteTapped() Event: Undo Toast button tapped Restore the deleted Items Source: pages/main-page.js, line 353 &lt;private, static&gt; _onViewerClipAdd(event) Event: ClipViewer wants to add a new ClipItem Parameters: Name Type Description event Event Properties Name Type Description detail Event text for clip Source: pages/main-page.js, line 479 &lt;private, static&gt; _onViewerLabelsTapped(event) Event: Labels of ClipViewer tapped Parameters: Name Type Description event Event Source: pages/main-page.js, line 405 &lt;private, static&gt; _onViewerTextChanged(event) Event: ClipViewer wants to change the text Parameters: Name Type Description event Event Properties Name Type Description detail Event new text Source: pages/main-page.js, line 416 &lt;private, static&gt; _selDialogLabelsAddedOrRemoved(changeRecord) Observer: selDialogLabels Array mutations Parameters: Name Type Description changeRecord Object Source: pages/main-page.js, line 542 &lt;private, static&gt; _setCurrentClip() Set clip viewer contents based on last selected Source: pages/main-page.js, line 715 &lt;private, static&gt; _showLabelsDialog(multi) Show Labels select dialog Parameters: Name Type Description multi boolean if true apply changes to all selectItems Source: pages/main-page.js, line 731 &lt;private, static&gt; _showMessageToast(text [, err]) Show an auto hiding message toast Parameters: Name Type Argument Default Description text string err Error &lt;optional&gt; &lt;nullable&gt; null Source: pages/main-page.js, line 779 &lt;static&gt; onCurrentPage() We have animated in and are now the current page Source: pages/main-page.js, line 176 &lt;static&gt; onLeavePage() We are not going to be current anymore Source: pages/main-page.js, line 187 &lt;static&gt; ready() Element is ready Source: pages/main-page.js, line 151 &lt;static&gt; setLabelFilter( [labelName]) Set Label name for filtering Parameters: Name Type Argument Default Description labelName string &lt;optional&gt; '' Source: pages/main-page.js, line 198 × Search results Close "},"ReceiveMsg.html":{"id":"ReceiveMsg.html","title":"Namespace: ReceiveMsg","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ReceiveMsg ReceiveMsg Handle incoming push messages Source: background/receive_msg.js, line 10 Members &lt;private, static, constant&gt; MESSAGE_WAIT_MILLIS :int Delay time for fcm message processing Type: int Default Value: 500 Source: background/receive_msg.js, line 24 Methods &lt;private, static&gt; _getDevice(data) → {Device} Get new Device from app.Msg.GaeMsg Parameters: Name Type Description data app.Msg.GaeMsg push data Source: background/receive_msg.js, line 33 Returns: a Device Type Device &lt;private, static&gt; _onWebRequestBefore(details) → {Object} Event: Fired when a Web request is about to occur. Capture the Service Worker request and process messages Parameters: Name Type Description details Object details on the request Source: background/receive_msg.js, line 100 See: https://goo.gl/4j4RtY Returns: cancel the request Type Object &lt;private, static&gt; _process(data) Process received push notifications Parameters: Name Type Description data app.Msg.GaeMsg push message Source: background/receive_msg.js, line 43 × Search results Close "},"ServiceWorker.html":{"id":"ServiceWorker.html","title":"Namespace: ServiceWorker","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: ServiceWorker ServiceWorker Service Worker to handle push notifications Source: sw.js, line 10 Members &lt;static, constant&gt; ACTION_DEVICE_REMOVED Source: sw.js, line 48 &lt;static, constant&gt; ACTION_MESSAGE Source: sw.js, line 46 &lt;static, constant&gt; FAKE_FETCH_DONE Source: sw.js, line 60 &lt;static, constant&gt; IC_ADD_DEVICE Source: sw.js, line 53 &lt;static, constant&gt; IC_REMOTE_COPY Source: sw.js, line 51 &lt;static, constant&gt; IC_REMOVE_DEVICE Source: sw.js, line 55 &lt;static, constant&gt; IC_SEARCH Source: sw.js, line 57 &lt;static&gt; msgArr Temporary variable to help get all messages at Chrome start-up Normally, can't use globals in service worker, but this is only used when Chrome first starts up. Pretty sure it won't be stopped during this time could use indexedDB if we really have to Source: sw.js, line 70 &lt;static, constant&gt; TAG_DEVICE Source: sw.js, line 43 &lt;static, constant&gt; TAG_MESSAGE Source: sw.js, line 41 &lt;static, constant&gt; URL_EXT :string Path to extension's main page Type: string Source: sw.js, line 37 &lt;static, constant&gt; URL_FETCH_BASE :string Fake fetch base path Type: string Source: sw.js, line 21 &lt;static, constant&gt; URL_SEARCH_BASE :string Google search base path Type: string Source: sw.js, line 29 Methods &lt;static&gt; doFakeFetch(dataArray) → {Promise.&lt;void&gt;} Send fake GET request so extension can intercept it and get the payload Parameters: Name Type Description dataArray Array.&lt;app.Msg.GaeMsg&gt; Array of app.Msg.GaeMsg objects Source: sw.js, line 177 See: https://bugs.chromium.org/p/chromium/issues/detail?id=452942 Returns: fails if extension successfully canceled request Type Promise.&lt;void&gt; &lt;static&gt; getDeviceName(data) → {string} Get the name of the Device who sent the message Parameters: Name Type Description data app.Msg.GaeMsg message object Source: sw.js, line 87 Returns: device name Type string &lt;static&gt; getIcon(data) → {string} Get the icon for the notification Parameters: Name Type Description data app.Msg.GaeMsg message object Source: sw.js, line 117 Returns: path to icon Type string &lt;static&gt; getPageRoute(icon) → {string} Get the page route from the icon Parameters: Name Type Description icon string notification icon Source: sw.js, line 147 Returns: path to icon Type string &lt;static&gt; getTag(data) → {string} Get the tag for the notification Parameters: Name Type Description data app.Msg.GaeMsg message object Source: sw.js, line 103 Returns: notification tag Type string &lt;static&gt; onNotificationClick(event) Event: Notification clicked. Parameters: Name Type Description event SWEvent the event Source: sw.js, line 281 &lt;static&gt; onNotificationClose(event) Event: Notification closed - can't open or focus window here. Parameters: Name Type Description event SWEvent the event Source: sw.js, line 326 &lt;static&gt; onPushReceived(event) Event: Received push message Parameters: Name Type Description event SWEvent the event Source: sw.js, line 191 &lt;static&gt; postRouteMessage(client, icon) → {Promise.&lt;void&gt;} Post a message about the page route to display Parameters: Name Type Description client Object our client window icon string notification icon Source: sw.js, line 134 Returns: void Type Promise.&lt;void&gt; &lt;static&gt; sendNotificationData(dataArray) → {Promise.&lt;void&gt;} Send any data attached to a notification to the extension Parameters: Name Type Description dataArray Array.&lt;app.Msg.GaeMsg&gt; possible array of app.Msg.GaeMsg objects Source: sw.js, line 162 Returns: always resolves Type Promise.&lt;void&gt; Type Definitions SWEvent Service Worker Events Type: Event Properties: Name Type Description waitUntil(Promise) function wait till promise returns notification Object notification action Object notification action Source: sw.js, line 72 × Search results Close "},"SettingBackground.html":{"id":"SettingBackground.html","title":"Namespace: SettingBackground","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingBackground SettingBackground Polymer element to select an HTML element background style Source: setting-background/setting-background.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-background/setting-background.js, line 39 &lt;static&gt; mainLabel Item description Source: setting-background/setting-background.js, line 78 &lt;static&gt; name Local storage key Source: setting-background/setting-background.js, line 21 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-background/setting-background.js, line 48 &lt;static&gt; secondaryLabel Item secondary description Source: setting-background/setting-background.js, line 87 &lt;static&gt; sectionTitle Optional group title Source: setting-background/setting-background.js, line 30 &lt;static&gt; selected :string Element id of currently selected background style Type: string Source: setting-background/setting-background.js, line 58 &lt;static&gt; value Local storage value of currently selected background style Source: setting-background/setting-background.js, line 68 Methods &lt;private, static&gt; _init() Initialize value if it is not in localstorage Source: setting-background/setting-background.js, line 98 &lt;private, static&gt; _onOK() Event: Set selected background on tap of OK button Source: setting-background/setting-background.js, line 117 &lt;private, static&gt; _onTap() Event: Show dialog on tap Source: setting-background/setting-background.js, line 108 × Search results Close "},"SettingDropdown.html":{"id":"SettingDropdown.html","title":"Namespace: SettingDropdown","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingDropdown SettingDropdown Polymer element to select an item from a list Source: setting-dropdown/setting-dropdown.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-dropdown/setting-dropdown.js, line 65 &lt;static&gt; items Array of Menu item labels Source: setting-dropdown/setting-dropdown.js, line 45 &lt;static&gt; label Menu description Source: setting-dropdown/setting-dropdown.js, line 26 &lt;static&gt; name Local storage key Source: setting-dropdown/setting-dropdown.js, line 17 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-dropdown/setting-dropdown.js, line 74 &lt;static&gt; sectionTitle Optional group title Source: setting-dropdown/setting-dropdown.js, line 56 &lt;static&gt; value Selected menu item index Source: setting-dropdown/setting-dropdown.js, line 35 Methods &lt;private, static&gt; _init() Initialize value if it is not in localstorage Source: setting-dropdown/setting-dropdown.js, line 99 &lt;private, static&gt; _onItemSelected(ev) Event: menu item tapped Parameters: Name Type Description ev Event tap event Source: setting-dropdown/setting-dropdown.js, line 86 × Search results Close "},"SettingLink.html":{"id":"SettingLink.html","title":"Namespace: SettingLink","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingLink SettingLink Polymer element to display a url link Source: setting-link/setting-link.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-link/setting-link.js, line 62 &lt;static&gt; icon Link icon Source: setting-link/setting-link.js, line 35 &lt;static&gt; label Link description Source: setting-link/setting-link.js, line 26 &lt;static&gt; name Element name Source: setting-link/setting-link.js, line 17 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-link/setting-link.js, line 71 &lt;static&gt; sectionTitle Optional group title Source: setting-link/setting-link.js, line 53 &lt;static&gt; url Link url Source: setting-link/setting-link.js, line 44 Methods &lt;private, static&gt; _onLinkTapped() Event: Item tapped - show url in new tab Source: setting-link/setting-link.js, line 82 × Search results Close "},"SettingSlider.html":{"id":"SettingSlider.html","title":"Namespace: SettingSlider","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingSlider SettingSlider Polymer element to select a value with a slider Source: setting-slider/setting-slider.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-slider/setting-slider.js, line 67 &lt;static&gt; label Slider description Source: setting-slider/setting-slider.js, line 26 &lt;static&gt; name Local storage key Source: setting-slider/setting-slider.js, line 17 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-slider/setting-slider.js, line 76 &lt;static&gt; sectionTitle Optional group title Source: setting-slider/setting-slider.js, line 58 &lt;static&gt; units Array of unit labels Source: setting-slider/setting-slider.js, line 47 &lt;static&gt; value Object containing slider value and display unit index Source: setting-slider/setting-slider.js, line 35 Methods &lt;private, static&gt; _initValue() Initialize value if it is not in localstorage Source: setting-slider/setting-slider.js, line 115 &lt;private, static&gt; _onSliderValueChanged() Event: User changed slider value Source: setting-slider/setting-slider.js, line 87 &lt;private, static&gt; _onUnitChanged() Event: Display unit was changed Source: setting-slider/setting-slider.js, line 96 &lt;private, static&gt; _setBase() Set the base value Source: setting-slider/setting-slider.js, line 106 × Search results Close "},"SettingsPage.html":{"id":"SettingsPage.html","title":"Namespace: SettingsPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingsPage SettingsPage Polymer element to manage extension settings Source: pages/settings-page.js, line 10 Methods &lt;private, static&gt; _onChromeMessage(request, sender, response) → {boolean} Event: Fired when a message is sent from either an extension process (by runtime.sendMessage) or a content script (by tabs.sendMessage). Parameters: Name Type Description request Chrome.Msg.Message details for the Properties Name Type Description error string error message sender Object MessageSender object response function function to call once after processing Source: pages/settings-page.js, line 39 See: https://developer.chrome.com/extensions/runtime#event-onMessage Returns: true if asynchronous Type boolean &lt;private, static&gt; _showDialog(title, text) Display error dialog Parameters: Name Type Description title string error title text string description of error Source: pages/settings-page.js, line 56 &lt;static&gt; ready() Element is ready Source: pages/settings-page.js, line 21 × Search results Close "},"SettingText.html":{"id":"SettingText.html","title":"Namespace: SettingText","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingText SettingText Polymer element for a text entry Source: setting-text/setting-text.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-text/setting-text.js, line 88 &lt;static&gt; mainLabel Descriptive label Source: setting-text/setting-text.js, line 61 &lt;static&gt; maxLength Max length of text entry Source: setting-text/setting-text.js, line 51 &lt;static&gt; name Local storage key Source: setting-text/setting-text.js, line 22 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-text/setting-text.js, line 97 &lt;static&gt; placeholder Placeholder text when empty Source: setting-text/setting-text.js, line 41 &lt;static&gt; secondaryLabel Secondary descriptive label Source: setting-text/setting-text.js, line 70 &lt;static&gt; sectionTitle Optional group title Source: setting-text/setting-text.js, line 79 &lt;static&gt; value Text value Source: setting-text/setting-text.js, line 31 Methods &lt;private, static&gt; _init() Initialize value if it is not in localstorage Source: setting-text/setting-text.js, line 132 &lt;private, static&gt; _onBlur() Event: Lost focus - fire setting-text-changed event Source: setting-text/setting-text.js, line 108 &lt;private, static&gt; _onKeyUp(event) Event: keyup - fire setting-text-changed event on 'Enter' Parameters: Name Type Description event Event key event Source: setting-text/setting-text.js, line 119 × Search results Close "},"SettingTime.html":{"id":"SettingTime.html","title":"Namespace: SettingTime","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingTime SettingTime Polymer element for selecting a time Source: setting-time/setting-time.js, line 5 Members &lt;static&gt; disabled Disabled state of element Source: setting-time/setting-time.js, line 87 &lt;static&gt; format Display format 12/24 hr Source: setting-time/setting-time.js, line 49 &lt;static&gt; mainLabel Descriptive label Source: setting-time/setting-time.js, line 60 &lt;static&gt; name Local storage key Source: setting-time/setting-time.js, line 21 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-time/setting-time.js, line 96 &lt;static&gt; secondaryLabel Secondary descriptive label Source: setting-time/setting-time.js, line 69 &lt;static&gt; sectionTitle Optional group title Source: setting-time/setting-time.js, line 78 &lt;static&gt; timeLabel Time display label Source: setting-time/setting-time.js, line 40 &lt;static&gt; value Time value '00:00' format Source: setting-time/setting-time.js, line 30 Methods &lt;private, static&gt; _formatChanged() Observer: Global Time format changed Source: setting-time/setting-time.js, line 142 &lt;private, static&gt; _formatTime(timeString) → {string} Get the time suitable for display Parameters: Name Type Description timeString string format '00:00' Source: setting-time/setting-time.js, line 153 Returns: formatted time Type string &lt;private, static&gt; _init() Initialize value if it is not in localstorage Source: setting-time/setting-time.js, line 178 &lt;private, static&gt; _onTap() Event: Show dialog on tap Source: setting-time/setting-time.js, line 107 &lt;private, static&gt; _onTimeSelected() Event: Set time on tap of OK button Source: setting-time/setting-time.js, line 118 &lt;private, static&gt; _setTimeLabel(value) Set the time display label Parameters: Name Type Description value string time in '00:00' format Source: setting-time/setting-time.js, line 169 &lt;private, static&gt; _valueChanged(newValue) Observer: Value changed Parameters: Name Type Description newValue string value we changed to Source: setting-time/setting-time.js, line 133 × Search results Close "},"SettingToggle.html":{"id":"SettingToggle.html","title":"Namespace: SettingToggle","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SettingToggle SettingToggle Polymer element for a text entry Source: setting-toggle/setting-toggle.js, line 5 Members &lt;static&gt; checked Toggle checked state Source: setting-toggle/setting-toggle.js, line 26 &lt;static&gt; disabled Disabled state of element Source: setting-toggle/setting-toggle.js, line 63 &lt;static&gt; mainLabel Toggle descriptive label Source: setting-toggle/setting-toggle.js, line 36 &lt;static&gt; name Local storage key Source: setting-toggle/setting-toggle.js, line 17 &lt;static&gt; noseparator Visibility state of optional divider Source: setting-toggle/setting-toggle.js, line 72 &lt;static&gt; secondaryLabel Toggle secondary descriptive label Source: setting-toggle/setting-toggle.js, line 45 &lt;static&gt; sectionTitle Optional group title Source: setting-toggle/setting-toggle.js, line 54 Methods &lt;private, static&gt; _init() Initialize value if it is not in localStorage Source: setting-toggle/setting-toggle.js, line 102 &lt;private, static&gt; _onChange() Event: checked state changed Source: setting-toggle/setting-toggle.js, line 93 &lt;static&gt; setChecked(checked) Set the checked state of the toggle Parameters: Name Type Description checked boolean checked state Source: setting-toggle/setting-toggle.js, line 83 × Search results Close "},"SignInPage.html":{"id":"SignInPage.html","title":"Namespace: SignInPage","body":" Documentation Namespaces app.Alarmapp.CBapp.ChromeMsgapp.Dataapp.DBapp.Devicesapp.Fbapp.GAapp.Gaeapp.Msgapp.Notifyapp.Permissionsapp.Regapp.SWapp.Userapp.UtilsBackgroundChrome.AuthChrome.GAChrome.HttpChrome.JSONUtilsChrome.LocaleChrome.LogChrome.MsgChrome.StorageChrome.UtilsClipListClipRowClipViewerContentScriptDevicesPageErrorPageHelpPageLabelsDialogLabelsPageMainMainPageReceiveMsgServiceWorkerSettingBackgroundSettingDropdownSettingLinkSettingSliderSettingsPageSettingTextSettingTimeSettingToggleSignInPage Classes Chrome.TimeClipItemDeviceExceptionHandlerLabel Events ClipList.event:row-label-tapClipList.event:selected-clip-changeClipRow.event:label-tapClipViewer.event:clip-addClipViewer.event:labels-tappedClipViewer.event:text-changed Global removeCachedToken Namespace: SignInPage SignInPage Polymer element to manage user account Source: pages/signin-page.js, line 30 Members &lt;static&gt; isSignInDisabled Signin disabled state Source: pages/signin-page.js, line 52 &lt;static&gt; isWaiting Waiting for signIn/signOut state Source: pages/signin-page.js, line 62 &lt;static&gt; showConfirmButton Display dialog OK button state Source: pages/signin-page.js, line 72 &lt;static&gt; signedIn Signin state Source: pages/signin-page.js, line 42 Methods &lt;private, static&gt; _checkChromeSignIn() Determine if the user is signed into the Browser Source: pages/signin-page.js, line 175 &lt;private, static&gt; _checkPermissions() Display popup to Allow Notifications if necessary Source: pages/signin-page.js, line 196 &lt;private, static&gt; _computeButtonLabel(isSignedIn) → {string} Computed Binding: Account button label Parameters: Name Type Description isSignedIn boolean true if signed in Source: pages/signin-page.js, line 133 Returns: Type string &lt;private, static&gt; _computeDescDisplay(isWaiting, isSignedIn) → {string} Computed Binding: Description display style Parameters: Name Type Description isWaiting boolean true if signing in isSignedIn boolean true if signed in Source: pages/signin-page.js, line 155 Returns: Type string &lt;private, static&gt; _computeTitle(isSignedIn) → {string} Computed Binding: Page title Parameters: Name Type Description isSignedIn boolean true if signed in Source: pages/signin-page.js, line 120 Returns: Type string &lt;private, static&gt; _computeWaiterDisplay(isWaiting) → {string} Computed Binding: Spinner display style Parameters: Name Type Description isWaiting boolean true if signing in Source: pages/signin-page.js, line 166 Returns: Type string &lt;private, static&gt; _computeWaiterLabel() → {string} Computed Binding: Spinner label Source: pages/signin-page.js, line 143 Returns: Type string &lt;private, static&gt; _forceSignOut() Force sign out Source: pages/signin-page.js, line 265 &lt;private, static&gt; _initSignedIn() Initialize value if it is not in localStorage Source: pages/signin-page.js, line 290 &lt;private, static&gt; _onAccountButtonClicked() Event: Signin/SignOut button clicked Source: pages/signin-page.js, line 91 &lt;private, static&gt; _onDialogOKClicked() Event: Dialog OK button click Source: pages/signin-page.js, line 109 &lt;private, static&gt; _showDialog(title, text, showConfirmButton) Show the error dialog Parameters: Name Type Description title string dialog title text string dialog message showConfirmButton boolean if true, display showConfirmButton Source: pages/signin-page.js, line 277 &lt;private, static&gt; _signIn() Attempt to sign in with current Browser account Source: pages/signin-page.js, line 233 &lt;private, static&gt; _signOut() sign out user - will always do it, one way or another Source: pages/signin-page.js, line 251 &lt;static&gt; onCurrentPage() We have animated in and are now the current page Source: pages/signin-page.js, line 82 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
